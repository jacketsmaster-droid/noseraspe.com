<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jackets Master - Tienda de Jackets de Moto</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Anton:wght@400&display=swap" rel="stylesheet">
    <link id="favicon" rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Crect width='100' height='100' fill='%23dc2626'/%3E%3Ctext x='50' y='60' text-anchor='middle' font-size='40' fill='white'%3EJM%3C/text%3E%3C/svg%3E">
    <style>
        .logo-text {
            font-family: 'Anton', sans-serif;
            font-style: italic;
            color: #dc2626;
            text-shadow: 3px 3px 0px #000000;
            font-size: 2.5rem;
            letter-spacing: 2px;
        }
        
        .hero-title {
            font-family: 'Anton', sans-serif;
            font-style: italic;
            color: #dc2626;
            text-shadow: 4px 4px 0px #000000;
            font-size: 4rem;
            letter-spacing: 3px;
        }
        
        .section-title {
            font-family: 'Anton', sans-serif;
            font-style: italic;
            color: #dc2626;
            text-shadow: 3px 3px 0px #000000;
            letter-spacing: 2px;
        }
        
        .product-card {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            background: linear-gradient(135deg, #f3f4f6 0%, #e5e7eb 100%);
        }
        
        .product-card:hover {
            transform: translateY(-8px) scale(1.02);
            box-shadow: 0 15px 35px rgba(0,0,0,0.3);
        }
        
        .admin-panel {
            display: none;
        }
        
        .admin-panel.active {
            display: block;
        }
        
        .hero-bg {
            background: linear-gradient(rgba(0,0,0,0.7), rgba(0,0,0,0.7)), 
                        url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 600"><rect width="1200" height="600" fill="%23374151"/><g fill="%23dc2626" opacity="0.1"><circle cx="200" cy="150" r="80"/><circle cx="600" cy="300" r="120"/><circle cx="1000" cy="200" r="100"/><path d="M100 400 Q300 350 500 400 T900 400" stroke="%23dc2626" stroke-width="3" fill="none" opacity="0.3"/></g><text x="600" y="300" text-anchor="middle" font-family="Arial" font-size="24" fill="%23dc2626" opacity="0.2">MOTORCYCLE GEAR</text></svg>');
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
        }
        
        .hero-bg.custom-bg {
            background-attachment: scroll;
        }
        
        .hero-text-container {
            position: relative;
            z-index: 2;
        }
        
        .hero-text-bg {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            z-index: -1;
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            border-radius: 1rem;
            opacity: 0.2;
        }
        
        .motorcycle-pattern {
            background-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"><rect width="100" height="100" fill="%23f3f4f6"/><g fill="%23dc2626" opacity="0.05"><path d="M20 50 Q30 40 40 50 Q50 60 60 50 Q70 40 80 50" stroke="%23dc2626" stroke-width="2" fill="none"/><circle cx="25" cy="25" r="3"/><circle cx="75" cy="75" r="3"/><circle cx="75" cy="25" r="2"/><circle cx="25" cy="75" r="2"/></g></svg>');
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #dc2626 0%, #b91c1c 100%);
            box-shadow: 0 4px 15px rgba(220, 38, 38, 0.4);
            transition: all 0.3s ease;
        }
        
        .btn-primary:hover {
            background: linear-gradient(135deg, #b91c1c 0%, #991b1b 100%);
            box-shadow: 0 6px 20px rgba(220, 38, 38, 0.6);
            transform: translateY(-2px);
        }
        
        .glass-effect {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            height: 8px;
            background: linear-gradient(135deg, #dc2626 0%, #b91c1c 100%);
            outline: none;
            border-radius: 4px;
        }
        
        .slider-thumb::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            background: #dc2626;
            cursor: pointer;
            border-radius: 50%;
            border: 2px solid #fff;
            box-shadow: 0 2px 6px rgba(0,0,0,0.3);
        }
        
        .slider-thumb::-moz-range-thumb {
            width: 20px;
            height: 20px;
            background: #dc2626;
            cursor: pointer;
            border-radius: 50%;
            border: 2px solid #fff;
            box-shadow: 0 2px 6px rgba(0,0,0,0.3);
        }
        
        /* Mobile optimizations */
        @media (max-width: 768px) {
            .product-card {
                margin-bottom: 1rem;
            }
            
            .line-clamp-2 {
                display: -webkit-box;
                -webkit-line-clamp: 2;
                -webkit-box-orient: vertical;
                overflow: hidden;
            }
            
            #productsGrid {
                grid-template-columns: 1fr;
                gap: 1rem;
            }
        }
        
        @media (min-width: 640px) and (max-width: 1023px) {
            #productsGrid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        
        /* Carousel styles */
        .carousel-image.hidden {
            display: none;
        }
        
        .carousel-image.active {
            display: block;
        }
        
        /* Product detail modal styles */
        .product-detail-modal {
            transform: translateX(100%);
            transition: transform 0.3s ease-in-out;
        }
        
        .product-detail-modal.active {
            transform: translateX(0);
        }
        
        /* Form autofill styles */
        input:-webkit-autofill,
        input:-webkit-autofill:hover,
        input:-webkit-autofill:focus,
        textarea:-webkit-autofill,
        textarea:-webkit-autofill:hover,
        textarea:-webkit-autofill:focus,
        select:-webkit-autofill,
        select:-webkit-autofill:hover,
        select:-webkit-autofill:focus {
            -webkit-text-fill-color: #374151;
            -webkit-box-shadow: 0 0 0px 1000px #ffffff inset;
            transition: background-color 5000s ease-in-out 0s;
        }
    </style>
</head>
<body class="bg-gray-400 motorcycle-pattern">
    <!-- Header -->
    <header class="bg-black bg-opacity-90 text-white shadow-2xl sticky top-0 z-30">
        <div class="container mx-auto px-4 py-4">
            <div class="flex justify-between items-center">
                <div class="flex items-center space-x-4">
                    <div id="logoContainer">
                        <i class="fas fa-motorcycle text-4xl text-red-600" id="defaultLogo"></i>
                        <img id="customLogo" src="" alt="Logo" class="h-12 w-auto hidden">
                    </div>
                    <h1 class="logo-text">JACKETS MASTER</h1>
                </div>
                <nav class="hidden md:flex space-x-8">
                    <a href="#inicio" class="hover:text-red-500 transition-colors font-semibold text-lg" id="navInicio" contenteditable="false">INICIO</a>
                    <a href="#productos" class="hover:text-red-500 transition-colors font-semibold text-lg" id="navProductos" contenteditable="false">PRODUCTOS</a>
                    <a href="#contacto" class="hover:text-red-500 transition-colors font-semibold text-lg" id="navContacto" contenteditable="false">CONTACTO</a>
                    <button onclick="toggleAdminLogin()" class="bg-gray-700 bg-opacity-80 text-gray-300 hover:text-white hover:bg-opacity-100 px-4 py-2 rounded-lg font-medium text-sm transition-all duration-300">
                        <i class="fas fa-cog mr-1 text-xs"></i>Admin
                    </button>
                </nav>
                <button class="md:hidden text-3xl" onclick="toggleMobileMenu()">
                    <i class="fas fa-bars text-red-500"></i>
                </button>
            </div>
        </div>
    </header>

    <!-- Mobile Menu -->
    <div id="mobileMenu" class="hidden bg-black bg-opacity-95 text-white md:hidden">
        <div class="container mx-auto px-4 py-6 space-y-6">
            <a href="#inicio" class="block hover:text-red-500 text-xl font-bold" id="mobileNavInicio" contenteditable="false">INICIO</a>
            <a href="#productos" class="block hover:text-red-500 text-xl font-bold" id="mobileNavProductos" contenteditable="false">PRODUCTOS</a>
            <a href="#contacto" class="block hover:text-red-500 text-xl font-bold" id="mobileNavContacto" contenteditable="false">CONTACTO</a>
            <button onclick="toggleAdminLogin()" class="bg-gray-700 bg-opacity-80 text-gray-300 hover:text-white hover:bg-opacity-100 px-4 py-2 rounded-lg w-full font-medium text-sm transition-all duration-300">
                <i class="fas fa-cog mr-1 text-xs"></i>Panel Admin
            </button>
        </div>
    </div>

    <!-- Admin Login Modal -->
    <div id="adminLogin" class="fixed inset-0 bg-black bg-opacity-80 z-50 hidden flex items-center justify-center">
        <div class="glass-effect p-8 rounded-xl shadow-2xl max-w-md w-full mx-4 text-white">
            <h3 class="section-title text-3xl mb-8 text-center">ACCESO ADMIN</h3>
            <form onsubmit="adminLogin(event)">
                <div class="mb-6">
                    <label class="block text-white text-lg font-bold mb-3">USUARIO:</label>
                    <input type="text" id="adminUser" class="w-full px-4 py-3 bg-black bg-opacity-50 text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500 text-lg" required>
                </div>
                <div class="mb-8">
                    <label class="block text-white text-lg font-bold mb-3">CONTRASE√ëA:</label>
                    <input type="password" id="adminPass" class="w-full px-4 py-3 bg-black bg-opacity-50 text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500 text-lg" required>
                </div>
                <div class="flex space-x-4">
                    <button type="submit" class="flex-1 btn-primary text-white py-3 rounded-lg font-bold text-lg">
                        INGRESAR
                    </button>
                    <button type="button" onclick="toggleAdminLogin()" class="flex-1 bg-gray-600 text-white py-3 rounded-lg hover:bg-gray-700 transition-colors font-bold text-lg">
                        CANCELAR
                    </button>
                </div>
            </form>
            <p class="text-lg text-gray-300 mt-6 text-center font-bold">Pista: l</p>
        </div>
    </div>

    <!-- Hero Section -->
    <section id="inicio" class="hero-bg text-white py-32 relative overflow-hidden">
        <div class="container mx-auto px-4 text-center relative z-10">
            <div class="hero-text-container max-w-6xl mx-auto p-8 rounded-2xl">
                <div class="hero-text-bg" id="heroTextBg"></div>
                <h2 class="hero-title mb-8 relative z-10" id="heroTitle" contenteditable="false">MOTORCYCLE GEAR PREMIUM</h2>
                <p class="text-2xl mb-12 max-w-4xl mx-auto font-semibold relative z-10" id="heroSubtitle" contenteditable="false">Descubra nuestra colecci√≥n de equipo de motociclista de alta calidad. Protecci√≥n, estilo y durabilidad en cada prenda para los verdaderos riders.</p>
                <a href="#productos" class="btn-primary text-white px-12 py-6 rounded-xl text-2xl font-bold inline-block relative z-10">
                    <i class="fas fa-motorcycle mr-3"></i>VER CAT√ÅLOGO
                </a>
            </div>
        </div>
        <div class="absolute inset-0 opacity-10">
            <div class="absolute top-20 left-10 text-red-500 text-6xl"><i class="fas fa-motorcycle"></i></div>
            <div class="absolute top-40 right-20 text-red-500 text-4xl"><i class="fas fa-helmet-safety"></i></div>
            <div class="absolute bottom-20 left-1/4 text-red-500 text-5xl"><i class="fas fa-road"></i></div>
            <div class="absolute bottom-40 right-1/3 text-red-500 text-3xl"><i class="fas fa-shield-alt"></i></div>
        </div>
    </section>

    <!-- Products Section -->
    <section id="productos" class="py-20">
        <div class="container mx-auto px-4">
            <h2 class="section-title text-5xl text-center mb-16" id="productsTitle" contenteditable="false">NUESTROS PRODUCTOS</h2>
            
            <!-- Search and Filters -->
            <div class="glass-effect p-8 rounded-xl shadow-xl mb-12">
                <div class="grid grid-cols-1 md:grid-cols-4 gap-6">
                    <div>
                        <label class="block text-lg font-bold mb-3 text-gray-800">BUSCAR:</label>
                        <input type="text" id="searchInput" placeholder="Buscar productos..." class="w-full px-4 py-3 bg-white rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500 text-lg" onkeyup="filterProducts()">
                    </div>
                    <div>
                        <label class="block text-lg font-bold mb-3 text-gray-800">CATEGOR√çA:</label>
                        <select id="categoryFilter" class="w-full px-4 py-3 bg-white rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500 text-lg" onchange="filterProducts()">
                            <option value="">Todas las categor√≠as</option>
                            <option value="chaquetas">Jackets</option>
                            <option value="guantes">Guantes</option>
                            <option value="pantalones">Pantalones</option>
                            <option value="rodilleras">Rodilleras</option>
                            <option value="protecciones">Protecciones</option>
                            <option value="bolsos">Bolsos</option>
                            <option value="liner">Liner</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-lg font-bold mb-3 text-gray-800">PRECIO:</label>
                        <div class="space-y-3">
                            <div class="flex justify-between text-sm text-gray-600">
                                <span>‚Ç°0</span>
                                <span>‚Ç°200,000+</span>
                            </div>
                            <div class="relative h-8 mb-4">
                                <input type="range" id="minPrice" min="0" max="200000" value="0" step="5000" class="absolute w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer slider-thumb z-10" oninput="updatePriceRange()">
                                <input type="range" id="maxPrice" min="0" max="200000" value="200000" step="5000" class="absolute w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer slider-thumb z-20" oninput="updatePriceRange()">
                            </div>
                            <div class="flex justify-between text-sm font-bold text-gray-800 mt-6">
                                <span id="minPriceDisplay">‚Ç°0</span>
                                <span id="maxPriceDisplay">‚Ç°200,000+</span>
                            </div>
                        </div>
                    </div>
                    <div>
                        <label class="block text-lg font-bold mb-3 text-gray-800">TALLA:</label>
                        <select id="sizeFilter" class="w-full px-4 py-3 bg-white rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500 text-lg" onchange="filterProducts()">
                            <option value="">Todas las tallas</option>
                            <option value="S">S</option>
                            <option value="M">M</option>
                            <option value="L">L</option>
                            <option value="XL">XL</option>
                            <option value="XXL">XXL</option>
                        </select>
                    </div>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mt-6">
                    <div>
                        <label class="block text-lg font-bold mb-3 text-gray-800">MARCA:</label>
                        <select id="brandFilter" class="w-full px-4 py-3 bg-white rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500 text-lg" onchange="filterProducts()">
                            <option value="">Todas las marcas</option>
                        </select>
                    </div>
                    <div class="flex items-end">
                        <button onclick="clearFilters()" class="w-full bg-gray-600 text-white py-3 rounded-lg hover:bg-gray-700 transition-colors font-bold text-lg">
                            <i class="fas fa-refresh mr-2"></i>LIMPIAR FILTROS
                        </button>
                    </div>
                </div>
            </div>

            <!-- Products Grid -->
            <div id="productsGrid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-8">
                <!-- Products will be loaded here -->
            </div>
        </div>
    </section>

    <!-- Brands Section -->
    <section class="py-20 bg-black bg-opacity-90">
        <div class="container mx-auto px-4">
            <h2 class="section-title text-4xl text-center mb-16 text-white" id="brandsTitle" contenteditable="false">MARCAS PREMIUM</h2>
            <div id="brandsGrid" class="grid grid-cols-2 md:grid-cols-4 gap-8">
                <!-- Brands will be loaded dynamically -->
            </div>
            
            <div class="text-center mt-12">
                <p class="text-xl text-gray-300 mb-6">Trabajamos con las mejores marcas del mundo para ofrecerte calidad garantizada</p>
                <div class="flex justify-center space-x-8 text-gray-400">
                    <div class="flex items-center space-x-2">
                        <i class="fas fa-shield-alt text-red-500"></i>
                        <span>Protecci√≥n Certificada</span>
                    </div>
                    <div class="flex items-center space-x-2">
                        <i class="fas fa-award text-red-500"></i>
                        <span>Calidad Premium</span>
                    </div>
                    <div class="flex items-center space-x-2">
                        <i class="fas fa-store text-red-500"></i>
                        <span>Tienda F√≠sica</span>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Contact Section -->
    <section id="contacto" class="bg-black bg-opacity-90 text-white py-20">
        <div class="container mx-auto px-4">
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-16">
                <div>
                    <h2 class="section-title text-4xl mb-8" id="contactTitle" contenteditable="false">CONT√ÅCTANOS</h2>
                    <div class="space-y-6">
                        <div class="flex items-center space-x-4">
                            <i class="fas fa-map-marker-alt text-red-500 text-2xl"></i>
                            <a href="https://www.google.com/maps/place/Jackets+Master/@9.9290393,-84.063926,17z/data=!3m1!4b1!4m6!3m5!1s0x8fa0e38bf54cc7bf:0xc835cd09d683c4ac!8m2!3d9.9290393!4d-84.0613511!16s%2Fg%2F11wtk_rf_3?entry=ttu&g_ep=EgoyMDI1MDkyNC4wIKXMDSoASAFQAw%3D%3D" target="_blank" rel="noopener noreferrer" class="text-xl hover:text-red-500 transition-colors underline">San Jos√©, Los Yoses, Montes de Oca</a>
                        </div>
                        <div class="flex items-center space-x-4">
                            <i class="fas fa-phone text-red-500 text-2xl"></i>
                            <span class="text-xl">+506 8884-5533</span>
                        </div>
                        <div class="flex items-center space-x-4">
                            <i class="fas fa-envelope text-red-500 text-2xl"></i>
                            <span class="text-xl">jacketsmaster@gmail.com</span>
                        </div>
                        <div class="flex items-center space-x-4">
                            <i class="fas fa-clock text-red-500 text-2xl"></i>
                            <span class="text-xl">Lun - Vie: 11:00 AM - 6:00 PM | S√°b: 10:00 AM - 3:00 PM</span>
                        </div>
                    </div>
                    
                    <div class="mt-12">
                        <h3 class="text-2xl font-bold mb-6">S√çGUENOS</h3>
                        <div class="flex space-x-6">
                            <a href="https://facebook.com" target="_blank" rel="noopener noreferrer" class="text-3xl hover:text-red-500 transition-colors">
                                <i class="fab fa-facebook"></i>
                            </a>
                            <a href="https://instagram.com" target="_blank" rel="noopener noreferrer" class="text-3xl hover:text-red-500 transition-colors">
                                <i class="fab fa-instagram"></i>
                            </a>
                            <a href="https://x.com" target="_blank" rel="noopener noreferrer" class="text-3xl hover:text-red-500 transition-colors">
                                <i class="fab fa-x-twitter"></i>
                            </a>
                        </div>
                    </div>
                </div>
                
                <div>
                    <h3 class="section-title text-3xl mb-8">VIS√çTANOS</h3>
                    <div class="bg-gray-800 rounded-xl p-8">
                        <h4 class="text-2xl font-bold mb-6 text-red-500">NUESTRA UBICACI√ìN</h4>
                        <div class="mb-6">
                            <iframe 
                                src="https://www.google.com/maps?client=opera&hs=H6Y&sca_esv=9594ada01a48a169&output=embed&q=jacketsmaster&source=lnms" 
                                width="100%" 
                                height="300" 
                                style="border:0; border-radius: 10px;" 
                                allowfullscreen="" 
                                loading="lazy" 
                                referrerpolicy="no-referrer-when-downgrade">
                            </iframe>
                        </div>
                        <div class="text-center">
                            <p class="text-xl text-gray-300 mb-4">¬°Le esperamos en nuestra tienda f√≠sica!</p>
                            <p class="text-lg text-gray-400 mb-6">Venga a probarse los jackets y reciba asesor√≠a personalizada de nuestros expertos.</p>
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                <a id="whatsappCatalogLink" href="https://wa.me/c/50688845533" 
                                   target="_blank" 
                                   rel="noopener noreferrer" 
                                   class="btn-primary text-white px-6 py-4 rounded-lg font-bold text-lg inline-block">
                                    <i class="fab fa-whatsapp mr-2"></i><span id="whatsappCatalogText">CAT√ÅLOGO WHATSAPP</span>
                                </a>
                                <a id="whatsappChannelLink" href="https://whatsapp.com/channel/0029VbBv0Wk59PwXaRqS6C2d" 
                                   target="_blank" 
                                   rel="noopener noreferrer" 
                                   class="bg-green-600 text-white px-6 py-4 rounded-lg font-bold text-lg inline-block hover:bg-green-700 transition-colors">
                                    <i class="fab fa-whatsapp mr-2"></i><span id="whatsappChannelText">CANAL PROMOCIONES</span>
                                </a>
                                <a id="wazeLink" href="https://waze.com/ul/hd1u0rps2s" 
                                   target="_blank" 
                                   rel="noopener noreferrer" 
                                   class="bg-blue-600 text-white px-6 py-4 rounded-lg font-bold text-lg inline-block hover:bg-blue-700 transition-colors">
                                    <i class="fas fa-route mr-2"></i><span id="wazeText">ABRIR EN WAZE</span>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Admin Panel -->
    <div id="adminPanel" class="admin-panel fixed inset-0 bg-gray-400 motorcycle-pattern z-40 overflow-y-auto">
        <div class="bg-black bg-opacity-90 text-white p-6">
            <div class="flex justify-between items-center">
                <h2 class="section-title text-3xl">PANEL DE ADMINISTRACI√ìN</h2>
                <button onclick="closeAdminPanel()" class="bg-red-600 px-6 py-3 rounded-lg hover:bg-red-700 font-bold text-lg">
                    <i class="fas fa-times mr-2"></i>CERRAR
                </button>
            </div>
        </div>
        
        <div class="container mx-auto px-4 py-12">
            <!-- Admin Navigation Tabs -->
            <div class="mb-8">
                <div class="flex flex-wrap justify-center space-x-4">
                    <button onclick="showAdminTab('products')" id="tabProducts" class="admin-tab active bg-red-600 text-white px-6 py-3 rounded-lg font-bold text-lg">
                        <i class="fas fa-box mr-2"></i>PRODUCTOS
                    </button>
                    <button onclick="showAdminTab('categories')" id="tabCategories" class="admin-tab bg-gray-600 text-white px-6 py-3 rounded-lg font-bold text-lg">
                        <i class="fas fa-tags mr-2"></i>CATEGOR√çAS
                    </button>
                    <button onclick="showAdminTab('brands')" id="tabBrands" class="admin-tab bg-gray-600 text-white px-6 py-3 rounded-lg font-bold text-lg">
                        <i class="fas fa-star mr-2"></i>MARCAS
                    </button>
                    <button onclick="showAdminTab('theme')" id="tabTheme" class="admin-tab bg-gray-600 text-white px-6 py-3 rounded-lg font-bold text-lg">
                        <i class="fas fa-palette mr-2"></i>DISE√ëO
                    </button>
                </div>
            </div>

            <!-- Products Tab -->
            <div id="adminProducts" class="admin-tab-content">
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-12">
                    <!-- Add Product Form -->
                    <div class="lg:col-span-1">
                        <div class="glass-effect p-8 rounded-xl shadow-xl">
                            <h3 class="section-title text-2xl mb-6">AGREGAR PRODUCTO</h3>
                            <form id="productForm" onsubmit="addProduct(event)" class="space-y-6">
                                <div>
                                    <label class="block text-lg font-bold mb-2 text-gray-800">NOMBRE:</label>
                                    <input type="text" id="productName" name="productName" autocomplete="off" class="w-full px-4 py-3 bg-white rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500 text-lg" required>
                                </div>
                                <div>
                                    <label class="block text-lg font-bold mb-2 text-gray-800">PRECIO:</label>
                                    <input type="number" id="productPrice" name="productPrice" step="0.01" autocomplete="off" class="w-full px-4 py-3 bg-white rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500 text-lg" required>
                                </div>
                                <div>
                                    <label class="block text-lg font-bold mb-2 text-gray-800">CATEGOR√çA:</label>
                                    <select id="productCategory" name="productCategory" autocomplete="off" class="w-full px-4 py-3 bg-white rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500 text-lg" required>
                                        <option value="">Seleccionar categor√≠a</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-lg font-bold mb-2 text-gray-800">MARCA:</label>
                                    <select id="productBrand" name="productBrand" autocomplete="off" class="w-full px-4 py-3 bg-white rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500 text-lg" required>
                                        <option value="">Seleccionar marca</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-lg font-bold mb-2 text-gray-800">TALLAS DISPONIBLES:</label>
                                    <div class="flex flex-wrap gap-4">
                                        <label class="flex items-center text-gray-800 font-semibold">
                                            <input type="checkbox" value="S" class="mr-2 w-4 h-4"> S
                                        </label>
                                        <label class="flex items-center text-gray-800 font-semibold">
                                            <input type="checkbox" value="M" class="mr-2 w-4 h-4"> M
                                        </label>
                                        <label class="flex items-center text-gray-800 font-semibold">
                                            <input type="checkbox" value="L" class="mr-2 w-4 h-4"> L
                                        </label>
                                        <label class="flex items-center text-gray-800 font-semibold">
                                            <input type="checkbox" value="XL" class="mr-2 w-4 h-4"> XL
                                        </label>
                                        <label class="flex items-center text-gray-800 font-semibold">
                                            <input type="checkbox" value="XXL" class="mr-2 w-4 h-4"> XXL
                                        </label>
                                        <label class="flex items-center text-gray-800 font-semibold">
                                            <input type="checkbox" value="30" class="mr-2 w-4 h-4"> 30
                                        </label>
                                        <label class="flex items-center text-gray-800 font-semibold">
                                            <input type="checkbox" value="32" class="mr-2 w-4 h-4"> 32
                                        </label>
                                        <label class="flex items-center text-gray-800 font-semibold">
                                            <input type="checkbox" value="34" class="mr-2 w-4 h-4"> 34
                                        </label>
                                        <label class="flex items-center text-gray-800 font-semibold">
                                            <input type="checkbox" value="36" class="mr-2 w-4 h-4"> 36
                                        </label>
                                        <label class="flex items-center text-gray-800 font-semibold">
                                            <input type="checkbox" value="38" class="mr-2 w-4 h-4"> 38
                                        </label>
                                        <label class="flex items-center text-gray-800 font-semibold">
                                            <input type="checkbox" value="√önico" class="mr-2 w-4 h-4"> √önico
                                        </label>
                                    </div>
                                </div>
                                <div>
                                    <label class="block text-lg font-bold mb-2 text-gray-800">DESCRIPCI√ìN:</label>
                                    <textarea id="productDescription" name="productDescription" rows="4" autocomplete="off" class="w-full px-4 py-3 bg-white rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500 text-lg" required></textarea>
                                </div>
                                <div>
                                    <label class="block text-lg font-bold mb-2 text-gray-800">IM√ÅGENES:</label>
                                    <div class="space-y-3">
                                        <div class="flex space-x-2">
                                            <input type="file" id="productImageFile" accept="image/*" multiple class="flex-1 px-4 py-3 bg-white rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500 text-lg" onchange="handleMultipleImageUpload(event)">
                                            <button type="button" onclick="addImageFromUrl()" class="bg-blue-600 text-white px-4 py-3 rounded-lg hover:bg-blue-700 transition-colors font-bold text-sm">
                                                <i class="fas fa-plus mr-1"></i>URL
                                            </button>
                                        </div>
                                        <input type="url" id="productImageUrl" class="w-full px-4 py-3 bg-white rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500 text-lg" placeholder="URL de imagen (presiona el bot√≥n URL para agregar)">
                                        
                                        <!-- Images Preview Container -->
                                        <div id="productImagePreview" class="hidden">
                                            <div class="bg-gray-100 p-4 rounded-lg">
                                                <div class="flex justify-between items-center mb-3">
                                                    <span class="font-bold text-gray-700">Im√°genes del producto:</span>
                                                    <button type="button" onclick="clearAllImages()" class="text-red-600 hover:text-red-800 text-sm font-bold">
                                                        <i class="fas fa-trash mr-1"></i>Limpiar todas
                                                    </button>
                                                </div>
                                                <div id="imagesGrid" class="grid grid-cols-3 md:grid-cols-4 gap-3 mb-3">
                                                    <!-- Images will be inserted here -->
                                                </div>
                                                <div class="text-xs text-gray-600 bg-blue-50 p-2 rounded">
                                                    üí° La primera imagen ser√° la imagen principal. Arrastra para reordenar.
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <!-- Add More Images Button -->
                                        <div id="addMoreImagesBtn" class="hidden">
                                            <button type="button" onclick="document.getElementById('productImageFile').click()" class="w-full bg-green-600 text-white py-3 rounded-lg hover:bg-green-700 transition-colors font-bold text-lg">
                                                <i class="fas fa-plus mr-2"></i>AGREGAR M√ÅS IM√ÅGENES
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                <div class="flex space-x-4">
                                    <button type="submit" class="flex-1 bg-green-600 text-white py-4 rounded-lg hover:bg-green-700 transition-colors font-bold text-lg">
                                        <i class="fas fa-plus mr-2"></i>AGREGAR PRODUCTO
                                    </button>
                                    <button type="button" onclick="resetProductForm()" class="bg-gray-600 text-white px-6 py-4 rounded-lg hover:bg-gray-700 transition-colors font-bold text-lg" style="display: none;" id="cancelEditBtn">
                                        <i class="fas fa-times mr-2"></i>CANCELAR
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                    
                    <!-- Products Management -->
                    <div class="lg:col-span-2">
                        <div class="glass-effect p-8 rounded-xl shadow-xl">
                            <h3 class="section-title text-2xl mb-6">GESTIONAR PRODUCTOS</h3>
                            <div id="adminProductsList" class="space-y-6">
                                <!-- Admin products list will be loaded here -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Categories Tab -->
            <div id="adminCategories" class="admin-tab-content hidden">
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-12">
                    <div class="glass-effect p-8 rounded-xl shadow-xl">
                        <h3 class="section-title text-2xl mb-6">AGREGAR CATEGOR√çA</h3>
                        <form id="categoryForm" onsubmit="addCategory(event)" class="space-y-6">
                            <div>
                                <label class="block text-lg font-bold mb-2 text-gray-800">NOMBRE:</label>
                                <input type="text" id="categoryName" class="w-full px-4 py-3 bg-white rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500 text-lg" required>
                            </div>
                            <div>
                                <label class="block text-lg font-bold mb-2 text-gray-800">ID (sin espacios):</label>
                                <input type="text" id="categoryId" class="w-full px-4 py-3 bg-white rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500 text-lg" required>
                            </div>
                            <div class="flex space-x-4">
                                <button type="submit" class="flex-1 bg-green-600 text-white py-4 rounded-lg hover:bg-green-700 transition-colors font-bold text-lg">
                                    <i class="fas fa-plus mr-2"></i>AGREGAR CATEGOR√çA
                                </button>
                                <button type="button" onclick="resetCategoryForm()" class="bg-gray-600 text-white px-6 py-4 rounded-lg hover:bg-gray-700 transition-colors font-bold text-lg" style="display: none;" id="cancelCategoryEditBtn">
                                    <i class="fas fa-times mr-2"></i>CANCELAR
                                </button>
                            </div>
                        </form>
                    </div>
                    <div class="glass-effect p-8 rounded-xl shadow-xl">
                        <h3 class="section-title text-2xl mb-6">GESTIONAR CATEGOR√çAS</h3>
                        <div id="adminCategoriesList" class="space-y-4">
                            <!-- Categories list will be loaded here -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- Brands Tab -->
            <div id="adminBrands" class="admin-tab-content hidden">
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-12">
                    <div class="glass-effect p-8 rounded-xl shadow-xl">
                        <h3 class="section-title text-2xl mb-6">AGREGAR MARCA</h3>
                        <form id="brandForm" onsubmit="addBrand(event)" class="space-y-6">
                            <div>
                                <label class="block text-lg font-bold mb-2 text-gray-800">NOMBRE:</label>
                                <input type="text" id="brandName" class="w-full px-4 py-3 bg-white rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500 text-lg" required>
                            </div>
                            <div>
                                <label class="block text-lg font-bold mb-2 text-gray-800">ID (sin espacios):</label>
                                <input type="text" id="brandId" class="w-full px-4 py-3 bg-white rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500 text-lg" required>
                            </div>
                            <div>
                                <label class="block text-lg font-bold mb-2 text-gray-800">DESCRIPCI√ìN:</label>
                                <textarea id="brandDescription" rows="3" class="w-full px-4 py-3 bg-white rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500 text-lg" required></textarea>
                            </div>
                            <div>
                                <label class="block text-lg font-bold mb-2 text-gray-800">LOGO:</label>
                                <div class="space-y-3">
                                    <input type="file" id="brandLogoFile" accept="image/*" class="w-full px-4 py-3 bg-white rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500 text-lg" onchange="handleImageUpload(event, 'brandLogo')">
                                    <input type="url" id="brandLogo" class="w-full px-4 py-3 bg-white rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500 text-lg" placeholder="O ingresa URL del logo">
                                    <div id="brandLogoPreview" class="hidden">
                                        <img id="brandLogoPreviewImg" src="" alt="Vista previa" class="w-32 h-20 object-cover rounded-lg mx-auto">
                                    </div>
                                </div>
                            </div>
                            <div class="flex space-x-4">
                                <button type="submit" class="flex-1 bg-green-600 text-white py-4 rounded-lg hover:bg-green-700 transition-colors font-bold text-lg">
                                    <i class="fas fa-plus mr-2"></i>AGREGAR MARCA
                                </button>
                                <button type="button" onclick="resetBrandForm()" class="bg-gray-600 text-white px-6 py-4 rounded-lg hover:bg-gray-700 transition-colors font-bold text-lg" style="display: none;" id="cancelBrandEditBtn">
                                    <i class="fas fa-times mr-2"></i>CANCELAR
                                </button>
                            </div>
                        </form>
                    </div>
                    <div class="glass-effect p-8 rounded-xl shadow-xl">
                        <h3 class="section-title text-2xl mb-6">GESTIONAR MARCAS</h3>
                        <div id="adminBrandsList" class="space-y-4">
                            <!-- Brands list will be loaded here -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- Theme Tab -->
            <div id="adminTheme" class="admin-tab-content hidden">
                <div class="glass-effect p-8 rounded-xl shadow-xl max-w-4xl mx-auto">
                    <h3 class="section-title text-2xl mb-6">PERSONALIZAR DISE√ëO</h3>
                    
                    <!-- Links Editor Section -->
                    <div class="mb-8 p-6 bg-purple-50 rounded-lg border-2 border-purple-200">
                        <h4 class="text-xl font-bold text-gray-800 mb-4">üîó EDITOR DE ENLACES</h4>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-bold mb-2 text-gray-700">WHATSAPP CAT√ÅLOGO - TEXTO:</label>
                                <input type="text" id="editWhatsappCatalogText" class="w-full px-3 py-2 bg-white rounded border focus:outline-none focus:ring-2 focus:ring-purple-500" placeholder="CAT√ÅLOGO WHATSAPP">
                            </div>
                            <div>
                                <label class="block text-sm font-bold mb-2 text-gray-700">WHATSAPP CAT√ÅLOGO - ENLACE:</label>
                                <input type="url" id="editWhatsappCatalogLink" class="w-full px-3 py-2 bg-white rounded border focus:outline-none focus:ring-2 focus:ring-purple-500" placeholder="https://wa.me/c/50688845533">
                            </div>
                            <div>
                                <label class="block text-sm font-bold mb-2 text-gray-700">WHATSAPP CANAL - TEXTO:</label>
                                <input type="text" id="editWhatsappChannelText" class="w-full px-3 py-2 bg-white rounded border focus:outline-none focus:ring-2 focus:ring-purple-500" placeholder="CANAL PROMOCIONES">
                            </div>
                            <div>
                                <label class="block text-sm font-bold mb-2 text-gray-700">WHATSAPP CANAL - ENLACE:</label>
                                <input type="url" id="editWhatsappChannelLink" class="w-full px-3 py-2 bg-white rounded border focus:outline-none focus:ring-2 focus:ring-purple-500" placeholder="https://whatsapp.com/channel/...">
                            </div>
                            <div>
                                <label class="block text-sm font-bold mb-2 text-gray-700">WAZE - TEXTO:</label>
                                <input type="text" id="editWazeText" class="w-full px-3 py-2 bg-white rounded border focus:outline-none focus:ring-2 focus:ring-purple-500" placeholder="ABRIR EN WAZE">
                            </div>
                            <div>
                                <label class="block text-sm font-bold mb-2 text-gray-700">WAZE - ENLACE:</label>
                                <input type="url" id="editWazeLink" class="w-full px-3 py-2 bg-white rounded border focus:outline-none focus:ring-2 focus:ring-purple-500" placeholder="https://waze.com/ul/...">
                            </div>
                        </div>
                        <div class="mt-4 flex space-x-2">
                            <button onclick="loadCurrentLinks()" class="bg-purple-600 text-white px-4 py-2 rounded hover:bg-purple-700 transition-colors font-bold text-sm">
                                <i class="fas fa-sync mr-2"></i>CARGAR ENLACES ACTUALES
                            </button>
                            <button onclick="applyLinkChanges()" class="bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700 transition-colors font-bold text-sm">
                                <i class="fas fa-save mr-2"></i>APLICAR CAMBIOS
                            </button>
                            <button onclick="resetLinks()" class="bg-gray-600 text-white px-4 py-2 rounded hover:bg-gray-700 transition-colors font-bold text-sm">
                                <i class="fas fa-undo mr-2"></i>RESTAURAR ORIGINALES
                            </button>
                        </div>
                    </div>

                    <!-- Font Customization Section -->
                    <div class="mb-8 p-6 bg-indigo-50 rounded-lg border-2 border-indigo-200">
                        <h4 class="text-xl font-bold text-gray-800 mb-4">üî§ PERSONALIZACI√ìN DE FUENTES</h4>
                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                            <!-- Main Title Font -->
                            <div class="bg-white p-4 rounded-lg border">
                                <h5 class="font-bold text-gray-700 mb-3">T√çTULO PRINCIPAL</h5>
                                <div class="space-y-2">
                                    <select id="heroTitleFont" class="w-full px-2 py-1 text-sm border rounded" onchange="updateFonts()">
                                        <option value="Anton">Anton (Actual)</option>
                                        <option value="Arial">Arial</option>
                                        <option value="Helvetica">Helvetica</option>
                                        <option value="Georgia">Georgia</option>
                                        <option value="Times New Roman">Times New Roman</option>
                                        <option value="Verdana">Verdana</option>
                                        <option value="Impact">Impact</option>
                                        <option value="Trebuchet MS">Trebuchet MS</option>
                                        <option value="Courier New">Courier New</option>
                                        <option value="Oswald">Oswald</option>
                                        <option value="Roboto">Roboto</option>
                                        <option value="Open Sans">Open Sans</option>
                                        <option value="Montserrat">Montserrat</option>
                                        <option value="Poppins">Poppins</option>
                                    </select>
                                    <div class="flex space-x-1">
                                        <input type="range" id="heroTitleSize" min="24" max="80" value="64" class="flex-1" onchange="updateFonts()">
                                        <span class="text-xs text-gray-600 w-8" id="heroTitleSizeValue">64px</span>
                                    </div>
                                    <div class="flex space-x-1">
                                        <label class="flex items-center text-xs">
                                            <input type="checkbox" id="heroTitleBold" checked class="mr-1" onchange="updateFonts()"> <strong>B</strong>
                                        </label>
                                        <label class="flex items-center text-xs">
                                            <input type="checkbox" id="heroTitleItalic" checked class="mr-1" onchange="updateFonts()"> <em>I</em>
                                        </label>
                                        <input type="color" id="heroTitleColor" value="#dc2626" class="w-8 h-6 rounded" onchange="updateFonts()">
                                    </div>
                                </div>
                            </div>

                            <!-- Section Titles Font -->
                            <div class="bg-white p-4 rounded-lg border">
                                <h5 class="font-bold text-gray-700 mb-3">T√çTULOS DE SECCI√ìN</h5>
                                <div class="space-y-2">
                                    <select id="sectionTitleFont" class="w-full px-2 py-1 text-sm border rounded" onchange="updateFonts()">
                                        <option value="Anton">Anton (Actual)</option>
                                        <option value="Arial">Arial</option>
                                        <option value="Helvetica">Helvetica</option>
                                        <option value="Georgia">Georgia</option>
                                        <option value="Times New Roman">Times New Roman</option>
                                        <option value="Verdana">Verdana</option>
                                        <option value="Impact">Impact</option>
                                        <option value="Trebuchet MS">Trebuchet MS</option>
                                        <option value="Courier New">Courier New</option>
                                        <option value="Oswald">Oswald</option>
                                        <option value="Roboto">Roboto</option>
                                        <option value="Open Sans">Open Sans</option>
                                        <option value="Montserrat">Montserrat</option>
                                        <option value="Poppins">Poppins</option>
                                    </select>
                                    <div class="flex space-x-1">
                                        <input type="range" id="sectionTitleSize" min="24" max="60" value="48" class="flex-1" onchange="updateFonts()">
                                        <span class="text-xs text-gray-600 w-8" id="sectionTitleSizeValue">48px</span>
                                    </div>
                                    <div class="flex space-x-1">
                                        <label class="flex items-center text-xs">
                                            <input type="checkbox" id="sectionTitleBold" checked class="mr-1" onchange="updateFonts()"> <strong>B</strong>
                                        </label>
                                        <label class="flex items-center text-xs">
                                            <input type="checkbox" id="sectionTitleItalic" checked class="mr-1" onchange="updateFonts()"> <em>I</em>
                                        </label>
                                        <input type="color" id="sectionTitleColor" value="#dc2626" class="w-8 h-6 rounded" onchange="updateFonts()">
                                    </div>
                                </div>
                            </div>

                            <!-- Product Names Font -->
                            <div class="bg-white p-4 rounded-lg border">
                                <h5 class="font-bold text-gray-700 mb-3">NOMBRES DE PRODUCTOS</h5>
                                <div class="space-y-2">
                                    <select id="productNameFont" class="w-full px-2 py-1 text-sm border rounded" onchange="updateFonts()">
                                        <option value="Arial">Arial (Actual)</option>
                                        <option value="Anton">Anton</option>
                                        <option value="Helvetica">Helvetica</option>
                                        <option value="Georgia">Georgia</option>
                                        <option value="Times New Roman">Times New Roman</option>
                                        <option value="Verdana">Verdana</option>
                                        <option value="Impact">Impact</option>
                                        <option value="Trebuchet MS">Trebuchet MS</option>
                                        <option value="Courier New">Courier New</option>
                                        <option value="Oswald">Oswald</option>
                                        <option value="Roboto">Roboto</option>
                                        <option value="Open Sans">Open Sans</option>
                                        <option value="Montserrat">Montserrat</option>
                                        <option value="Poppins">Poppins</option>
                                    </select>
                                    <div class="flex space-x-1">
                                        <input type="range" id="productNameSize" min="14" max="32" value="24" class="flex-1" onchange="updateFonts()">
                                        <span class="text-xs text-gray-600 w-8" id="productNameSizeValue">24px</span>
                                    </div>
                                    <div class="flex space-x-1">
                                        <label class="flex items-center text-xs">
                                            <input type="checkbox" id="productNameBold" checked class="mr-1" onchange="updateFonts()"> <strong>B</strong>
                                        </label>
                                        <label class="flex items-center text-xs">
                                            <input type="checkbox" id="productNameItalic" class="mr-1" onchange="updateFonts()"> <em>I</em>
                                        </label>
                                        <input type="color" id="productNameColor" value="#374151" class="w-8 h-6 rounded" onchange="updateFonts()">
                                    </div>
                                </div>
                            </div>

                            <!-- Product Descriptions Font -->
                            <div class="bg-white p-4 rounded-lg border">
                                <h5 class="font-bold text-gray-700 mb-3">DESCRIPCIONES</h5>
                                <div class="space-y-2">
                                    <select id="productDescFont" class="w-full px-2 py-1 text-sm border rounded" onchange="updateFonts()">
                                        <option value="Arial">Arial (Actual)</option>
                                        <option value="Anton">Anton</option>
                                        <option value="Helvetica">Helvetica</option>
                                        <option value="Georgia">Georgia</option>
                                        <option value="Times New Roman">Times New Roman</option>
                                        <option value="Verdana">Verdana</option>
                                        <option value="Impact">Impact</option>
                                        <option value="Trebuchet MS">Trebuchet MS</option>
                                        <option value="Courier New">Courier New</option>
                                        <option value="Oswald">Oswald</option>
                                        <option value="Roboto">Roboto</option>
                                        <option value="Open Sans">Open Sans</option>
                                        <option value="Montserrat">Montserrat</option>
                                        <option value="Poppins">Poppins</option>
                                    </select>
                                    <div class="flex space-x-1">
                                        <input type="range" id="productDescSize" min="12" max="24" value="18" class="flex-1" onchange="updateFonts()">
                                        <span class="text-xs text-gray-600 w-8" id="productDescSizeValue">18px</span>
                                    </div>
                                    <div class="flex space-x-1">
                                        <label class="flex items-center text-xs">
                                            <input type="checkbox" id="productDescBold" class="mr-1" onchange="updateFonts()"> <strong>B</strong>
                                        </label>
                                        <label class="flex items-center text-xs">
                                            <input type="checkbox" id="productDescItalic" class="mr-1" onchange="updateFonts()"> <em>I</em>
                                        </label>
                                        <input type="color" id="productDescColor" value="#4b5563" class="w-8 h-6 rounded" onchange="updateFonts()">
                                    </div>
                                </div>
                            </div>

                            <!-- Product Prices Font -->
                            <div class="bg-white p-4 rounded-lg border">
                                <h5 class="font-bold text-gray-700 mb-3">PRECIOS</h5>
                                <div class="space-y-2">
                                    <select id="productPriceFont" class="w-full px-2 py-1 text-sm border rounded" onchange="updateFonts()">
                                        <option value="Arial">Arial (Actual)</option>
                                        <option value="Anton">Anton</option>
                                        <option value="Helvetica">Helvetica</option>
                                        <option value="Georgia">Georgia</option>
                                        <option value="Times New Roman">Times New Roman</option>
                                        <option value="Verdana">Verdana</option>
                                        <option value="Impact">Impact</option>
                                        <option value="Trebuchet MS">Trebuchet MS</option>
                                        <option value="Courier New">Courier New</option>
                                        <option value="Oswald">Oswald</option>
                                        <option value="Roboto">Roboto</option>
                                        <option value="Open Sans">Open Sans</option>
                                        <option value="Montserrat">Montserrat</option>
                                        <option value="Poppins">Poppins</option>
                                    </select>
                                    <div class="flex space-x-1">
                                        <input type="range" id="productPriceSize" min="18" max="36" value="30" class="flex-1" onchange="updateFonts()">
                                        <span class="text-xs text-gray-600 w-8" id="productPriceSizeValue">30px</span>
                                    </div>
                                    <div class="flex space-x-1">
                                        <label class="flex items-center text-xs">
                                            <input type="checkbox" id="productPriceBold" checked class="mr-1" onchange="updateFonts()"> <strong>B</strong>
                                        </label>
                                        <label class="flex items-center text-xs">
                                            <input type="checkbox" id="productPriceItalic" class="mr-1" onchange="updateFonts()"> <em>I</em>
                                        </label>
                                        <input type="color" id="productPriceColor" value="#dc2626" class="w-8 h-6 rounded" onchange="updateFonts()">
                                    </div>
                                </div>
                            </div>

                            <!-- Navigation Font -->
                            <div class="bg-white p-4 rounded-lg border">
                                <h5 class="font-bold text-gray-700 mb-3">NAVEGACI√ìN</h5>
                                <div class="space-y-2">
                                    <select id="navigationFont" class="w-full px-2 py-1 text-sm border rounded" onchange="updateFonts()">
                                        <option value="Arial">Arial (Actual)</option>
                                        <option value="Anton">Anton</option>
                                        <option value="Helvetica">Helvetica</option>
                                        <option value="Georgia">Georgia</option>
                                        <option value="Times New Roman">Times New Roman</option>
                                        <option value="Verdana">Verdana</option>
                                        <option value="Impact">Impact</option>
                                        <option value="Trebuchet MS">Trebuchet MS</option>
                                        <option value="Courier New">Courier New</option>
                                        <option value="Oswald">Oswald</option>
                                        <option value="Roboto">Roboto</option>
                                        <option value="Open Sans">Open Sans</option>
                                        <option value="Montserrat">Montserrat</option>
                                        <option value="Poppins">Poppins</option>
                                    </select>
                                    <div class="flex space-x-1">
                                        <input type="range" id="navigationSize" min="14" max="24" value="18" class="flex-1" onchange="updateFonts()">
                                        <span class="text-xs text-gray-600 w-8" id="navigationSizeValue">18px</span>
                                    </div>
                                    <div class="flex space-x-1">
                                        <label class="flex items-center text-xs">
                                            <input type="checkbox" id="navigationBold" checked class="mr-1" onchange="updateFonts()"> <strong>B</strong>
                                        </label>
                                        <label class="flex items-center text-xs">
                                            <input type="checkbox" id="navigationItalic" class="mr-1" onchange="updateFonts()"> <em>I</em>
                                        </label>
                                        <input type="color" id="navigationColor" value="#ffffff" class="w-8 h-6 rounded" onchange="updateFonts()">
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="mt-4 flex space-x-2">
                            <button onclick="loadCurrentFonts()" class="bg-indigo-600 text-white px-4 py-2 rounded hover:bg-indigo-700 transition-colors font-bold text-sm">
                                <i class="fas fa-sync mr-2"></i>CARGAR FUENTES ACTUALES
                            </button>
                            <button onclick="applyFontChanges()" class="bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700 transition-colors font-bold text-sm">
                                <i class="fas fa-save mr-2"></i>APLICAR FUENTES
                            </button>
                            <button onclick="resetFonts()" class="bg-gray-600 text-white px-4 py-2 rounded hover:bg-gray-700 transition-colors font-bold text-sm">
                                <i class="fas fa-undo mr-2"></i>RESTAURAR ORIGINALES
                            </button>
                            <button onclick="previewFonts()" class="bg-purple-600 text-white px-4 py-2 rounded hover:bg-purple-700 transition-colors font-bold text-sm">
                                <i class="fas fa-eye mr-2"></i>VISTA PREVIA
                            </button>
                        </div>
                    </div>

                    <!-- Text Editor Section -->
                    <div class="mb-8 p-6 bg-blue-50 rounded-lg border-2 border-blue-200">
                        <h4 class="text-xl font-bold text-gray-800 mb-4">üìù EDITOR DE TEXTOS</h4>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-bold mb-2 text-gray-700">T√çTULO PRINCIPAL:</label>
                                <input type="text" id="editHeroTitle" class="w-full px-3 py-2 bg-white rounded border focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="MOTORCYCLE GEAR PREMIUM">
                            </div>
                            <div>
                                <label class="block text-sm font-bold mb-2 text-gray-700">SUBT√çTULO:</label>
                                <textarea id="editHeroSubtitle" rows="2" class="w-full px-3 py-2 bg-white rounded border focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="Descripci√≥n del hero"></textarea>
                            </div>
                            <div>
                                <label class="block text-sm font-bold mb-2 text-gray-700">NAVEGACI√ìN - INICIO:</label>
                                <input type="text" id="editNavInicio" class="w-full px-3 py-2 bg-white rounded border focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="INICIO">
                            </div>
                            <div>
                                <label class="block text-sm font-bold mb-2 text-gray-700">NAVEGACI√ìN - PRODUCTOS:</label>
                                <input type="text" id="editNavProductos" class="w-full px-3 py-2 bg-white rounded border focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="PRODUCTOS">
                            </div>
                            <div>
                                <label class="block text-sm font-bold mb-2 text-gray-700">NAVEGACI√ìN - CONTACTO:</label>
                                <input type="text" id="editNavContacto" class="w-full px-3 py-2 bg-white rounded border focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="CONTACTO">
                            </div>
                            <div>
                                <label class="block text-sm font-bold mb-2 text-gray-700">T√çTULO PRODUCTOS:</label>
                                <input type="text" id="editProductsTitle" class="w-full px-3 py-2 bg-white rounded border focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="NUESTROS PRODUCTOS">
                            </div>
                            <div>
                                <label class="block text-sm font-bold mb-2 text-gray-700">T√çTULO MARCAS:</label>
                                <input type="text" id="editBrandsTitle" class="w-full px-3 py-2 bg-white rounded border focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="MARCAS PREMIUM">
                            </div>
                            <div>
                                <label class="block text-sm font-bold mb-2 text-gray-700">T√çTULO CONTACTO:</label>
                                <input type="text" id="editContactTitle" class="w-full px-3 py-2 bg-white rounded border focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="CONT√ÅCTANOS">
                            </div>
                        </div>
                        <div class="mt-4 flex space-x-2">
                            <button onclick="loadCurrentTexts()" class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 transition-colors font-bold text-sm">
                                <i class="fas fa-sync mr-2"></i>CARGAR TEXTOS ACTUALES
                            </button>
                            <button onclick="applyTextChanges()" class="bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700 transition-colors font-bold text-sm">
                                <i class="fas fa-save mr-2"></i>APLICAR CAMBIOS
                            </button>
                            <button onclick="resetTexts()" class="bg-gray-600 text-white px-4 py-2 rounded hover:bg-gray-700 transition-colors font-bold text-sm">
                                <i class="fas fa-undo mr-2"></i>RESTAURAR ORIGINALES
                            </button>
                        </div>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                        <!-- Background Settings -->
                        <div class="space-y-6">
                            <h4 class="text-xl font-bold text-gray-800">FONDO DE P√ÅGINA</h4>
                            <div>
                                <label class="block text-lg font-bold mb-2 text-gray-800">TIPO DE FONDO:</label>
                                <select id="backgroundType" class="w-full px-4 py-3 bg-white rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500 text-lg" onchange="updateBackgroundType()">
                                    <option value="pattern">Patr√≥n</option>
                                    <option value="solid">Color S√≥lido</option>
                                    <option value="gradient">Degradado</option>
                                    <option value="image">Imagen</option>
                                </select>
                            </div>
                            
                            <div>
                                <label class="block text-lg font-bold mb-2 text-gray-800">FONDO DEL HERO:</label>
                                <select id="heroBackgroundType" class="w-full px-4 py-3 bg-white rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500 text-lg" onchange="updateHeroBackgroundType()">
                                    <option value="default">Por Defecto</option>
                                    <option value="solid">Color S√≥lido</option>
                                    <option value="gradient">Degradado</option>
                                    <option value="image">Imagen</option>
                                    <option value="textBg">Imagen Detr√°s del Texto</option>
                                </select>
                            </div>
                            <div id="backgroundControls">
                                <div id="solidColorControl" class="hidden">
                                    <label class="block text-lg font-bold mb-2 text-gray-800">COLOR:</label>
                                    <input type="color" id="backgroundColor" class="w-full h-12 rounded-lg" onchange="updateTheme()">
                                </div>
                                <div id="gradientControl" class="hidden space-y-3">
                                    <label class="block text-lg font-bold mb-2 text-gray-800">COLOR 1:</label>
                                    <input type="color" id="gradientColor1" class="w-full h-12 rounded-lg" onchange="updateTheme()">
                                    <label class="block text-lg font-bold mb-2 text-gray-800">COLOR 2:</label>
                                    <input type="color" id="gradientColor2" class="w-full h-12 rounded-lg" onchange="updateTheme()">
                                </div>
                                <div id="imageControl" class="hidden space-y-3">
                                    <input type="file" id="backgroundImageFile" accept="image/*" class="w-full px-4 py-3 bg-white rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500 text-lg" onchange="handleBackgroundImageUpload(event)">
                                    <input type="url" id="backgroundImageUrl" class="w-full px-4 py-3 bg-white rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500 text-lg" placeholder="O ingresa URL de imagen" onchange="updateTheme()">
                                </div>
                            </div>
                            
                            <div id="heroBackgroundControls">
                                <div id="heroSolidColorControl" class="hidden">
                                    <label class="block text-lg font-bold mb-2 text-gray-800">COLOR HERO:</label>
                                    <input type="color" id="heroBackgroundColor" class="w-full h-12 rounded-lg" onchange="updateHeroBackground()">
                                </div>
                                <div id="heroGradientControl" class="hidden space-y-3">
                                    <label class="block text-lg font-bold mb-2 text-gray-800">COLOR HERO 1:</label>
                                    <input type="color" id="heroGradientColor1" class="w-full h-12 rounded-lg" onchange="updateHeroBackground()">
                                    <label class="block text-lg font-bold mb-2 text-gray-800">COLOR HERO 2:</label>
                                    <input type="color" id="heroGradientColor2" class="w-full h-12 rounded-lg" onchange="updateHeroBackground()">
                                </div>
                                <div id="heroImageControl" class="hidden space-y-3">
                                    <input type="file" id="heroBackgroundImageFile" accept="image/*" class="w-full px-4 py-3 bg-white rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500 text-lg" onchange="handleHeroBackgroundImageUpload(event)">
                                    <input type="url" id="heroBackgroundImageUrl" class="w-full px-4 py-3 bg-white rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500 text-lg" placeholder="O ingresa URL de imagen hero" onchange="updateHeroBackground()">
                                </div>
                                <div id="heroTextBgControl" class="hidden space-y-3">
                                    <label class="block text-sm font-bold mb-2 text-gray-700">IMAGEN DETR√ÅS DEL TEXTO:</label>
                                    <input type="file" id="heroTextBgImageFile" accept="image/*" class="w-full px-4 py-3 bg-white rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500 text-lg" onchange="handleHeroTextBgImageUpload(event)">
                                    <input type="url" id="heroTextBgImageUrl" class="w-full px-4 py-3 bg-white rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500 text-lg" placeholder="O ingresa URL de imagen para texto" onchange="updateHeroBackground()">
                                    <div class="grid grid-cols-2 gap-3">
                                        <div>
                                            <label class="block text-xs font-bold mb-1 text-gray-600">OPACIDAD:</label>
                                            <input type="range" id="textBgOpacity" min="0" max="100" value="20" class="w-full slider-thumb" onchange="updateHeroBackground()">
                                            <span class="text-xs text-gray-600" id="opacityValue">20%</span>
                                        </div>
                                        <div>
                                            <label class="block text-xs font-bold mb-1 text-gray-600">TAMA√ëO:</label>
                                            <select id="textBgSize" class="w-full px-2 py-1 bg-white rounded text-sm" onchange="updateHeroBackground()">
                                                <option value="cover">Cubrir</option>
                                                <option value="contain">Contener</option>
                                                <option value="auto">Autom√°tico</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Logo and Favicon Settings -->
                        <div class="space-y-6">
                            <h4 class="text-xl font-bold text-gray-800">LOGO Y FAVICON</h4>
                            
                            <!-- Logo Section -->
                            <div class="bg-blue-50 p-4 rounded-lg border-2 border-blue-200">
                                <h5 class="text-lg font-bold text-gray-700 mb-3">üñºÔ∏è LOGO PERSONALIZADO</h5>
                                <div class="space-y-3">
                                    <input type="file" id="customLogoFile" accept="image/*" class="w-full px-4 py-3 bg-white rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-lg" onchange="handleLogoUpload(event)">
                                    <input type="url" id="customLogoUrl" class="w-full px-4 py-3 bg-white rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-lg" placeholder="O ingresa URL del logo" onchange="updateLogo()">
                                    <div class="flex space-x-2">
                                        <button onclick="resetLogo()" class="flex-1 bg-gray-600 text-white px-4 py-3 rounded-lg hover:bg-gray-700 transition-colors font-bold text-sm">
                                            <i class="fas fa-undo mr-2"></i>LOGO ORIGINAL
                                        </button>
                                    </div>
                                </div>
                            </div>

                            <!-- Favicon Section -->
                            <div class="bg-green-50 p-4 rounded-lg border-2 border-green-200">
                                <h5 class="text-lg font-bold text-gray-700 mb-3">üîñ FAVICON (Icono de Pesta√±a)</h5>
                                <div class="space-y-3">
                                    <div class="flex items-center space-x-3 mb-3">
                                        <div class="w-8 h-8 border-2 border-gray-300 rounded flex items-center justify-center bg-white">
                                            <img id="faviconPreview" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Crect width='100' height='100' fill='%23dc2626'/%3E%3Ctext x='50' y='60' text-anchor='middle' font-size='40' fill='white'%3EJM%3C/text%3E%3C/svg%3E" alt="Favicon" class="w-full h-full object-contain">
                                        </div>
                                        <span class="text-sm text-gray-600">Vista previa del favicon (16x16px)</span>
                                    </div>
                                    <input type="file" id="customFaviconFile" accept="image/*" class="w-full px-4 py-3 bg-white rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 text-lg" onchange="handleFaviconUpload(event)">
                                    <input type="url" id="customFaviconUrl" class="w-full px-4 py-3 bg-white rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 text-lg" placeholder="O ingresa URL del favicon" onchange="updateFavicon()">
                                    <div class="text-xs text-gray-600 bg-yellow-50 p-2 rounded">
                                        üí° <strong>Recomendaci√≥n:</strong> Usa im√°genes cuadradas de 32x32px o 64x64px para mejores resultados. Formatos: ICO, PNG, SVG.
                                    </div>
                                    <div class="flex space-x-2">
                                        <button onclick="resetFavicon()" class="flex-1 bg-gray-600 text-white px-4 py-3 rounded-lg hover:bg-gray-700 transition-colors font-bold text-sm">
                                            <i class="fas fa-undo mr-2"></i>FAVICON ORIGINAL
                                        </button>
                                        <button onclick="generateFaviconFromLogo()" class="flex-1 bg-blue-600 text-white px-4 py-3 rounded-lg hover:bg-blue-700 transition-colors font-bold text-sm">
                                            <i class="fas fa-magic mr-2"></i>USAR LOGO
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Color Settings -->
                        <div class="space-y-6">
                            <h4 class="text-xl font-bold text-gray-800">COLORES</h4>
                            <div>
                                <label class="block text-lg font-bold mb-2 text-gray-800">COLOR PRIMARIO:</label>
                                <input type="color" id="primaryColor" class="w-full h-12 rounded-lg" onchange="updateTheme()">
                            </div>
                            <div>
                                <label class="block text-lg font-bold mb-2 text-gray-800">COLOR SECUNDARIO:</label>
                                <input type="color" id="secondaryColor" class="w-full h-12 rounded-lg" onchange="updateTheme()">
                            </div>
                            <div>
                                <label class="block text-lg font-bold mb-2 text-gray-800">FONDO DE TARJETAS:</label>
                                <input type="color" id="cardBackground" class="w-full h-12 rounded-lg" onchange="updateTheme()">
                            </div>
                            <div>
                                <label class="block text-lg font-bold mb-2 text-gray-800">COLOR DE TEXTO:</label>
                                <input type="color" id="textColor" class="w-full h-12 rounded-lg" onchange="updateTheme()">
                            </div>
                        </div>
                    </div>
                    
                    <div class="mt-8">
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
                            <div>
                                <h4 class="text-lg font-bold text-gray-800 mb-3">RESPALDO DE DATOS</h4>
                                <div class="flex space-x-2">
                                    <button onclick="exportData()" class="flex-1 bg-blue-600 text-white px-4 py-3 rounded-lg hover:bg-blue-700 transition-colors font-bold text-sm">
                                        <i class="fas fa-download mr-2"></i>EXPORTAR
                                    </button>
                                    <label class="flex-1 bg-purple-600 text-white px-4 py-3 rounded-lg hover:bg-purple-700 transition-colors font-bold text-sm cursor-pointer text-center">
                                        <i class="fas fa-upload mr-2"></i>IMPORTAR
                                        <input type="file" accept=".json" onchange="importData(event)" class="hidden">
                                    </label>
                                </div>
                            </div>
                            <div>
                                <h4 class="text-lg font-bold text-gray-800 mb-3">ACCIONES DE TEMA</h4>
                                <div class="flex space-x-2">
                                    <button onclick="resetTheme()" class="flex-1 bg-gray-600 text-white px-4 py-3 rounded-lg hover:bg-gray-700 transition-colors font-bold text-sm">
                                        <i class="fas fa-undo mr-2"></i>RESTAURAR
                                    </button>
                                    <button onclick="saveTheme()" class="flex-1 bg-green-600 text-white px-4 py-3 rounded-lg hover:bg-green-700 transition-colors font-bold text-sm">
                                        <i class="fas fa-save mr-2"></i>GUARDAR
                                    </button>
                                </div>
                            </div>
                            <div>
                                <h4 class="text-lg font-bold text-gray-800 mb-3">HERRAMIENTAS AVANZADAS</h4>
                                <div class="flex space-x-2">
                                    <button onclick="bulkPriceUpdate()" class="flex-1 bg-orange-600 text-white px-4 py-3 rounded-lg hover:bg-orange-700 transition-colors font-bold text-sm">
                                        <i class="fas fa-calculator mr-2"></i>PRECIOS
                                    </button>
                                    <button onclick="generateReport()" class="flex-1 bg-indigo-600 text-white px-4 py-3 rounded-lg hover:bg-indigo-700 transition-colors font-bold text-sm">
                                        <i class="fas fa-chart-bar mr-2"></i>REPORTE
                                    </button>
                                </div>
                            </div>
                            <div>
                                <h4 class="text-lg font-bold text-gray-800 mb-3">GITHUB INTEGRATION</h4>
                                <div class="flex space-x-2">
                                    <button onclick="exportToGitHub()" class="flex-1 bg-gray-800 text-white px-4 py-3 rounded-lg hover:bg-gray-900 transition-colors font-bold text-sm">
                                        <i class="fab fa-github mr-2"></i>EXPORTAR
                                    </button>
                                    <button onclick="generateGitHubReadme()" class="flex-1 bg-gray-700 text-white px-4 py-3 rounded-lg hover:bg-gray-800 transition-colors font-bold text-sm">
                                        <i class="fas fa-file-alt mr-2"></i>README
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Auto-save status indicator -->
                        <div class="bg-green-100 border border-green-300 rounded-lg p-4 mb-4">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center space-x-2">
                                    <i class="fas fa-save text-green-600"></i>
                                    <span class="text-green-800 font-semibold">Auto-guardado activado</span>
                                </div>
                                <div class="flex items-center space-x-4">
                                    <span class="text-sm text-green-600" id="lastSaveTime">√öltimo guardado: --</span>
                                    <button onclick="manualSave()" class="bg-green-600 text-white px-3 py-1 rounded text-sm hover:bg-green-700 transition-colors">
                                        <i class="fas fa-save mr-1"></i>GUARDAR AHORA
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Product Detail Modal -->
    <div id="productDetailModal" class="fixed inset-0 bg-black bg-opacity-90 z-50 hidden">
        <div class="product-detail-modal bg-white h-full w-full md:w-2/3 lg:w-1/2 xl:w-2/5 ml-auto overflow-y-auto">
            <!-- Header -->
            <div class="sticky top-0 bg-white border-b border-gray-200 p-4 flex items-center justify-between z-10">
                <button onclick="closeProductDetail()" class="flex items-center space-x-2 text-gray-600 hover:text-gray-800 transition-colors">
                    <i class="fas fa-arrow-left text-xl"></i>
                    <span class="font-semibold">Volver</span>
                </button>
                <button onclick="shareProduct()" class="text-gray-600 hover:text-gray-800 transition-colors">
                    <i class="fas fa-share-alt text-xl"></i>
                </button>
            </div>
            
            <!-- Content -->
            <div id="productDetailContent" class="p-6">
                <!-- Content will be loaded here -->
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="bg-black text-white py-12">
        <div class="container mx-auto px-4 text-center">
            <div class="flex items-center justify-center space-x-4 mb-6">
                <div id="footerLogoContainer">
                    <i class="fas fa-motorcycle text-4xl text-red-500" id="footerDefaultLogo"></i>
                    <img id="footerCustomLogo" src="" alt="Logo" class="h-10 w-auto hidden">
                </div>
                <span class="logo-text text-3xl">JACKETS MASTER</span>
            </div>
            <p class="text-gray-400 text-lg">&copy; 2025 Jackets Master. Todos los derechos reservados.</p>
        </div>
    </footer>

    <script>
        // Sample products data with expanded categories
        let products = [
            {
                id: 1,
                name: "Jacket Racing Pro",
                price: 179990,
                category: "chaquetas",
                brand: "alpinestars",
                sizes: ["S", "M", "L", "XL"],
                description: "Jacket de cuero premium para racing con protecciones CE y dise√±o aerodin√°mico.",
                images: [
                    "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='300' height='300' viewBox='0 0 300 300'%3E%3Crect width='300' height='300' fill='%23dc2626'/%3E%3Crect x='20' y='20' width='260' height='260' fill='%23000' rx='10'/%3E%3Ctext x='150' y='140' text-anchor='middle' dy='.3em' font-family='Arial' font-size='18' fill='%23dc2626' font-weight='bold'%3ERACING%3C/text%3E%3Ctext x='150' y='170' text-anchor='middle' dy='.3em' font-family='Arial' font-size='16' fill='%23fff'%3EPRO%3C/text%3E%3C/svg%3E"
                ],
                image: "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='300' height='300' viewBox='0 0 300 300'%3E%3Crect width='300' height='300' fill='%23dc2626'/%3E%3Crect x='20' y='20' width='260' height='260' fill='%23000' rx='10'/%3E%3Ctext x='150' y='140' text-anchor='middle' dy='.3em' font-family='Arial' font-size='18' fill='%23dc2626' font-weight='bold'%3ERACING%3C/text%3E%3Ctext x='150' y='170' text-anchor='middle' dy='.3em' font-family='Arial' font-size='16' fill='%23fff'%3EPRO%3C/text%3E%3C/svg%3E"
            },
            {
                id: 2,
                name: "Guantes Touring Comfort",
                price: 54990,
                category: "guantes",
                brand: "tourmaster",
                sizes: ["S", "M", "L", "XL"],
                description: "Guantes impermeables con protecci√≥n en nudillos y palma reforzada.",
                image: "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='300' height='300' viewBox='0 0 300 300'%3E%3Crect width='300' height='300' fill='%23374151'/%3E%3Crect x='50' y='80' width='200' height='140' fill='%23dc2626' rx='20'/%3E%3Ctext x='150' y='140' text-anchor='middle' dy='.3em' font-family='Arial' font-size='16' fill='%23fff' font-weight='bold'%3EGUANTES%3C/text%3E%3Ctext x='150' y='170' text-anchor='middle' dy='.3em' font-family='Arial' font-size='14' fill='%23000'%3ETOURING%3C/text%3E%3C/svg%3E"
            },
            {
                id: 3,
                name: "Pantalones Kevlar Pro",
                price: 119990,
                category: "pantalones",
                brand: "cortech",
                sizes: ["30", "32", "34", "36", "38"],
                description: "Pantalones con refuerzos de kevlar y protecciones removibles en rodillas.",
                image: "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='300' height='300' viewBox='0 0 300 300'%3E%3Crect width='300' height='300' fill='%23000'/%3E%3Crect x='80' y='50' width='140' height='200' fill='%23dc2626' rx='10'/%3E%3Ctext x='150' y='140' text-anchor='middle' dy='.3em' font-family='Arial' font-size='14' fill='%23fff' font-weight='bold'%3EPANTALONES%3C/text%3E%3Ctext x='150' y='170' text-anchor='middle' dy='.3em' font-family='Arial' font-size='12' fill='%23000'%3EKEVLAR%3C/text%3E%3C/svg%3E"
            },
            {
                id: 4,
                name: "Rodilleras Deportivas",
                price: 27990,
                category: "rodilleras",
                brand: "noru",
                sizes: ["S", "M", "L"],
                description: "Protecci√≥n para rodillas con sistema de ventilaci√≥n y ajuste ergon√≥mico.",
                image: "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='300' height='300' viewBox='0 0 300 300'%3E%3Crect width='300' height='300' fill='%23f3f4f6'/%3E%3Ccircle cx='150' cy='150' r='80' fill='%23000'/%3E%3Ccircle cx='150' cy='150' r='60' fill='%23dc2626'/%3E%3Ctext x='150' y='140' text-anchor='middle' dy='.3em' font-family='Arial' font-size='12' fill='%23fff' font-weight='bold'%3ERODILLERAS%3C/text%3E%3Ctext x='150' y='170' text-anchor='middle' dy='.3em' font-family='Arial' font-size='10' fill='%23000'%3ESPORT%3C/text%3E%3C/svg%3E"
            },
            {
                id: 5,
                name: "Protecciones Espalda",
                price: 79990,
                category: "protecciones",
                brand: "alpinestars",
                sizes: ["S", "M", "L", "XL"],
                description: "Protector de espalda CE nivel 2 con sistema de ventilaci√≥n avanzado.",
                image: "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='300' height='300' viewBox='0 0 300 300'%3E%3Crect width='300' height='300' fill='%23dc2626'/%3E%3Crect x='60' y='40' width='180' height='220' fill='%23000' rx='15'/%3E%3Ctext x='150' y='130' text-anchor='middle' dy='.3em' font-family='Arial' font-size='14' fill='%23dc2626' font-weight='bold'%3EPROTECCI√ìN%3C/text%3E%3Ctext x='150' y='160' text-anchor='middle' dy='.3em' font-family='Arial' font-size='12' fill='%23fff'%3EESPALDA%3C/text%3E%3C/svg%3E"
            },
            {
                id: 6,
                name: "Bolso Tanque Magn√©tico",
                price: 47990,
                category: "bolsos",
                brand: "tourmaster",
                sizes: ["√önico"],
                description: "Bolso magn√©tico para tanque con compartimentos impermeables y ventana t√°ctil.",
                image: "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='300' height='300' viewBox='0 0 300 300'%3E%3Crect width='300' height='300' fill='%23374151'/%3E%3Crect x='50' y='100' width='200' height='100' fill='%23dc2626' rx='10'/%3E%3Ctext x='150' y='140' text-anchor='middle' dy='.3em' font-family='Arial' font-size='16' fill='%23fff' font-weight='bold'%3EBOLSO%3C/text%3E%3Ctext x='150' y='170' text-anchor='middle' dy='.3em' font-family='Arial' font-size='12' fill='%23000'%3ETANQUE%3C/text%3E%3C/svg%3E"
            },
            {
                id: 7,
                name: "Liner T√©rmico Invierno",
                price: 23990,
                category: "liner",
                brand: "cortech",
                sizes: ["S", "M", "L", "XL"],
                description: "Forro t√©rmico removible para jackets con tecnolog√≠a de regulaci√≥n t√©rmica.",
                image: "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='300' height='300' viewBox='0 0 300 300'%3E%3Crect width='300' height='300' fill='%23000'/%3E%3Crect x='70' y='70' width='160' height='160' fill='%23dc2626' rx='20'/%3E%3Ctext x='150' y='140' text-anchor='middle' dy='.3em' font-family='Arial' font-size='16' fill='%23fff' font-weight='bold'%3ELINER%3C/text%3E%3Ctext x='150' y='170' text-anchor='middle' dy='.3em' font-family='Arial' font-size='12' fill='%23000'%3ET√âRMICO%3C/text%3E%3C/svg%3E"
            }
        ];

        // Categories management
        let categories = [
            { id: 'chaquetas', name: 'Jackets', active: true },
            { id: 'guantes', name: 'Guantes', active: true },
            { id: 'pantalones', name: 'Pantalones', active: true },
            { id: 'rodilleras', name: 'Rodilleras', active: true },
            { id: 'protecciones', name: 'Protecciones', active: true },
            { id: 'bolsos', name: 'Bolsos', active: true },
            { id: 'liner', name: 'Liner', active: true },
            { id: 'hidden', name: 'Productos Eliminados', active: false }
        ];

        // Brands management
        let brands = [
            { 
                id: 'cortech', 
                name: 'Cortech', 
                description: 'Tecnolog√≠a avanzada para el motociclista moderno',
                logo: "data:image/svg+xml,%3Csvg width='120' height='80' viewBox='0 0 120 80'%3E%3Crect width='120' height='80' fill='%23dc2626' rx='10'/%3E%3Ctext x='60' y='35' text-anchor='middle' font-family='Arial' font-size='14' font-weight='bold' fill='white'%3ECORTECH%3C/text%3E%3Ctext x='60' y='55' text-anchor='middle' font-family='Arial' font-size='10' fill='black'%3EPERFORMANCE%3C/text%3E%3C/svg%3E",
                active: true 
            },
            { 
                id: 'alpinestars', 
                name: 'Alpinestars', 
                description: 'Herencia en carreras y protecci√≥n premium',
                logo: "data:image/svg+xml,%3Csvg width='120' height='80' viewBox='0 0 120 80'%3E%3Crect width='120' height='80' fill='%23000' rx='10'/%3E%3Cpolygon points='60,15 70,35 50,35' fill='%23dc2626'/%3E%3Ctext x='60' y='50' text-anchor='middle' font-family='Arial' font-size='12' font-weight='bold' fill='%23dc2626'%3EALPINESTARS%3C/text%3E%3Ctext x='60' y='65' text-anchor='middle' font-family='Arial' font-size='8' fill='white'%3ERACING HERITAGE%3C/text%3E%3C/svg%3E",
                active: true 
            },
            { 
                id: 'tourmaster', 
                name: 'TourMaster', 
                description: 'Equipamiento para grandes aventuras',
                logo: "data:image/svg+xml,%3Csvg width='120' height='80' viewBox='0 0 120 80'%3E%3Crect width='120' height='80' fill='%23374151' rx='10'/%3E%3Ccircle cx='60' cy='30' r='12' fill='%23dc2626'/%3E%3Ctext x='60' y='50' text-anchor='middle' font-family='Arial' font-size='11' font-weight='bold' fill='white'%3ETOURMASTER%3C/text%3E%3Ctext x='60' y='65' text-anchor='middle' font-family='Arial' font-size='8' fill='%23dc2626'%3EADVENTURE%3C/text%3E%3C/svg%3E",
                active: true 
            },
            { 
                id: 'noru', 
                name: 'Noru', 
                description: 'Innovaci√≥n y dise√±o de vanguardia',
                logo: "data:image/svg+xml,%3Csvg width='120' height='80' viewBox='0 0 120 80'%3E%3Crect width='120' height='80' fill='%23dc2626' rx='10'/%3E%3Crect x='20' y='20' width='80' height='40' fill='%23000' rx='5'/%3E%3Ctext x='60' y='45' text-anchor='middle' font-family='Arial' font-size='16' font-weight='bold' fill='%23dc2626'%3ENORU%3C/text%3E%3Ctext x='60' y='70' text-anchor='middle' font-family='Arial' font-size='8' fill='white'%3EINNOVATION%3C/text%3E%3C/svg%3E",
                active: true 
            }
        ];

        // Theme customization
        let currentTheme = {
            background: {
                type: 'pattern', // 'solid', 'gradient', 'pattern', 'image'
                value: '#9ca3af',
                gradient: 'linear-gradient(135deg, #9ca3af 0%, #6b7280 100%)',
                image: ''
            },
            cardBackground: '#f3f4f6',
            primaryColor: '#dc2626',
            secondaryColor: '#000000',
            textColor: '#374151',
            buttonColor: '#dc2626',
            customLogo: '',
            customFavicon: "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Crect width='100' height='100' fill='%23dc2626'/%3E%3Ctext x='50' y='60' text-anchor='middle' font-size='40' fill='white'%3EJM%3C/text%3E%3C/svg%3E",
            heroBackground: {
                type: 'default', // 'default', 'solid', 'gradient', 'image', 'textBg'
                value: '',
                gradient: '',
                image: '',
                textBg: {
                    image: '',
                    opacity: 20,
                    size: 'cover'
                }
            }
        };

        // Text content management
        let siteTexts = {
            heroTitle: 'MOTORCYCLE GEAR PREMIUM',
            heroSubtitle: 'Descubra nuestra colecci√≥n de equipo de motociclista de alta calidad. Protecci√≥n, estilo y durabilidad en cada prenda para los verdaderos riders.',
            navInicio: 'INICIO',
            navProductos: 'PRODUCTOS',
            navContacto: 'CONTACTO',
            productsTitle: 'NUESTROS PRODUCTOS',
            brandsTitle: 'MARCAS PREMIUM',
            contactTitle: 'CONT√ÅCTANOS'
        };

        // Font customization management
        let siteFonts = {
            heroTitle: {
                family: 'Anton',
                size: 64,
                bold: true,
                italic: true,
                color: '#dc2626'
            },
            sectionTitle: {
                family: 'Anton',
                size: 48,
                bold: true,
                italic: true,
                color: '#dc2626'
            },
            productName: {
                family: 'Arial',
                size: 24,
                bold: true,
                italic: false,
                color: '#374151'
            },
            productDesc: {
                family: 'Arial',
                size: 18,
                bold: false,
                italic: false,
                color: '#4b5563'
            },
            productPrice: {
                family: 'Arial',
                size: 30,
                bold: true,
                italic: false,
                color: '#dc2626'
            },
            navigation: {
                family: 'Arial',
                size: 18,
                bold: true,
                italic: false,
                color: '#ffffff'
            }
        };

        // Links management
        let siteLinks = {
            whatsappCatalog: {
                text: 'CAT√ÅLOGO WHATSAPP',
                url: 'https://wa.me/c/50688845533'
            },
            whatsappChannel: {
                text: 'CANAL PROMOCIONES',
                url: 'https://whatsapp.com/channel/0029VbBv0Wk59PwXaRqS6C2d'
            },
            waze: {
                text: 'ABRIR EN WAZE',
                url: 'https://waze.com/ul/hd1u0rps2s'
            }
        };

        let isAdminLoggedIn = false;

        // Initialize the page
        document.addEventListener('DOMContentLoaded', function() {
            // Load saved data first
            loadSavedData();
            
            // Then initialize displays
            displayProducts();
            loadBrandFilters();
            loadCategoryFilters();
            displayBrands();
            initializeTheme();
            applyLogo();
            applyFavicon();
            applyTexts();
            applyFonts();
            
            // Initialize form autofill
            initializeFormAutofill();
            
            console.log('üöÄ Jackets Master inicializado correctamente');
        });

        // Form autofill system
        function initializeFormAutofill() {
            const forms = document.querySelectorAll('form');
            
            forms.forEach(form => {
                // Load saved form data
                loadFormData(form);
                
                // Save form data on input
                const inputs = form.querySelectorAll('input, select, textarea');
                inputs.forEach(input => {
                    input.addEventListener('input', () => saveFormData(form));
                    input.addEventListener('change', () => saveFormData(form));
                });
            });
        }

        function saveFormData(form) {
            if (!form.id) return;
            
            const formData = {};
            const inputs = form.querySelectorAll('input, select, textarea');
            
            inputs.forEach(input => {
                if (input.name && input.value) {
                    if (input.type === 'checkbox') {
                        formData[input.name] = input.checked;
                    } else if (input.type === 'radio') {
                        if (input.checked) {
                            formData[input.name] = input.value;
                        }
                    } else {
                        formData[input.name] = input.value;
                    }
                }
            });
            
            try {
                localStorage.setItem(`form_${form.id}`, JSON.stringify(formData));
            } catch (error) {
                console.warn('No se pudo guardar datos del formulario:', error);
            }
        }

        function loadFormData(form) {
            if (!form.id) return;
            
            try {
                const savedData = localStorage.getItem(`form_${form.id}`);
                if (!savedData) return;
                
                const formData = JSON.parse(savedData);
                
                Object.keys(formData).forEach(name => {
                    const input = form.querySelector(`[name="${name}"]`);
                    if (input) {
                        if (input.type === 'checkbox') {
                            input.checked = formData[name];
                        } else if (input.type === 'radio') {
                            if (input.value === formData[name]) {
                                input.checked = true;
                            }
                        } else {
                            input.value = formData[name];
                        }
                    }
                });
            } catch (error) {
                console.warn('No se pudo cargar datos del formulario:', error);
            }
        }

        function clearFormData(formId) {
            try {
                localStorage.removeItem(`form_${formId}`);
            } catch (error) {
                console.warn('No se pudo limpiar datos del formulario:', error);
            }
        }

        // Links management functions
        function loadCurrentLinks() {
            document.getElementById('editWhatsappCatalogText').value = siteLinks.whatsappCatalog.text;
            document.getElementById('editWhatsappCatalogLink').value = siteLinks.whatsappCatalog.url;
            document.getElementById('editWhatsappChannelText').value = siteLinks.whatsappChannel.text;
            document.getElementById('editWhatsappChannelLink').value = siteLinks.whatsappChannel.url;
            document.getElementById('editWazeText').value = siteLinks.waze.text;
            document.getElementById('editWazeLink').value = siteLinks.waze.url;
            showSuccessMessage('Enlaces actuales cargados en el editor');
        }

        function applyLinkChanges() {
            if (!isAdminLoggedIn) {
                alert('Debes iniciar sesi√≥n como administrador.');
                return;
            }

            // Get values from form
            siteLinks.whatsappCatalog.text = document.getElementById('editWhatsappCatalogText').value || siteLinks.whatsappCatalog.text;
            siteLinks.whatsappCatalog.url = document.getElementById('editWhatsappCatalogLink').value || siteLinks.whatsappCatalog.url;
            siteLinks.whatsappChannel.text = document.getElementById('editWhatsappChannelText').value || siteLinks.whatsappChannel.text;
            siteLinks.whatsappChannel.url = document.getElementById('editWhatsappChannelLink').value || siteLinks.whatsappChannel.url;
            siteLinks.waze.text = document.getElementById('editWazeText').value || siteLinks.waze.text;
            siteLinks.waze.url = document.getElementById('editWazeLink').value || siteLinks.waze.url;

            // Apply changes to the page
            applyLinks();
            
            // Auto-save
            enhancedAutoSave();
            
            showSuccessMessage('¬°Enlaces actualizados exitosamente!');
        }

        function applyLinks() {
            // Apply links to all elements
            const whatsappCatalogLink = document.getElementById('whatsappCatalogLink');
            const whatsappCatalogText = document.getElementById('whatsappCatalogText');
            const whatsappChannelLink = document.getElementById('whatsappChannelLink');
            const whatsappChannelText = document.getElementById('whatsappChannelText');
            const wazeLink = document.getElementById('wazeLink');
            const wazeText = document.getElementById('wazeText');
            
            if (whatsappCatalogLink) whatsappCatalogLink.href = siteLinks.whatsappCatalog.url;
            if (whatsappCatalogText) whatsappCatalogText.textContent = siteLinks.whatsappCatalog.text;
            if (whatsappChannelLink) whatsappChannelLink.href = siteLinks.whatsappChannel.url;
            if (whatsappChannelText) whatsappChannelText.textContent = siteLinks.whatsappChannel.text;
            if (wazeLink) wazeLink.href = siteLinks.waze.url;
            if (wazeText) wazeText.textContent = siteLinks.waze.text;
        }

        function resetLinks() {
            if (!isAdminLoggedIn) {
                alert('Debes iniciar sesi√≥n como administrador.');
                return;
            }

            if (confirm('¬øRestaurar todos los enlaces a los valores originales?')) {
                siteLinks = {
                    whatsappCatalog: {
                        text: 'CAT√ÅLOGO WHATSAPP',
                        url: 'https://wa.me/c/50688845533'
                    },
                    whatsappChannel: {
                        text: 'CANAL PROMOCIONES',
                        url: 'https://whatsapp.com/channel/0029VbBv0Wk59PwXaRqS6C2d'
                    },
                    waze: {
                        text: 'ABRIR EN WAZE',
                        url: 'https://waze.com/ul/hd1u0rps2s'
                    }
                };
                
                applyLinks();
                loadCurrentLinks();
                enhancedAutoSave();
                showSuccessMessage('Enlaces restaurados a los valores originales');
            }
        }

        // Text management functions
        function loadCurrentTexts() {
            document.getElementById('editHeroTitle').value = siteTexts.heroTitle;
            document.getElementById('editHeroSubtitle').value = siteTexts.heroSubtitle;
            document.getElementById('editNavInicio').value = siteTexts.navInicio;
            document.getElementById('editNavProductos').value = siteTexts.navProductos;
            document.getElementById('editNavContacto').value = siteTexts.navContacto;
            document.getElementById('editProductsTitle').value = siteTexts.productsTitle;
            document.getElementById('editBrandsTitle').value = siteTexts.brandsTitle;
            document.getElementById('editContactTitle').value = siteTexts.contactTitle;
            showSuccessMessage('Textos actuales cargados en el editor');
        }

        function applyTextChanges() {
            if (!isAdminLoggedIn) {
                alert('Debes iniciar sesi√≥n como administrador.');
                return;
            }

            // Get values from form
            siteTexts.heroTitle = document.getElementById('editHeroTitle').value || siteTexts.heroTitle;
            siteTexts.heroSubtitle = document.getElementById('editHeroSubtitle').value || siteTexts.heroSubtitle;
            siteTexts.navInicio = document.getElementById('editNavInicio').value || siteTexts.navInicio;
            siteTexts.navProductos = document.getElementById('editNavProductos').value || siteTexts.navProductos;
            siteTexts.navContacto = document.getElementById('editNavContacto').value || siteTexts.navContacto;
            siteTexts.productsTitle = document.getElementById('editProductsTitle').value || siteTexts.productsTitle;
            siteTexts.brandsTitle = document.getElementById('editBrandsTitle').value || siteTexts.brandsTitle;
            siteTexts.contactTitle = document.getElementById('editContactTitle').value || siteTexts.contactTitle;

            // Apply changes to the page
            applyTexts();
            
            // Auto-save
            enhancedAutoSave();
            
            showSuccessMessage('¬°Textos actualizados exitosamente!');
        }

        function applyTexts() {
            // Apply texts to all elements
            const heroTitle = document.getElementById('heroTitle');
            const heroSubtitle = document.getElementById('heroSubtitle');
            
            if (heroTitle) heroTitle.textContent = siteTexts.heroTitle;
            if (heroSubtitle) heroSubtitle.textContent = siteTexts.heroSubtitle;
            
            // Navigation
            const navInicio = document.getElementById('navInicio');
            const navProductos = document.getElementById('navProductos');
            const navContacto = document.getElementById('navContacto');
            const mobileNavInicio = document.getElementById('mobileNavInicio');
            const mobileNavProductos = document.getElementById('mobileNavProductos');
            const mobileNavContacto = document.getElementById('mobileNavContacto');
            
            if (navInicio) navInicio.textContent = siteTexts.navInicio;
            if (navProductos) navProductos.textContent = siteTexts.navProductos;
            if (navContacto) navContacto.textContent = siteTexts.navContacto;
            if (mobileNavInicio) mobileNavInicio.textContent = siteTexts.navInicio;
            if (mobileNavProductos) mobileNavProductos.textContent = siteTexts.navProductos;
            if (mobileNavContacto) mobileNavContacto.textContent = siteTexts.navContacto;
            
            // Section titles
            const productsTitle = document.getElementById('productsTitle');
            const brandsTitle = document.getElementById('brandsTitle');
            const contactTitle = document.getElementById('contactTitle');
            
            if (productsTitle) productsTitle.textContent = siteTexts.productsTitle;
            if (brandsTitle) brandsTitle.textContent = siteTexts.brandsTitle;
            if (contactTitle) contactTitle.textContent = siteTexts.contactTitle;
        }

        function resetTexts() {
            if (!isAdminLoggedIn) {
                alert('Debes iniciar sesi√≥n como administrador.');
                return;
            }

            if (confirm('¬øRestaurar todos los textos a los valores originales?')) {
                siteTexts = {
                    heroTitle: 'MOTORCYCLE GEAR PREMIUM',
                    heroSubtitle: 'Descubra nuestra colecci√≥n de equipo de motociclista de alta calidad. Protecci√≥n, estilo y durabilidad en cada prenda para los verdaderos riders.',
                    navInicio: 'INICIO',
                    navProductos: 'PRODUCTOS',
                    navContacto: 'CONTACTO',
                    productsTitle: 'NUESTROS PRODUCTOS',
                    brandsTitle: 'MARCAS PREMIUM',
                    contactTitle: 'CONT√ÅCTANOS'
                };
                
                applyTexts();
                loadCurrentTexts();
                enhancedAutoSave();
                showSuccessMessage('Textos restaurados a los valores originales');
            }
        }

        // Mobile menu toggle
        function toggleMobileMenu() {
            const menu = document.getElementById('mobileMenu');
            menu.classList.toggle('hidden');
        }

        // Admin login toggle
        function toggleAdminLogin() {
            const modal = document.getElementById('adminLogin');
            modal.classList.toggle('hidden');
        }

        // Admin login
        function adminLogin(event) {
            event.preventDefault();
            const user = document.getElementById('adminUser').value;
            const pass = document.getElementById('adminPass').value;
            
            if (user === 'jm' && pass === 'jm2024') {
                isAdminLoggedIn = true;
                toggleAdminLogin();
                showAdminPanel();
                alert('¬°Acceso concedido! Bienvenido al panel de administraci√≥n.');
            } else {
                alert('Credenciales incorrectas. Revisa la pista.');
            }
        }

        // Show admin panel
        function showAdminPanel() {
            document.getElementById('adminPanel').classList.add('active');
            loadAdminProducts();
            // Refresh category filters to show hidden category for admin
            loadCategoryFilters();
        }

        // Close admin panel
        function closeAdminPanel() {
            document.getElementById('adminPanel').classList.remove('active');
            isAdminLoggedIn = false;
        }

        // Display products
        function displayProducts(productsToShow = products) {
            const grid = document.getElementById('productsGrid');
            grid.innerHTML = '';

            // Filter products based on admin status and category selection
            let filteredProducts;
            const categoryFilter = document.getElementById('categoryFilter')?.value;
            
            if (isAdminLoggedIn && categoryFilter === 'hidden') {
                // Show only deleted products for admin when hidden category is selected
                filteredProducts = productsToShow.filter(product => product.deleted === true);
            } else {
                // Filter out inactive and deleted products for public view
                filteredProducts = productsToShow.filter(product => product.active !== false && product.deleted !== true);
            }

            if (filteredProducts.length === 0) {
                const message = categoryFilter === 'hidden' ? 
                    'No hay productos eliminados' : 
                    'No se encontraron productos';
                grid.innerHTML = `
                    <div class="col-span-full text-center py-12">
                        <i class="fas fa-search text-6xl text-gray-400 mb-4"></i>
                        <p class="text-2xl text-gray-600 mb-2">${message}</p>
                        <p class="text-gray-500">Intenta ajustar los filtros de b√∫squeda</p>
                    </div>
                `;
                return;
            }

            filteredProducts.forEach(product => {
                const hasMultipleImages = product.images && product.images.length > 1;
                const productCard = `
                    <div class="product-card rounded-xl shadow-xl overflow-hidden border-2 border-gray-300 cursor-pointer" 
                         data-category="${product.category}" 
                         data-price="${product.price}" 
                         data-sizes="${product.sizes.join(',')}" 
                         data-brand="${product.brand}"
                         onclick="openProductDetail(${product.id})">
                        
                        <!-- Image Container with Navigation -->
                        <div class="relative">
                            <div class="image-carousel" id="carousel-${product.id}">
                                ${hasMultipleImages ? 
                                    product.images.map((img, index) => `
                                        <img src="${img}" alt="${product.name} - Imagen ${index + 1}" 
                                             class="w-full h-48 md:h-56 object-cover carousel-image ${index === 0 ? 'active' : 'hidden'}" 
                                             data-index="${index}">
                                    `).join('') :
                                    `<img src="${product.image}" alt="${product.name}" class="w-full h-48 md:h-56 object-cover">`
                                }
                            </div>
                            
                            ${hasMultipleImages ? `
                                <!-- Image Navigation -->
                                <div class="absolute bottom-2 left-1/2 transform -translate-x-1/2 flex space-x-1">
                                    ${product.images.map((_, index) => `
                                        <button onclick="event.stopPropagation(); changeCarouselImage(${product.id}, ${index})" 
                                                class="w-2 h-2 rounded-full transition-colors carousel-dot ${index === 0 ? 'bg-white' : 'bg-white bg-opacity-50'}" 
                                                data-product="${product.id}" data-index="${index}"></button>
                                    `).join('')}
                                </div>
                                
                                <!-- Navigation Arrows -->
                                <button onclick="event.stopPropagation(); previousCarouselImage(${product.id})" 
                                        class="absolute left-2 top-1/2 transform -translate-y-1/2 bg-black bg-opacity-50 text-white rounded-full w-8 h-8 flex items-center justify-center hover:bg-opacity-75 transition-opacity">
                                    <i class="fas fa-chevron-left text-sm"></i>
                                </button>
                                <button onclick="event.stopPropagation(); nextCarouselImage(${product.id})" 
                                        class="absolute right-2 top-1/2 transform -translate-y-1/2 bg-black bg-opacity-50 text-white rounded-full w-8 h-8 flex items-center justify-center hover:bg-opacity-75 transition-opacity">
                                    <i class="fas fa-chevron-right text-sm"></i>
                                </button>
                                
                                <!-- Image Counter -->
                                <div class="absolute top-2 right-2 bg-black bg-opacity-75 text-white px-2 py-1 rounded text-xs">
                                    <span id="counter-${product.id}">1</span>/${product.images.length}
                                </div>
                            ` : ''}
                        </div>
                        
                        <!-- Product Info -->
                        <div class="p-3 md:p-6">
                            <div class="flex flex-col md:flex-row md:justify-between md:items-start mb-2 md:mb-3">
                                <h3 class="text-lg md:text-2xl font-bold text-gray-800 mb-1 md:mb-0">${product.name}</h3>
                                <span class="bg-black text-red-500 px-2 py-1 rounded text-xs md:text-sm font-bold uppercase self-start">${product.brand}</span>
                            </div>
                            <p class="text-gray-700 mb-3 md:mb-4 text-sm md:text-lg line-clamp-2">${product.description}</p>
                            <div class="flex flex-col md:flex-row md:justify-between md:items-center mb-3 md:mb-4">
                                <span class="text-xl md:text-3xl font-bold text-red-600 mb-2 md:mb-0">‚Ç°${product.price.toLocaleString('es-CR')}</span>
                                <span class="bg-red-600 text-white px-2 md:px-3 py-1 rounded-full text-xs md:text-sm font-bold uppercase self-start">${product.category}</span>
                            </div>
                            <div class="mb-3 md:mb-6">
                                <span class="text-sm md:text-lg text-gray-700 font-semibold">Tallas: ${product.sizes.join(', ')}</span>
                            </div>
                            <button onclick="event.stopPropagation(); contactForProduct('${product.name}')" class="w-full btn-primary text-white py-2 md:py-3 rounded-lg font-bold text-sm md:text-lg">
                                <i class="fas fa-shopping-cart mr-2"></i>CONSULTAR
                            </button>
                        </div>
                    </div>
                `;
                grid.innerHTML += productCard;
            });
        }

        // Update price range display and filter
        function updatePriceRange() {
            const minPrice = parseInt(document.getElementById('minPrice').value);
            const maxPrice = parseInt(document.getElementById('maxPrice').value);
            
            // Ensure min is not greater than max
            if (minPrice > maxPrice) {
                document.getElementById('minPrice').value = maxPrice;
                return;
            }
            
            // Update display
            document.getElementById('minPriceDisplay').textContent = `‚Ç°${minPrice.toLocaleString('es-CR')}`;
            document.getElementById('maxPriceDisplay').textContent = maxPrice >= 200000 ? '‚Ç°200,000+' : `‚Ç°${maxPrice.toLocaleString('es-CR')}`;
            
            // Filter products
            filterProducts();
        }

        // Filter products
        function filterProducts() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const categoryFilter = document.getElementById('categoryFilter').value;
            const sizeFilter = document.getElementById('sizeFilter').value;
            const brandFilter = document.getElementById('brandFilter').value;
            const minPrice = parseInt(document.getElementById('minPrice')?.value || 0);
            const maxPrice = parseInt(document.getElementById('maxPrice')?.value || 200000);

            let filteredProducts = products.filter(product => {
                // Handle deleted products based on category selection and admin status
                if (categoryFilter === 'hidden') {
                    // Only show deleted products when hidden category is selected
                    if (!isAdminLoggedIn || product.deleted !== true) return false;
                } else {
                    // Skip deleted products in normal view
                    if (product.deleted === true) return false;
                }
                
                const matchesSearch = product.name.toLowerCase().includes(searchTerm) || 
                                    product.description.toLowerCase().includes(searchTerm);
                const matchesCategory = !categoryFilter || 
                                      (categoryFilter === 'hidden' ? product.deleted === true : product.category === categoryFilter);
                const matchesSize = !sizeFilter || product.sizes.includes(sizeFilter);
                const matchesBrand = !brandFilter || product.brand === brandFilter;
                const matchesPrice = product.price >= minPrice && (maxPrice >= 200000 ? true : product.price <= maxPrice);

                return matchesSearch && matchesCategory && matchesPrice && matchesSize && matchesBrand;
            });

            displayProducts(filteredProducts);
        }

        // Clear all filters
        function clearFilters() {
            document.getElementById('searchInput').value = '';
            document.getElementById('categoryFilter').value = '';
            document.getElementById('sizeFilter').value = '';
            document.getElementById('brandFilter').value = '';
            document.getElementById('minPrice').value = 0;
            document.getElementById('maxPrice').value = 200000;
            document.getElementById('minPriceDisplay').textContent = '‚Ç°0';
            document.getElementById('maxPriceDisplay').textContent = '‚Ç°200,000+';
            displayProducts();
        }

        // Contact for product WITH ANALYTICS
        function contactForProduct(productName) {
            // Track product inquiry
            const product = products.find(p => p.name === productName);
            if (product) {
                product.inquiries = (product.inquiries || 0) + 1;
                product.lastInquiry = new Date().toISOString();
                
                // Auto-save analytics data
                enhancedAutoSave();
                
                console.log(`üìä Consulta registrada para: ${productName} (Total: ${product.inquiries})`);
            }
            
            const message = `Hola, estoy interesado en el ${productName}. ¬øPodr√≠an darme m√°s informaci√≥n sobre disponibilidad en tienda?`;
            const whatsappUrl = `https://wa.me/50688845533?text=${encodeURIComponent(message)}`;
            window.open(whatsappUrl, '_blank', 'noopener,noreferrer');
        }

        // Track product views
        function trackProductView(productName) {
            const product = products.find(p => p.name === productName);
            if (product) {
                product.views = (product.views || 0) + 1;
                product.lastViewed = new Date().toISOString();
                
                // Auto-save view data (less frequent to avoid performance issues)
                if (product.views % 5 === 0) {
                    enhancedAutoSave();
                }
            }
        }

        // Send message
        function sendMessage(event) {
            event.preventDefault();
            alert('¬°Mensaje enviado! Te contactaremos pronto.');
            event.target.reset();
        }

        // Add/Edit product (Admin) - ENHANCED FUNCTION WITH AUTO-SAVE
        function addProduct(event) {
            event.preventDefault();
            
            if (!isAdminLoggedIn) {
                alert('Debes iniciar sesi√≥n como administrador.');
                return;
            }

            const form = event.target;
            const isEditMode = form.dataset.editMode === 'true';
            const editId = parseInt(form.dataset.editId);

            const name = document.getElementById('productName').value.trim();
            const price = parseFloat(document.getElementById('productPrice').value);
            const category = document.getElementById('productCategory').value;
            const brand = document.getElementById('productBrand').value;
            const description = document.getElementById('productDescription').value.trim();
            
            // Handle multiple images
            const images = currentProductImages.length > 0 ? [...currentProductImages] : [];
            const mainImage = images.length > 0 ? images[0] : `data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='300' height='300' viewBox='0 0 300 300'%3E%3Crect width='300' height='300' fill='%23dc2626'/%3E%3Crect x='20' y='20' width='260' height='260' fill='%23000' rx='10'/%3E%3Ctext x='150' y='150' text-anchor='middle' dy='.3em' font-family='Arial' font-size='16' fill='%23fff' font-weight='bold'%3E${encodeURIComponent(name)}%3C/text%3E%3C/svg%3E`;

            // Advanced validation
            if (!name) {
                alert('El nombre del producto es obligatorio.');
                return;
            }
            if (name.length < 3) {
                alert('El nombre debe tener al menos 3 caracteres.');
                return;
            }
            if (price <= 0) {
                alert('El precio debe ser mayor a 0.');
                return;
            }
            if (price > 10000000) {
                alert('El precio no puede ser mayor a ‚Ç°10,000,000.');
                return;
            }
            if (!category) {
                alert('Debes seleccionar una categor√≠a.');
                return;
            }
            if (!brand) {
                alert('Debes seleccionar una marca.');
                return;
            }
            if (!description) {
                alert('La descripci√≥n es obligatoria.');
                return;
            }
            if (description.length < 10) {
                alert('La descripci√≥n debe tener al menos 10 caracteres.');
                return;
            }

            // Get selected sizes
            const sizeCheckboxes = event.target.querySelectorAll('input[type="checkbox"]:checked');
            const sizes = Array.from(sizeCheckboxes).map(cb => cb.value);

            if (sizes.length === 0) {
                alert('Debes seleccionar al menos una talla.');
                return;
            }

            // Check for duplicate names (excluding current product if editing)
            const duplicateName = products.find(p => 
                p.name.toLowerCase() === name.toLowerCase() && 
                (!isEditMode || p.id !== editId) &&
                !p.deleted
            );
            if (duplicateName) {
                if (!confirm(`Ya existe un producto con el nombre "${name}". ¬øContinuar de todos modos?`)) {
                    return;
                }
            }

            if (isEditMode) {
                // Update existing product
                const productIndex = products.findIndex(p => p.id === editId);
                if (productIndex !== -1) {
                    const oldProduct = { ...products[productIndex] };
                    products[productIndex] = {
                        ...products[productIndex],
                        name,
                        price,
                        category,
                        brand,
                        sizes,
                        description,
                        image: mainImage,
                        images: images,
                        lastModified: new Date().toISOString(),
                        modificationHistory: [
                            ...(products[productIndex].modificationHistory || []),
                            {
                                date: new Date().toISOString(),
                                changes: getProductChanges(oldProduct, { name, price, category, brand, sizes, description, image: mainImage, images }),
                                user: 'admin'
                            }
                        ]
                    };
                    showSuccessMessage(`Producto "${name}" actualizado exitosamente.`);
                } else {
                    alert('Error: Producto no encontrado para actualizar.');
                    return;
                }
            } else {
                // Add new product
                const newProduct = {
                    id: Date.now(),
                    name,
                    price,
                    category,
                    brand,
                    sizes,
                    description,
                    image: mainImage,
                    images: images,
                    active: true,
                    createdAt: new Date().toISOString(),
                    lastModified: new Date().toISOString(),
                    views: 0,
                    inquiries: 0,
                    modificationHistory: [{
                        date: new Date().toISOString(),
                        changes: ['Producto creado'],
                        user: 'admin'
                    }]
                };
                products.push(newProduct);
                showSuccessMessage(`Producto "${name}" agregado exitosamente.`);
            }

            // Auto-save after product changes
            enhancedAutoSave();

            // Update displays
            displayProducts();
            loadAdminProducts();
            
            // Reset form
            resetProductForm();
        }

        // Get product changes for history tracking
        function getProductChanges(oldProduct, newProduct) {
            const changes = [];
            if (oldProduct.name !== newProduct.name) changes.push(`Nombre: "${oldProduct.name}" ‚Üí "${newProduct.name}"`);
            if (oldProduct.price !== newProduct.price) changes.push(`Precio: ‚Ç°${oldProduct.price.toLocaleString()} ‚Üí ‚Ç°${newProduct.price.toLocaleString()}`);
            if (oldProduct.category !== newProduct.category) changes.push(`Categor√≠a: ${oldProduct.category} ‚Üí ${newProduct.category}`);
            if (oldProduct.brand !== newProduct.brand) changes.push(`Marca: ${oldProduct.brand} ‚Üí ${newProduct.brand}`);
            if (JSON.stringify(oldProduct.sizes) !== JSON.stringify(newProduct.sizes)) changes.push(`Tallas: ${oldProduct.sizes.join(', ')} ‚Üí ${newProduct.sizes.join(', ')}`);
            if (oldProduct.description !== newProduct.description) changes.push('Descripci√≥n actualizada');
            if (oldProduct.image !== newProduct.image) changes.push('Imagen actualizada');
            return changes.length > 0 ? changes : ['Producto actualizado'];
        }

        // Load admin products - ENHANCED WITH ALL FUNCTIONS
        function loadAdminProducts() {
            const list = document.getElementById('adminProductsList');
            list.innerHTML = '';

            if (products.length === 0) {
                list.innerHTML = `
                    <div class="text-center py-12">
                        <i class="fas fa-box-open text-6xl text-gray-400 mb-4"></i>
                        <p class="text-xl text-gray-600">No hay productos registrados</p>
                        <p class="text-gray-500">Agrega tu primer producto usando el formulario</p>
                    </div>
                `;
                return;
            }

            products.forEach(product => {
                const isDeleted = product.deleted === true;
                const isActive = product.active !== false && !isDeleted;
                
                let statusClass, statusText, statusIcon;
                if (isDeleted) {
                    statusClass = 'bg-gray-100 border-gray-400 opacity-60';
                    statusText = 'ELIMINADO';
                    statusIcon = 'fa-trash text-gray-600';
                } else if (isActive) {
                    statusClass = 'bg-green-100 border-green-300';
                    statusText = 'ACTIVO';
                    statusIcon = 'fa-check-circle text-green-600';
                } else {
                    statusClass = 'bg-red-100 border-red-300';
                    statusText = 'INACTIVO';
                    statusIcon = 'fa-times-circle text-red-600';
                }

                const productItem = `
                    <div class="bg-white bg-opacity-90 border-2 ${statusClass} rounded-lg p-6 shadow-lg">
                        <div class="flex items-start justify-between mb-4">
                            <div class="flex-1">
                                <div class="flex items-center space-x-3 mb-2">
                                    <h4 class="font-bold text-xl text-gray-800">${product.name}</h4>
                                    <span class="flex items-center space-x-1 px-2 py-1 rounded-full text-sm font-bold ${isActive ? 'bg-green-200 text-green-800' : 'bg-red-200 text-red-800'}">
                                        <i class="fas ${statusIcon}"></i>
                                        <span>${statusText}</span>
                                    </span>
                                </div>
                                <p class="text-gray-600 text-lg font-semibold">‚Ç°${product.price.toLocaleString('es-CR')}</p>
                                <p class="text-gray-600">${product.brand.toUpperCase()} - ${product.category.toUpperCase()}</p>
                                <p class="text-gray-500 text-sm">Tallas: ${product.sizes.join(', ')}</p>
                                <p class="text-gray-500 text-sm mt-2">${product.description.substring(0, 100)}${product.description.length > 100 ? '...' : ''}</p>
                            </div>
                            <div class="ml-4">
                                <img src="${product.image}" alt="${product.name}" class="w-20 h-20 object-cover rounded-lg border-2 border-gray-300">
                            </div>
                        </div>
                        
                        <div class="flex flex-wrap gap-2 pt-4 border-t border-gray-200">
                            ${!isDeleted ? `
                                <button onclick="editProduct(${product.id})" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors font-bold text-sm flex items-center">
                                    <i class="fas fa-edit mr-2"></i>EDITAR
                                </button>
                                <button onclick="duplicateProduct(${product.id})" class="bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 transition-colors font-bold text-sm flex items-center">
                                    <i class="fas fa-copy mr-2"></i>DUPLICAR
                                </button>
                                <button onclick="toggleProductStatus(${product.id})" class="bg-yellow-600 text-white px-4 py-2 rounded-lg hover:bg-yellow-700 transition-colors font-bold text-sm flex items-center">
                                    <i class="fas fa-toggle-${isActive ? 'on' : 'off'} mr-2"></i>${isActive ? 'DESACTIVAR' : 'ACTIVAR'}
                                </button>
                                <button onclick="deleteProduct(${product.id})" class="bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 transition-colors font-bold text-sm flex items-center">
                                    <i class="fas fa-trash mr-2"></i>ELIMINAR
                                </button>
                            ` : `
                                <button onclick="restoreProduct(${product.id})" class="bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors font-bold text-sm flex items-center">
                                    <i class="fas fa-undo mr-2"></i>RESTAURAR
                                </button>
                                <button onclick="permanentDeleteProduct(${product.id})" class="bg-red-800 text-white px-4 py-2 rounded-lg hover:bg-red-900 transition-colors font-bold text-sm flex items-center">
                                    <i class="fas fa-trash-alt mr-2"></i>ELIMINAR PERMANENTE
                                </button>
                            `}
                        </div>
                    </div>
                `;
                list.innerHTML += productItem;
            });

            // Add statistics
            const totalProducts = products.length;
            const activeProducts = products.filter(p => p.active !== false && p.deleted !== true).length;
            const inactiveProducts = products.filter(p => p.active === false && p.deleted !== true).length;
            const deletedProducts = products.filter(p => p.deleted === true).length;
            
            const statsDiv = `
                <div class="bg-gradient-to-r from-red-600 to-red-800 text-white rounded-lg p-6 mb-6">
                    <h3 class="text-xl font-bold mb-4">üìä ESTAD√çSTICAS DE PRODUCTOS</h3>
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                        <div class="text-center">
                            <div class="text-3xl font-bold">${totalProducts}</div>
                            <div class="text-sm opacity-90">Total</div>
                        </div>
                        <div class="text-center">
                            <div class="text-3xl font-bold text-green-300">${activeProducts}</div>
                            <div class="text-sm opacity-90">Activos</div>
                        </div>
                        <div class="text-center">
                            <div class="text-3xl font-bold text-yellow-300">${inactiveProducts}</div>
                            <div class="text-sm opacity-90">Inactivos</div>
                        </div>
                        <div class="text-center">
                            <div class="text-3xl font-bold text-gray-300">${deletedProducts}</div>
                            <div class="text-sm opacity-90">Eliminados</div>
                        </div>
                    </div>
                </div>
            `;
            
            list.insertAdjacentHTML('afterbegin', statsDiv);
        }

        // Delete product (Admin) - FULLY FUNCTIONAL WITH AUTO-SAVE
        function deleteProduct(productId) {
            if (!isAdminLoggedIn) {
                alert('Debes iniciar sesi√≥n como administrador.');
                return;
            }

            const productIndex = products.findIndex(p => p.id === productId);
            if (productIndex === -1) {
                alert('Producto no encontrado.');
                return;
            }

            const product = products[productIndex];
            
            if (confirm(`¬øEst√°s seguro de que quieres eliminar "${product.name}"?\n\nEl producto ser√° ocultado de la vista p√∫blica y movido a la categor√≠a "hidden".`)) {
                // Mark product as deleted and move to hidden category
                products[productIndex].deleted = true;
                products[productIndex].active = false;
                products[productIndex].originalCategory = products[productIndex].category; // Save original category
                products[productIndex].category = 'hidden'; // Move to hidden category
                products[productIndex].deletedAt = new Date().toISOString();
                products[productIndex].modificationHistory = [
                    ...(products[productIndex].modificationHistory || []),
                    {
                        date: new Date().toISOString(),
                        changes: ['Producto eliminado (soft delete)'],
                        user: 'admin'
                    }
                ];
                
                // Auto-save after deletion
                enhancedAutoSave();
                
                // Update displays
                displayProducts();
                loadAdminProducts();
                
                // Show success message with animation
                showSuccessMessage(`Producto "${product.name}" eliminado y movido a categor√≠a oculta.`);
                
                console.log(`‚úÖ Producto eliminado: ${product.name} - Movido a categor√≠a hidden`);
            }
        }

        // Edit product (Admin) - NEW FUNCTION
        function editProduct(productId) {
            if (!isAdminLoggedIn) {
                alert('Debes iniciar sesi√≥n como administrador.');
                return;
            }

            const product = products.find(p => p.id === productId);
            if (!product) {
                alert('Producto no encontrado.');
                return;
            }

            // Fill form with product data
            document.getElementById('productName').value = product.name;
            document.getElementById('productPrice').value = product.price;
            document.getElementById('productCategory').value = product.category;
            document.getElementById('productBrand').value = product.brand;
            document.getElementById('productDescription').value = product.description;
            
            // Load existing images
            currentProductImages = product.images ? [...product.images] : (product.image ? [product.image] : []);
            updateImagePreview();

            // Check size checkboxes
            const sizeCheckboxes = document.querySelectorAll('#adminProducts input[type="checkbox"]');
            sizeCheckboxes.forEach(checkbox => {
                checkbox.checked = product.sizes.includes(checkbox.value);
            });

            // Show image preview if exists
            if (product.image) {
                const previewDiv = document.getElementById('productImagePreview');
                const previewImg = document.getElementById('productImagePreviewImg');
                if (previewDiv && previewImg) {
                    previewImg.src = product.image;
                    previewDiv.classList.remove('hidden');
                }
            }

            // Change form to edit mode
            const form = document.querySelector('#adminProducts form');
            const submitBtn = form.querySelector('button[type="submit"]');
            const cancelBtn = document.getElementById('cancelEditBtn');
            
            submitBtn.innerHTML = '<i class="fas fa-save mr-2"></i>ACTUALIZAR PRODUCTO';
            submitBtn.className = 'flex-1 bg-blue-600 text-white py-4 rounded-lg hover:bg-blue-700 transition-colors font-bold text-lg';
            
            // Show cancel button
            if (cancelBtn) {
                cancelBtn.style.display = 'block';
            }
            
            // Store edit mode data
            form.dataset.editMode = 'true';
            form.dataset.editId = productId;

            // Scroll to form
            form.scrollIntoView({ behavior: 'smooth' });
            
            showSuccessMessage(`Editando producto: ${product.name}`);
        }

        // Duplicate product (Admin) - NEW FUNCTION
        function duplicateProduct(productId) {
            if (!isAdminLoggedIn) {
                alert('Debes iniciar sesi√≥n como administrador.');
                return;
            }

            const product = products.find(p => p.id === productId);
            if (!product) {
                alert('Producto no encontrado.');
                return;
            }

            const duplicatedProduct = {
                ...product,
                id: Date.now(),
                name: `${product.name} (Copia)`
            };

            products.push(duplicatedProduct);
            displayProducts();
            loadAdminProducts();
            
            showSuccessMessage(`Producto duplicado: ${duplicatedProduct.name}`);
        }

        // Toggle product status (Admin) - NEW FUNCTION
        function toggleProductStatus(productId) {
            if (!isAdminLoggedIn) {
                alert('Debes iniciar sesi√≥n como administrador.');
                return;
            }

            const product = products.find(p => p.id === productId);
            if (!product) {
                alert('Producto no encontrado.');
                return;
            }

            product.active = product.active !== undefined ? !product.active : false;
            
            displayProducts();
            loadAdminProducts();
            
            const status = product.active !== false ? 'activado' : 'desactivado';
            showSuccessMessage(`Producto ${status}: ${product.name}`);
        }

        // Restore deleted product
        function restoreProduct(productId) {
            if (!isAdminLoggedIn) {
                alert('Debes iniciar sesi√≥n como administrador.');
                return;
            }

            const product = products.find(p => p.id === productId);
            if (!product) {
                alert('Producto no encontrado.');
                return;
            }

            if (confirm(`¬øRestaurar el producto "${product.name}"?`)) {
                product.deleted = false;
                product.active = true;
                
                // Restore original category if it exists
                if (product.originalCategory) {
                    product.category = product.originalCategory;
                    delete product.originalCategory;
                } else {
                    // If no original category, set to default
                    product.category = 'chaquetas';
                }
                
                displayProducts();
                loadAdminProducts();
                
                showSuccessMessage(`Producto "${product.name}" restaurado exitosamente a categor√≠a ${product.category}.`);
                
                console.log(`‚úÖ Producto restaurado: ${product.name} - Categor√≠a: ${product.category}`);
            }
        }

        // Permanent delete product
        function permanentDeleteProduct(productId) {
            if (!isAdminLoggedIn) {
                alert('Debes iniciar sesi√≥n como administrador.');
                return;
            }

            const productIndex = products.findIndex(p => p.id === productId);
            if (productIndex === -1) {
                alert('Producto no encontrado.');
                return;
            }

            const product = products[productIndex];
            
            if (confirm(`¬øELIMINAR PERMANENTEMENTE "${product.name}"?\n\n‚ö†Ô∏è ESTA ACCI√ìN NO SE PUEDE DESHACER ‚ö†Ô∏è\n\nEl producto ser√° eliminado completamente del sistema.`)) {
                // Remove product from array permanently
                products.splice(productIndex, 1);
                
                displayProducts();
                loadAdminProducts();
                
                showSuccessMessage(`Producto "${product.name}" eliminado permanentemente.`);
            }
        }

        // Show success message with animation
        function showSuccessMessage(message) {
            // Remove existing message if any
            const existingMessage = document.getElementById('successMessage');
            if (existingMessage) {
                existingMessage.remove();
            }

            // Create success message
            const messageDiv = document.createElement('div');
            messageDiv.id = 'successMessage';
            messageDiv.className = 'fixed top-4 right-4 bg-green-600 text-white px-6 py-4 rounded-lg shadow-xl z-50 transform translate-x-full transition-transform duration-300';
            messageDiv.innerHTML = `
                <div class="flex items-center space-x-3">
                    <i class="fas fa-check-circle text-xl"></i>
                    <span class="font-semibold">${message}</span>
                    <button onclick="this.parentElement.parentElement.remove()" class="ml-4 text-white hover:text-gray-200">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            `;
            
            document.body.appendChild(messageDiv);
            
            // Animate in
            setTimeout(() => {
                messageDiv.classList.remove('translate-x-full');
            }, 100);
            
            // Auto remove after 5 seconds
            setTimeout(() => {
                if (messageDiv.parentElement) {
                    messageDiv.classList.add('translate-x-full');
                    setTimeout(() => messageDiv.remove(), 300);
                }
            }, 5000);
        }

        // Reset product form
        function resetProductForm() {
            const form = document.querySelector('#adminProducts form');
            const submitBtn = form.querySelector('button[type="submit"]');
            const cancelBtn = document.getElementById('cancelEditBtn');
            
            // Reset form
            form.reset();
            
            // Clear images array
            currentProductImages = [];
            updateImagePreview();
            
            // Reset to add mode
            submitBtn.innerHTML = '<i class="fas fa-plus mr-2"></i>AGREGAR PRODUCTO';
            submitBtn.className = 'flex-1 bg-green-600 text-white py-4 rounded-lg hover:bg-green-700 transition-colors font-bold text-lg';
            
            // Hide cancel button
            if (cancelBtn) {
                cancelBtn.style.display = 'none';
            }
            
            // Remove edit mode data
            delete form.dataset.editMode;
            delete form.dataset.editId;
            
            // Hide image preview
            const previewDiv = document.getElementById('productImagePreview');
            if (previewDiv) {
                previewDiv.classList.add('hidden');
            }
            
            // Clear all checkboxes
            const checkboxes = form.querySelectorAll('input[type="checkbox"]');
            checkboxes.forEach(checkbox => {
                checkbox.checked = false;
            });
        }

        // Load brand filters dynamically
        function loadBrandFilters() {
            const brandFilter = document.getElementById('brandFilter');
            const productBrand = document.getElementById('productBrand');
            
            // Clear existing options except first one
            brandFilter.innerHTML = '<option value="">Todas las marcas</option>';
            if (productBrand) {
                productBrand.innerHTML = '<option value="">Seleccionar marca</option>';
            }
            
            brands.filter(brand => brand.active).forEach(brand => {
                brandFilter.innerHTML += `<option value="${brand.id}">${brand.name}</option>`;
                if (productBrand) {
                    productBrand.innerHTML += `<option value="${brand.id}">${brand.name}</option>`;
                }
            });
        }

        // Load category filters dynamically
        function loadCategoryFilters() {
            const categoryFilter = document.getElementById('categoryFilter');
            const productCategory = document.getElementById('productCategory');
            
            // Clear existing options except first one
            categoryFilter.innerHTML = '<option value="">Todas las categor√≠as</option>';
            if (productCategory) {
                productCategory.innerHTML = '<option value="">Seleccionar categor√≠a</option>';
            }
            
            categories.forEach(category => {
                // Show all categories for admin, only active for public
                if (category.active || (isAdminLoggedIn && category.id === 'hidden')) {
                    categoryFilter.innerHTML += `<option value="${category.id}">${category.name}</option>`;
                }
                
                // Only show active categories in product form (not hidden)
                if (productCategory && category.active && category.id !== 'hidden') {
                    productCategory.innerHTML += `<option value="${category.id}">${category.name}</option>`;
                }
            });
        }

        // Display brands dynamically
        function displayBrands() {
            const brandsGrid = document.getElementById('brandsGrid');
            brandsGrid.innerHTML = '';

            brands.filter(brand => brand.active).forEach(brand => {
                const brandCard = `
                    <div class="glass-effect p-8 rounded-xl text-center hover:scale-105 transition-transform duration-300">
                        <div class="mb-4">
                            <img src="${brand.logo}" alt="${brand.name}" class="mx-auto w-30 h-20 object-contain">
                        </div>
                        <h3 class="text-xl font-bold text-white mb-2">${brand.name.toUpperCase()}</h3>
                        <p class="text-gray-300">${brand.description}</p>
                    </div>
                `;
                brandsGrid.innerHTML += brandCard;
            });
        }

        // Admin tab management
        function showAdminTab(tabName) {
            // Hide all tab contents
            document.querySelectorAll('.admin-tab-content').forEach(tab => {
                tab.classList.add('hidden');
            });
            
            // Remove active class from all tabs
            document.querySelectorAll('.admin-tab').forEach(tab => {
                tab.classList.remove('bg-red-600');
                tab.classList.add('bg-gray-600');
            });
            
            // Show selected tab content
            document.getElementById('admin' + tabName.charAt(0).toUpperCase() + tabName.slice(1)).classList.remove('hidden');
            
            // Add active class to selected tab
            document.getElementById('tab' + tabName.charAt(0).toUpperCase() + tabName.slice(1)).classList.remove('bg-gray-600');
            document.getElementById('tab' + tabName.charAt(0).toUpperCase() + tabName.slice(1)).classList.add('bg-red-600');
            
            // Load specific tab data
            if (tabName === 'products') {
                loadAdminProducts();
            } else if (tabName === 'categories') {
                loadAdminCategories();
            } else if (tabName === 'brands') {
                loadAdminBrands();
            } else if (tabName === 'theme') {
                loadThemeControls();
            }
        }

        // Multiple image upload handler
        let currentProductImages = [];

        function handleMultipleImageUpload(event) {
            const files = Array.from(event.target.files);
            
            files.forEach(file => {
                if (file.type.startsWith('image/')) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        currentProductImages.push(e.target.result);
                        updateImagePreview();
                    };
                    reader.readAsDataURL(file);
                }
            });
        }

        function addImageFromUrl() {
            const urlInput = document.getElementById('productImageUrl');
            const url = urlInput.value.trim();
            
            if (url && isValidImageUrl(url)) {
                currentProductImages.push(url);
                urlInput.value = '';
                updateImagePreview();
                showSuccessMessage('Imagen agregada desde URL');
            } else {
                alert('Por favor ingresa una URL de imagen v√°lida');
            }
        }

        function isValidImageUrl(url) {
            try {
                new URL(url);
                return url.match(/\.(jpg|jpeg|png|gif|webp|svg)$/i) || url.includes('data:image/');
            } catch {
                return false;
            }
        }

        function updateImagePreview() {
            const previewContainer = document.getElementById('productImagePreview');
            const imagesGrid = document.getElementById('imagesGrid');
            const addMoreBtn = document.getElementById('addMoreImagesBtn');
            
            if (currentProductImages.length === 0) {
                previewContainer.classList.add('hidden');
                addMoreBtn.classList.add('hidden');
                return;
            }
            
            previewContainer.classList.remove('hidden');
            addMoreBtn.classList.remove('hidden');
            
            imagesGrid.innerHTML = currentProductImages.map((image, index) => `
                <div class="relative group">
                    <img src="${image}" alt="Imagen ${index + 1}" class="w-full h-20 object-cover rounded-lg border-2 border-gray-300">
                    <button type="button" onclick="removeImage(${index})" class="absolute -top-2 -right-2 bg-red-600 text-white rounded-full w-5 h-5 flex items-center justify-center text-xs hover:bg-red-700 opacity-0 group-hover:opacity-100 transition-opacity">
                        <i class="fas fa-times"></i>
                    </button>
                    <div class="absolute bottom-1 left-1 bg-black bg-opacity-70 text-white text-xs px-1 rounded">
                        ${index + 1}
                    </div>
                    ${index === 0 ? '<div class="absolute top-1 left-1 bg-green-600 text-white text-xs px-1 rounded">Principal</div>' : ''}
                </div>
            `).join('');
        }

        function removeImage(index) {
            currentProductImages.splice(index, 1);
            updateImagePreview();
            showSuccessMessage('Imagen eliminada');
        }

        function clearAllImages() {
            if (confirm('¬øEliminar todas las im√°genes?')) {
                currentProductImages = [];
                updateImagePreview();
                showSuccessMessage('Todas las im√°genes eliminadas');
            }
        }

        // Carousel functions for product cards
        function changeCarouselImage(productId, imageIndex) {
            const carousel = document.getElementById(`carousel-${productId}`);
            const images = carousel.querySelectorAll('.carousel-image');
            const dots = document.querySelectorAll(`[data-product="${productId}"]`);
            const counter = document.getElementById(`counter-${productId}`);
            
            // Hide all images and show selected one
            images.forEach((img, index) => {
                if (index === imageIndex) {
                    img.classList.remove('hidden');
                    img.classList.add('active');
                } else {
                    img.classList.add('hidden');
                    img.classList.remove('active');
                }
            });
            
            // Update dots
            dots.forEach((dot, index) => {
                if (index === imageIndex) {
                    dot.classList.remove('bg-opacity-50');
                    dot.classList.add('bg-white');
                } else {
                    dot.classList.add('bg-opacity-50');
                    dot.classList.remove('bg-white');
                }
            });
            
            // Update counter
            if (counter) {
                counter.textContent = imageIndex + 1;
            }
        }

        function nextCarouselImage(productId) {
            const product = products.find(p => p.id === productId);
            if (!product || !product.images) return;
            
            const currentIndex = getCurrentCarouselIndex(productId);
            const nextIndex = (currentIndex + 1) % product.images.length;
            changeCarouselImage(productId, nextIndex);
        }

        function previousCarouselImage(productId) {
            const product = products.find(p => p.id === productId);
            if (!product || !product.images) return;
            
            const currentIndex = getCurrentCarouselIndex(productId);
            const prevIndex = currentIndex === 0 ? product.images.length - 1 : currentIndex - 1;
            changeCarouselImage(productId, prevIndex);
        }

        function getCurrentCarouselIndex(productId) {
            const carousel = document.getElementById(`carousel-${productId}`);
            const activeImage = carousel.querySelector('.carousel-image.active');
            return activeImage ? parseInt(activeImage.dataset.index) : 0;
        }

        // Product detail modal functions
        function openProductDetail(productId) {
            const product = products.find(p => p.id === productId);
            if (!product) return;
            
            // Track product view
            trackProductView(product.name);
            
            const modal = document.getElementById('productDetailModal');
            const content = document.getElementById('productDetailContent');
            
            // Generate product detail content
            const hasMultipleImages = product.images && product.images.length > 1;
            const images = product.images || [product.image];
            
            content.innerHTML = `
                <!-- Image Gallery -->
                <div class="mb-6">
                    <div class="relative">
                        <div class="main-image-container">
                            <img id="mainDetailImage" src="${images[0]}" alt="${product.name}" class="w-full h-64 md:h-80 object-cover rounded-lg">
                        </div>
                        
                        ${hasMultipleImages ? `
                            <!-- Thumbnail Gallery -->
                            <div class="flex space-x-2 mt-4 overflow-x-auto pb-2">
                                ${images.map((img, index) => `
                                    <button onclick="changeMainDetailImage('${img}', ${index})" 
                                            class="flex-shrink-0 detail-thumb ${index === 0 ? 'active' : ''}" 
                                            data-index="${index}">
                                        <img src="${img}" alt="Imagen ${index + 1}" class="w-16 h-16 object-cover rounded-lg border-2 transition-all">
                                    </button>
                                `).join('')}
                            </div>
                        ` : ''}
                    </div>
                </div>
                
                <!-- Product Info -->
                <div class="space-y-4">
                    <div class="flex justify-between items-start">
                        <h1 class="text-2xl md:text-3xl font-bold text-gray-800">${product.name}</h1>
                        <span class="bg-black text-red-500 px-3 py-1 rounded text-sm font-bold uppercase">${product.brand}</span>
                    </div>
                    
                    <div class="flex items-center space-x-4">
                        <span class="text-3xl md:text-4xl font-bold text-red-600">‚Ç°${product.price.toLocaleString('es-CR')}</span>
                        <span class="bg-red-600 text-white px-3 py-1 rounded-full text-sm font-bold uppercase">${product.category}</span>
                    </div>
                    
                    <div class="bg-gray-50 p-4 rounded-lg">
                        <h3 class="font-bold text-gray-800 mb-2">Descripci√≥n:</h3>
                        <p class="text-gray-700 leading-relaxed">${product.description}</p>
                    </div>
                    
                    <div class="bg-blue-50 p-4 rounded-lg">
                        <h3 class="font-bold text-gray-800 mb-2">Tallas disponibles:</h3>
                        <div class="flex flex-wrap gap-2">
                            ${product.sizes.map(size => `
                                <span class="bg-blue-600 text-white px-3 py-1 rounded-full text-sm font-bold">${size}</span>
                            `).join('')}
                        </div>
                    </div>
                    
                    ${product.views || product.inquiries ? `
                        <div class="bg-green-50 p-4 rounded-lg">
                            <h3 class="font-bold text-gray-800 mb-2">Estad√≠sticas:</h3>
                            <div class="flex space-x-4 text-sm text-gray-600">
                                ${product.views ? `<span><i class="fas fa-eye mr-1"></i>${product.views} vistas</span>` : ''}
                                ${product.inquiries ? `<span><i class="fas fa-question-circle mr-1"></i>${product.inquiries} consultas</span>` : ''}
                            </div>
                        </div>
                    ` : ''}
                    
                    <!-- Action Buttons -->
                    <div class="space-y-3 pt-4">
                        <button onclick="contactForProduct('${product.name}')" class="w-full btn-primary text-white py-4 rounded-lg font-bold text-lg">
                            <i class="fas fa-whatsapp mr-2"></i>CONSULTAR POR WHATSAPP
                        </button>
                        <button onclick="shareProduct(${product.id})" class="w-full bg-gray-600 text-white py-3 rounded-lg font-bold text-lg hover:bg-gray-700 transition-colors">
                            <i class="fas fa-share-alt mr-2"></i>COMPARTIR PRODUCTO
                        </button>
                    </div>
                </div>
            `;
            
            // Show modal with animation
            modal.classList.remove('hidden');
            setTimeout(() => {
                modal.querySelector('.product-detail-modal').classList.add('active');
            }, 10);
            
            // Prevent body scroll
            document.body.style.overflow = 'hidden';
        }

        function closeProductDetail() {
            const modal = document.getElementById('productDetailModal');
            const modalContent = modal.querySelector('.product-detail-modal');
            
            modalContent.classList.remove('active');
            setTimeout(() => {
                modal.classList.add('hidden');
                document.body.style.overflow = '';
            }, 300);
        }

        function changeMainDetailImage(imageSrc, index) {
            const mainImage = document.getElementById('mainDetailImage');
            const thumbs = document.querySelectorAll('.detail-thumb');
            
            mainImage.src = imageSrc;
            
            thumbs.forEach((thumb, i) => {
                if (i === index) {
                    thumb.classList.add('active');
                    thumb.querySelector('img').classList.add('border-red-500');
                    thumb.querySelector('img').classList.remove('border-gray-300');
                } else {
                    thumb.classList.remove('active');
                    thumb.querySelector('img').classList.remove('border-red-500');
                    thumb.querySelector('img').classList.add('border-gray-300');
                }
            });
        }

        function shareProduct(productId) {
            const product = products.find(p => p.id === productId);
            if (!product) return;
            
            const shareText = `¬°Mira este ${product.name} en Jackets Master!\n\nPrecio: ‚Ç°${product.price.toLocaleString('es-CR')}\nTallas: ${product.sizes.join(', ')}\n\n${product.description}`;
            
            if (navigator.share) {
                navigator.share({
                    title: product.name,
                    text: shareText,
                    url: window.location.href
                });
            } else {
                // Fallback to copy to clipboard
                navigator.clipboard.writeText(shareText).then(() => {
                    showSuccessMessage('Informaci√≥n del producto copiada al portapapeles');
                }).catch(() => {
                    alert('No se pudo compartir el producto');
                });
            }
        }

        // Image upload handler (legacy support)
        function handleImageUpload(event, targetInputId) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const targetInput = document.getElementById(targetInputId);
                    targetInput.value = e.target.result;
                    
                    // Show preview
                    const previewDiv = document.getElementById(targetInputId + 'Preview');
                    const previewImg = document.getElementById(targetInputId + 'PreviewImg');
                    if (previewDiv && previewImg) {
                        previewImg.src = e.target.result;
                        previewDiv.classList.remove('hidden');
                    }
                };
                reader.readAsDataURL(file);
            }
        }

        // Background image upload handler
        function handleBackgroundImageUpload(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    currentTheme.background.image = e.target.result;
                    updateTheme();
                };
                reader.readAsDataURL(file);
            }
        }

        // Logo upload handler
        function handleLogoUpload(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    currentTheme.customLogo = e.target.result;
                    document.getElementById('customLogoUrl').value = e.target.result;
                    updateLogo();
                };
                reader.readAsDataURL(file);
            }
        }

        // Update logo from URL
        function updateLogo() {
            const logoUrl = document.getElementById('customLogoUrl').value;
            currentTheme.customLogo = logoUrl;
            applyLogo();
        }

        // Apply logo changes
        function applyLogo() {
            const customLogo = document.getElementById('customLogo');
            const defaultLogo = document.getElementById('defaultLogo');
            const footerCustomLogo = document.getElementById('footerCustomLogo');
            const footerDefaultLogo = document.getElementById('footerDefaultLogo');

            if (currentTheme.customLogo) {
                // Show custom logo, hide default
                customLogo.src = currentTheme.customLogo;
                customLogo.classList.remove('hidden');
                defaultLogo.classList.add('hidden');
                
                footerCustomLogo.src = currentTheme.customLogo;
                footerCustomLogo.classList.remove('hidden');
                footerDefaultLogo.classList.add('hidden');
            } else {
                // Show default logo, hide custom
                customLogo.classList.add('hidden');
                defaultLogo.classList.remove('hidden');
                
                footerCustomLogo.classList.add('hidden');
                footerDefaultLogo.classList.remove('hidden');
            }
        }

        // Reset logo to default
        function resetLogo() {
            currentTheme.customLogo = '';
            document.getElementById('customLogoUrl').value = '';
            document.getElementById('customLogoFile').value = '';
            applyLogo();
            showSuccessMessage('Logo restaurado al original.');
        }

        // Favicon management functions
        function handleFaviconUpload(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    currentTheme.customFavicon = e.target.result;
                    document.getElementById('customFaviconUrl').value = e.target.result;
                    updateFavicon();
                };
                reader.readAsDataURL(file);
            }
        }

        function updateFavicon() {
            const faviconUrl = document.getElementById('customFaviconUrl').value;
            if (faviconUrl) {
                currentTheme.customFavicon = faviconUrl;
            }
            applyFavicon();
            enhancedAutoSave();
        }

        function applyFavicon() {
            const faviconLink = document.getElementById('favicon');
            const faviconPreview = document.getElementById('faviconPreview');
            
            if (currentTheme.customFavicon) {
                // Update favicon in page head
                faviconLink.href = currentTheme.customFavicon;
                
                // Update preview
                if (faviconPreview) {
                    faviconPreview.src = currentTheme.customFavicon;
                }
                
                // Determine favicon type based on URL/data
                if (currentTheme.customFavicon.includes('data:image/svg')) {
                    faviconLink.type = 'image/svg+xml';
                } else if (currentTheme.customFavicon.includes('.ico')) {
                    faviconLink.type = 'image/x-icon';
                } else {
                    faviconLink.type = 'image/png';
                }
            }
        }

        function resetFavicon() {
            const defaultFavicon = "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Crect width='100' height='100' fill='%23dc2626'/%3E%3Ctext x='50' y='60' text-anchor='middle' font-size='40' fill='white'%3EJM%3C/text%3E%3C/svg%3E";
            currentTheme.customFavicon = defaultFavicon;
            document.getElementById('customFaviconUrl').value = '';
            document.getElementById('customFaviconFile').value = '';
            applyFavicon();
            enhancedAutoSave();
            showSuccessMessage('Favicon restaurado al original.');
        }

        function generateFaviconFromLogo() {
            if (!currentTheme.customLogo) {
                alert('Primero debes subir un logo personalizado para generar el favicon.');
                return;
            }
            
            // Use the logo as favicon
            currentTheme.customFavicon = currentTheme.customLogo;
            document.getElementById('customFaviconUrl').value = currentTheme.customLogo;
            applyFavicon();
            enhancedAutoSave();
            showSuccessMessage('Favicon generado desde el logo personalizado.');
        }

        // Add/Edit category - ENHANCED
        function addCategory(event) {
            event.preventDefault();
            
            if (!isAdminLoggedIn) {
                alert('Debes iniciar sesi√≥n como administrador.');
                return;
            }

            const form = event.target;
            const isEditMode = form.dataset.editMode === 'true';
            const editId = form.dataset.editId;

            const name = document.getElementById('categoryName').value.trim();
            const id = document.getElementById('categoryId').value.toLowerCase().replace(/\s+/g, '');

            // Validation
            if (!name) {
                alert('El nombre de la categor√≠a es obligatorio.');
                return;
            }
            if (!id) {
                alert('El ID de la categor√≠a es obligatorio.');
                return;
            }
            
            // Check for duplicate ID only if not editing or if ID changed
            if (!isEditMode || (isEditMode && editId !== id)) {
                if (categories.find(cat => cat.id === id)) {
                    alert('Ya existe una categor√≠a con ese ID.');
                    return;
                }
            }

            if (isEditMode) {
                // Update existing category
                const categoryIndex = categories.findIndex(cat => cat.id === editId);
                if (categoryIndex !== -1) {
                    const oldId = categories[categoryIndex].id;
                    categories[categoryIndex].name = name;
                    categories[categoryIndex].id = id;
                    
                    // Update products that use this category
                    if (oldId !== id) {
                        products.forEach(product => {
                            if (product.category === oldId) {
                                product.category = id;
                            }
                            if (product.originalCategory === oldId) {
                                product.originalCategory = id;
                            }
                        });
                    }
                    
                    showSuccessMessage(`Categor√≠a "${name}" actualizada exitosamente.`);
                }
            } else {
                // Add new category
                const newCategory = {
                    id: id,
                    name: name,
                    active: true
                };
                categories.push(newCategory);
                showSuccessMessage(`Categor√≠a "${name}" agregada exitosamente.`);
            }

            loadCategoryFilters();
            loadAdminCategories();
            displayProducts();
            resetCategoryForm();
        }

        // Add/Edit brand - ENHANCED
        function addBrand(event) {
            event.preventDefault();
            
            if (!isAdminLoggedIn) {
                alert('Debes iniciar sesi√≥n como administrador.');
                return;
            }

            const form = event.target;
            const isEditMode = form.dataset.editMode === 'true';
            const editId = form.dataset.editId;

            const name = document.getElementById('brandName').value.trim();
            const id = document.getElementById('brandId').value.toLowerCase().replace(/\s+/g, '');
            const description = document.getElementById('brandDescription').value.trim();
            const logo = document.getElementById('brandLogo').value || `data:image/svg+xml,%3Csvg width='120' height='80' viewBox='0 0 120 80'%3E%3Crect width='120' height='80' fill='%23dc2626' rx='10'/%3E%3Ctext x='60' y='45' text-anchor='middle' font-family='Arial' font-size='14' font-weight='bold' fill='white'%3E${encodeURIComponent(name)}%3C/text%3E%3C/svg%3E`;

            // Validation
            if (!name) {
                alert('El nombre de la marca es obligatorio.');
                return;
            }
            if (!id) {
                alert('El ID de la marca es obligatorio.');
                return;
            }
            if (!description) {
                alert('La descripci√≥n de la marca es obligatoria.');
                return;
            }
            
            // Check for duplicate ID only if not editing or if ID changed
            if (!isEditMode || (isEditMode && editId !== id)) {
                if (brands.find(brand => brand.id === id)) {
                    alert('Ya existe una marca con ese ID.');
                    return;
                }
            }

            if (isEditMode) {
                // Update existing brand
                const brandIndex = brands.findIndex(brand => brand.id === editId);
                if (brandIndex !== -1) {
                    const oldId = brands[brandIndex].id;
                    brands[brandIndex].name = name;
                    brands[brandIndex].id = id;
                    brands[brandIndex].description = description;
                    brands[brandIndex].logo = logo;
                    
                    // Update products that use this brand
                    if (oldId !== id) {
                        products.forEach(product => {
                            if (product.brand === oldId) {
                                product.brand = id;
                            }
                        });
                    }
                    
                    showSuccessMessage(`Marca "${name}" actualizada exitosamente.`);
                }
            } else {
                // Add new brand
                const newBrand = {
                    id: id,
                    name: name,
                    description: description,
                    logo: logo,
                    active: true
                };
                brands.push(newBrand);
                showSuccessMessage(`Marca "${name}" agregada exitosamente.`);
            }

            loadBrandFilters();
            displayBrands();
            loadAdminBrands();
            resetBrandForm();
        }

        // Load admin categories
        function loadAdminCategories() {
            const list = document.getElementById('adminCategoriesList');
            list.innerHTML = '';

            categories.forEach(category => {
                const categoryItem = `
                    <div class="bg-white bg-opacity-80 border-2 border-gray-300 rounded-lg p-4 flex justify-between items-center">
                        <div class="flex-1">
                            <h4 class="font-bold text-lg text-gray-800">${category.name}</h4>
                            <p class="text-gray-600">ID: ${category.id}</p>
                        </div>
                        <div class="flex space-x-2">
                            <button onclick="editCategory('${category.id}')" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors font-bold text-sm">
                                <i class="fas fa-edit mr-1"></i>EDITAR
                            </button>
                            <button onclick="toggleCategory('${category.id}')" class="px-4 py-2 rounded-lg font-bold text-sm ${category.active ? 'bg-green-600 text-white' : 'bg-gray-400 text-gray-700'}">
                                ${category.active ? 'ACTIVA' : 'INACTIVA'}
                            </button>
                            <button onclick="deleteCategory('${category.id}')" class="bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 transition-colors font-bold text-sm">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                `;
                list.innerHTML += categoryItem;
            });
        }

        // Load admin brands
        function loadAdminBrands() {
            const list = document.getElementById('adminBrandsList');
            list.innerHTML = '';

            brands.forEach(brand => {
                const brandItem = `
                    <div class="bg-white bg-opacity-80 border-2 border-gray-300 rounded-lg p-4 flex justify-between items-center">
                        <div class="flex-1 flex items-center space-x-4">
                            <img src="${brand.logo}" alt="${brand.name}" class="w-16 h-10 object-contain">
                            <div>
                                <h4 class="font-bold text-lg text-gray-800">${brand.name}</h4>
                                <p class="text-gray-600 text-sm">${brand.description}</p>
                            </div>
                        </div>
                        <div class="flex space-x-2">
                            <button onclick="editBrand('${brand.id}')" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors font-bold text-sm">
                                <i class="fas fa-edit mr-1"></i>EDITAR
                            </button>
                            <button onclick="toggleBrand('${brand.id}')" class="px-4 py-2 rounded-lg font-bold text-sm ${brand.active ? 'bg-green-600 text-white' : 'bg-gray-400 text-gray-700'}">
                                ${brand.active ? 'ACTIVA' : 'INACTIVA'}
                            </button>
                            <button onclick="deleteBrand('${brand.id}')" class="bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 transition-colors font-bold text-sm">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                `;
                list.innerHTML += brandItem;
            });
        }

        // Toggle category active status
        function toggleCategory(categoryId) {
            const category = categories.find(cat => cat.id === categoryId);
            if (category) {
                category.active = !category.active;
                loadCategoryFilters();
                loadAdminCategories();
                displayProducts(); // Refresh products display
            }
        }

        // Toggle brand active status
        function toggleBrand(brandId) {
            const brand = brands.find(b => b.id === brandId);
            if (brand) {
                brand.active = !brand.active;
                loadBrandFilters();
                displayBrands();
                loadAdminBrands();
                displayProducts(); // Refresh products display
            }
        }

        // Edit category
        function editCategory(categoryId) {
            if (!isAdminLoggedIn) {
                alert('Debes iniciar sesi√≥n como administrador.');
                return;
            }

            const category = categories.find(cat => cat.id === categoryId);
            if (!category) {
                alert('Categor√≠a no encontrada.');
                return;
            }

            // Fill form with category data
            document.getElementById('categoryName').value = category.name;
            document.getElementById('categoryId').value = category.id;

            // Change form to edit mode
            const form = document.querySelector('#adminCategories form');
            const submitBtn = form.querySelector('button[type="submit"]');
            const cancelBtn = document.getElementById('cancelCategoryEditBtn');
            
            submitBtn.innerHTML = '<i class="fas fa-save mr-2"></i>ACTUALIZAR CATEGOR√çA';
            submitBtn.className = 'w-full bg-blue-600 text-white py-4 rounded-lg hover:bg-blue-700 transition-colors font-bold text-lg';
            
            // Show cancel button
            if (cancelBtn) {
                cancelBtn.style.display = 'block';
            }
            
            // Store edit mode data
            form.dataset.editMode = 'true';
            form.dataset.editId = categoryId;

            // Scroll to form
            form.scrollIntoView({ behavior: 'smooth' });
            
            showSuccessMessage(`Editando categor√≠a: ${category.name}`);
        }

        // Delete category
        function deleteCategory(categoryId) {
            if (!isAdminLoggedIn) {
                alert('Debes iniciar sesi√≥n como administrador.');
                return;
            }

            const category = categories.find(cat => cat.id === categoryId);
            if (!category) {
                alert('Categor√≠a no encontrada.');
                return;
            }

            // Check if category is being used by products
            const productsUsingCategory = products.filter(product => 
                product.category === categoryId || product.originalCategory === categoryId
            );

            if (productsUsingCategory.length > 0) {
                alert(`No se puede eliminar la categor√≠a "${category.name}" porque est√° siendo usada por ${productsUsingCategory.length} producto(s). Primero edita o elimina esos productos.`);
                return;
            }

            if (confirm(`¬øEst√°s seguro de que quieres eliminar la categor√≠a "${category.name}"?`)) {
                categories = categories.filter(cat => cat.id !== categoryId);
                loadCategoryFilters();
                loadAdminCategories();
                displayProducts();
                showSuccessMessage(`Categor√≠a "${category.name}" eliminada exitosamente.`);
            }
        }

        // Edit brand
        function editBrand(brandId) {
            if (!isAdminLoggedIn) {
                alert('Debes iniciar sesi√≥n como administrador.');
                return;
            }

            const brand = brands.find(b => b.id === brandId);
            if (!brand) {
                alert('Marca no encontrada.');
                return;
            }

            // Fill form with brand data
            document.getElementById('brandName').value = brand.name;
            document.getElementById('brandId').value = brand.id;
            document.getElementById('brandDescription').value = brand.description;
            document.getElementById('brandLogo').value = brand.logo;

            // Show logo preview if exists
            if (brand.logo) {
                const previewDiv = document.getElementById('brandLogoPreview');
                const previewImg = document.getElementById('brandLogoPreviewImg');
                if (previewDiv && previewImg) {
                    previewImg.src = brand.logo;
                    previewDiv.classList.remove('hidden');
                }
            }

            // Change form to edit mode
            const form = document.querySelector('#adminBrands form');
            const submitBtn = form.querySelector('button[type="submit"]');
            const cancelBtn = document.getElementById('cancelBrandEditBtn');
            
            submitBtn.innerHTML = '<i class="fas fa-save mr-2"></i>ACTUALIZAR MARCA';
            submitBtn.className = 'w-full bg-blue-600 text-white py-4 rounded-lg hover:bg-blue-700 transition-colors font-bold text-lg';
            
            // Show cancel button
            if (cancelBtn) {
                cancelBtn.style.display = 'block';
            }
            
            // Store edit mode data
            form.dataset.editMode = 'true';
            form.dataset.editId = brandId;

            // Scroll to form
            form.scrollIntoView({ behavior: 'smooth' });
            
            showSuccessMessage(`Editando marca: ${brand.name}`);
        }

        // Delete brand
        function deleteBrand(brandId) {
            if (!isAdminLoggedIn) {
                alert('Debes iniciar sesi√≥n como administrador.');
                return;
            }

            const brand = brands.find(b => b.id === brandId);
            if (!brand) {
                alert('Marca no encontrada.');
                return;
            }

            // Check if brand is being used by products
            const productsUsingBrand = products.filter(product => product.brand === brandId);

            if (productsUsingBrand.length > 0) {
                alert(`No se puede eliminar la marca "${brand.name}" porque est√° siendo usada por ${productsUsingBrand.length} producto(s). Primero edita o elimina esos productos.`);
                return;
            }

            if (confirm(`¬øEst√°s seguro de que quieres eliminar la marca "${brand.name}"?`)) {
                brands = brands.filter(b => b.id !== brandId);
                loadBrandFilters();
                displayBrands();
                loadAdminBrands();
                displayProducts();
                showSuccessMessage(`Marca "${brand.name}" eliminada exitosamente.`);
            }
        }

        // Theme management
        function initializeTheme() {
            applyTheme();
            applyHeroBackground();
        }

        function loadThemeControls() {
            document.getElementById('backgroundType').value = currentTheme.background.type;
            document.getElementById('heroBackgroundType').value = currentTheme.heroBackground.type;
            document.getElementById('primaryColor').value = currentTheme.primaryColor;
            document.getElementById('secondaryColor').value = currentTheme.secondaryColor;
            document.getElementById('cardBackground').value = currentTheme.cardBackground;
            document.getElementById('textColor').value = currentTheme.textColor;
            document.getElementById('customLogoUrl').value = currentTheme.customLogo || '';
            document.getElementById('customFaviconUrl').value = currentTheme.customFavicon || '';
            
            updateBackgroundType();
            updateHeroBackgroundType();
            applyLogo();
            applyFavicon();
            loadCurrentTexts();
            loadCurrentFonts();
        }

        function updateHeroBackgroundType() {
            const type = document.getElementById('heroBackgroundType').value;
            
            // Hide all hero controls
            document.getElementById('heroSolidColorControl').classList.add('hidden');
            document.getElementById('heroGradientControl').classList.add('hidden');
            document.getElementById('heroImageControl').classList.add('hidden');
            document.getElementById('heroTextBgControl').classList.add('hidden');
            
            // Show relevant control
            if (type === 'solid') {
                document.getElementById('heroSolidColorControl').classList.remove('hidden');
                document.getElementById('heroBackgroundColor').value = currentTheme.heroBackground.value || '#374151';
            } else if (type === 'gradient') {
                document.getElementById('heroGradientControl').classList.remove('hidden');
                document.getElementById('heroGradientColor1').value = '#374151';
                document.getElementById('heroGradientColor2').value = '#1f2937';
            } else if (type === 'image') {
                document.getElementById('heroImageControl').classList.remove('hidden');
                document.getElementById('heroBackgroundImageUrl').value = currentTheme.heroBackground.image || '';
            } else if (type === 'textBg') {
                document.getElementById('heroTextBgControl').classList.remove('hidden');
                document.getElementById('heroTextBgImageUrl').value = currentTheme.heroBackground.textBg.image || '';
                document.getElementById('textBgOpacity').value = currentTheme.heroBackground.textBg.opacity || 20;
                document.getElementById('textBgSize').value = currentTheme.heroBackground.textBg.size || 'cover';
                updateOpacityDisplay();
            }
            
            currentTheme.heroBackground.type = type;
            updateHeroBackground();
        }

        function updateHeroBackground() {
            const type = currentTheme.heroBackground.type;
            
            if (type === 'solid') {
                currentTheme.heroBackground.value = document.getElementById('heroBackgroundColor').value;
            } else if (type === 'gradient') {
                const color1 = document.getElementById('heroGradientColor1').value;
                const color2 = document.getElementById('heroGradientColor2').value;
                currentTheme.heroBackground.gradient = `linear-gradient(135deg, ${color1} 0%, ${color2} 100%)`;
            } else if (type === 'image') {
                currentTheme.heroBackground.image = document.getElementById('heroBackgroundImageUrl').value;
            } else if (type === 'textBg') {
                currentTheme.heroBackground.textBg.image = document.getElementById('heroTextBgImageUrl').value;
                currentTheme.heroBackground.textBg.opacity = document.getElementById('textBgOpacity').value;
                currentTheme.heroBackground.textBg.size = document.getElementById('textBgSize').value;
                updateOpacityDisplay();
            }
            
            applyHeroBackground();
        }

        function applyHeroBackground() {
            const heroSection = document.querySelector('.hero-bg');
            const heroTextBg = document.getElementById('heroTextBg');
            if (!heroSection) return;
            
            const type = currentTheme.heroBackground.type;
            
            // Reset text background first
            if (heroTextBg) {
                heroTextBg.style.backgroundImage = '';
                heroTextBg.style.opacity = '';
                heroTextBg.style.backgroundSize = '';
            }
            
            if (type === 'default') {
                // Reset to default
                heroSection.style.background = '';
                heroSection.classList.remove('custom-bg');
            } else if (type === 'solid') {
                heroSection.style.background = `linear-gradient(rgba(0,0,0,0.7), rgba(0,0,0,0.7)), ${currentTheme.heroBackground.value}`;
                heroSection.classList.add('custom-bg');
            } else if (type === 'gradient') {
                heroSection.style.background = `linear-gradient(rgba(0,0,0,0.5), rgba(0,0,0,0.5)), ${currentTheme.heroBackground.gradient}`;
                heroSection.classList.add('custom-bg');
            } else if (type === 'image' && currentTheme.heroBackground.image) {
                heroSection.style.background = `linear-gradient(rgba(0,0,0,0.6), rgba(0,0,0,0.6)), url('${currentTheme.heroBackground.image}') center/cover`;
                heroSection.classList.add('custom-bg');
            } else if (type === 'textBg' && currentTheme.heroBackground.textBg.image && heroTextBg) {
                // Keep hero section default, apply image only to text background
                heroSection.style.background = '';
                heroSection.classList.remove('custom-bg');
                
                // Apply text background
                heroTextBg.style.backgroundImage = `url('${currentTheme.heroBackground.textBg.image}')`;
                heroTextBg.style.opacity = (currentTheme.heroBackground.textBg.opacity / 100);
                heroTextBg.style.backgroundSize = currentTheme.heroBackground.textBg.size;
            }
        }

        // Hero background image upload handler
        function handleHeroBackgroundImageUpload(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    currentTheme.heroBackground.image = e.target.result;
                    document.getElementById('heroBackgroundImageUrl').value = e.target.result;
                    updateHeroBackground();
                };
                reader.readAsDataURL(file);
            }
        }

        // Hero text background image upload handler
        function handleHeroTextBgImageUpload(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    currentTheme.heroBackground.textBg.image = e.target.result;
                    document.getElementById('heroTextBgImageUrl').value = e.target.result;
                    updateHeroBackground();
                };
                reader.readAsDataURL(file);
            }
        }

        // Update opacity display
        function updateOpacityDisplay() {
            const opacityValue = document.getElementById('textBgOpacity').value;
            const opacityDisplay = document.getElementById('opacityValue');
            if (opacityDisplay) {
                opacityDisplay.textContent = opacityValue + '%';
            }
        }

        function updateBackgroundType() {
            const type = document.getElementById('backgroundType').value;
            
            // Hide all controls
            document.getElementById('solidColorControl').classList.add('hidden');
            document.getElementById('gradientControl').classList.add('hidden');
            document.getElementById('imageControl').classList.add('hidden');
            
            // Show relevant control
            if (type === 'solid') {
                document.getElementById('solidColorControl').classList.remove('hidden');
                document.getElementById('backgroundColor').value = currentTheme.background.value;
            } else if (type === 'gradient') {
                document.getElementById('gradientControl').classList.remove('hidden');
                document.getElementById('gradientColor1').value = '#9ca3af';
                document.getElementById('gradientColor2').value = '#6b7280';
            } else if (type === 'image') {
                document.getElementById('imageControl').classList.remove('hidden');
                document.getElementById('backgroundImageUrl').value = currentTheme.background.image;
            }
            
            currentTheme.background.type = type;
            updateTheme();
        }

        function updateTheme() {
            const type = currentTheme.background.type;
            
            if (type === 'solid') {
                currentTheme.background.value = document.getElementById('backgroundColor').value;
            } else if (type === 'gradient') {
                const color1 = document.getElementById('gradientColor1').value;
                const color2 = document.getElementById('gradientColor2').value;
                currentTheme.background.gradient = `linear-gradient(135deg, ${color1} 0%, ${color2} 100%)`;
            } else if (type === 'image') {
                currentTheme.background.image = document.getElementById('backgroundImageUrl').value;
            }
            
            currentTheme.primaryColor = document.getElementById('primaryColor').value;
            currentTheme.secondaryColor = document.getElementById('secondaryColor').value;
            currentTheme.cardBackground = document.getElementById('cardBackground').value;
            currentTheme.textColor = document.getElementById('textColor').value;
            
            applyTheme();
        }

        function applyTheme() {
            const body = document.body;
            
            // Apply background
            if (currentTheme.background.type === 'solid') {
                body.style.background = currentTheme.background.value;
                body.classList.remove('motorcycle-pattern');
            } else if (currentTheme.background.type === 'gradient') {
                body.style.background = currentTheme.background.gradient;
                body.classList.remove('motorcycle-pattern');
            } else if (currentTheme.background.type === 'image' && currentTheme.background.image) {
                body.style.background = `url('${currentTheme.background.image}') center/cover`;
                body.classList.remove('motorcycle-pattern');
            } else {
                body.style.background = '';
                body.classList.add('motorcycle-pattern');
            }
            
            // Apply colors via CSS custom properties
            document.documentElement.style.setProperty('--primary-color', currentTheme.primaryColor);
            document.documentElement.style.setProperty('--secondary-color', currentTheme.secondaryColor);
            document.documentElement.style.setProperty('--card-background', currentTheme.cardBackground);
            document.documentElement.style.setProperty('--text-color', currentTheme.textColor);
        }

        function resetTheme() {
            currentTheme = {
                background: {
                    type: 'pattern',
                    value: '#9ca3af',
                    gradient: 'linear-gradient(135deg, #9ca3af 0%, #6b7280 100%)',
                    image: ''
                },
                cardBackground: '#f3f4f6',
                primaryColor: '#dc2626',
                secondaryColor: '#000000',
                textColor: '#374151',
                buttonColor: '#dc2626',
                customLogo: '',
                customFavicon: "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Crect width='100' height='100' fill='%23dc2626'/%3E%3Ctext x='50' y='60' text-anchor='middle' font-size='40' fill='white'%3EJM%3C/text%3E%3C/svg%3E",
                heroBackground: {
                    type: 'default',
                    value: '',
                    gradient: '',
                    image: '',
                    textBg: {
                        image: '',
                        opacity: 20,
                        size: 'cover'
                    }
                }
            };
            
            loadThemeControls();
            applyTheme();
            applyLogo();
            applyFavicon();
            alert('Tema restaurado a los valores originales.');
        }

        function saveTheme() {
            try {
                // Save theme to localStorage
                localStorage.setItem('jacketsmaster_theme', JSON.stringify(currentTheme));
                
                // Save all data to localStorage for persistence
                const siteData = {
                    products: products,
                    categories: categories,
                    brands: brands,
                    theme: currentTheme,
                    lastUpdated: new Date().toISOString()
                };
                
                localStorage.setItem('jacketsmaster_data', JSON.stringify(siteData));
                showSuccessMessage('¬°Tema y datos guardados exitosamente!');
            } catch (error) {
                alert('Error al guardar: ' + error.message);
            }
        }

        // Load saved data on page load
        function loadSavedData() {
            try {
                const savedData = localStorage.getItem('jacketsmaster_data');
                if (savedData) {
                    const data = JSON.parse(savedData);
                    
                    if (data.products) products = data.products;
                    if (data.categories) categories = data.categories;
                    if (data.brands) brands = data.brands;
                    if (data.theme) currentTheme = data.theme;
                    if (data.texts) siteTexts = data.texts;
                    if (data.links) siteLinks = data.links;
                    if (data.fonts) siteFonts = data.fonts;
                    
                    console.log('Datos cargados desde localStorage');
                }
            } catch (error) {
                console.error('Error al cargar datos guardados:', error);
            }
        }

        // Export data function - COMPLETE WITH ALL DATA
        function exportData() {
            if (!isAdminLoggedIn) {
                alert('Debes iniciar sesi√≥n como administrador.');
                return;
            }

            // Comprehensive data export including all system data
            const dataToExport = {
                metadata: {
                    exportDate: new Date().toISOString(),
                    version: '2.0',
                    systemName: 'Jackets Master',
                    totalProducts: products.length,
                    activeProducts: products.filter(p => p.active !== false && !p.deleted).length,
                    totalCategories: categories.length,
                    totalBrands: brands.length
                },
                products: products.map(product => ({
                    ...product,
                    exportNote: 'Incluye historial completo y analytics'
                })),
                categories: categories.map(category => ({
                    ...category,
                    productCount: products.filter(p => p.category === category.id && !p.deleted).length
                })),
                brands: brands.map(brand => ({
                    ...brand,
                    productCount: products.filter(p => p.brand === brand.id && !p.deleted).length
                })),
                theme: {
                    ...currentTheme,
                    exportNote: 'Configuraci√≥n completa de tema y personalizaci√≥n'
                },
                texts: {
                    ...siteTexts,
                    exportNote: 'Todos los textos personalizados del sitio'
                },
                analytics: {
                    totalViews: products.reduce((sum, p) => sum + (p.views || 0), 0),
                    totalInquiries: products.reduce((sum, p) => sum + (p.inquiries || 0), 0),
                    mostViewedProduct: products.reduce((max, p) => (p.views || 0) > (max.views || 0) ? p : max, products[0] || {}),
                    mostInquiredProduct: products.reduce((max, p) => (p.inquiries || 0) > (max.inquiries || 0) ? p : max, products[0] || {}),
                    exportNote: 'Datos de rendimiento y analytics'
                },
                systemInfo: {
                    lastSave: new Date().toISOString(),
                    dataIntegrityCheck: validateDataIntegrity().length === 0 ? 'PASSED' : 'ISSUES_FOUND',
                    features: [
                        'Gesti√≥n completa de productos',
                        'Sistema de categor√≠as y marcas',
                        'Personalizaci√≥n de tema',
                        'Editor de textos',
                        'Analytics y reportes',
                        'Auto-guardado',
                        'Validaci√≥n de integridad'
                    ]
                }
            };

            try {
                const dataStr = JSON.stringify(dataToExport, null, 2);
                const dataBlob = new Blob([dataStr], { type: 'application/json;charset=utf-8' });
                const url = URL.createObjectURL(dataBlob);
                
                const link = document.createElement('a');
                link.href = url;
                link.download = `jacketsmaster_backup_completo_${new Date().toISOString().split('T')[0]}_${Date.now()}.json`;
                link.style.display = 'none';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                URL.revokeObjectURL(url);
                
                // Log export details
                console.log('üì¶ Exportaci√≥n completa realizada:', {
                    productos: dataToExport.products.length,
                    categorias: dataToExport.categories.length,
                    marcas: dataToExport.brands.length,
                    tama√±o: `${(dataStr.length / 1024).toFixed(2)} KB`,
                    fecha: dataToExport.metadata.exportDate
                });
                
                showSuccessMessage(`¬°Exportaci√≥n completa exitosa! Archivo: ${(dataStr.length / 1024).toFixed(2)} KB`);
                
                // Show export summary
                setTimeout(() => {
                    if (confirm(`Exportaci√≥n completada:\n\n‚Ä¢ ${dataToExport.products.length} productos\n‚Ä¢ ${dataToExport.categories.length} categor√≠as\n‚Ä¢ ${dataToExport.brands.length} marcas\n‚Ä¢ Tema y textos personalizados\n‚Ä¢ Analytics completos\n\n¬øVer detalles del archivo exportado?`)) {
                        alert(`DETALLES DE EXPORTACI√ìN:\n\nArchivo: jacketsmaster_backup_completo_${new Date().toISOString().split('T')[0]}.json\nTama√±o: ${(dataStr.length / 1024).toFixed(2)} KB\nVersi√≥n: 2.0\nFecha: ${new Date().toLocaleString('es-CR')}\n\nEl archivo contiene:\n‚úÖ Todos los productos con historial\n‚úÖ Categor√≠as y marcas completas\n‚úÖ Configuraci√≥n de tema\n‚úÖ Textos personalizados\n‚úÖ Datos de analytics\n‚úÖ Informaci√≥n del sistema`);
                    }
                }, 1000);
                
            } catch (error) {
                console.error('‚ùå Error en exportaci√≥n:', error);
                alert('Error al exportar datos: ' + error.message);
            }
        }

        // Import data function - COMPLETE WITH VALIDATION
        function importData(event) {
            if (!isAdminLoggedIn) {
                alert('Debes iniciar sesi√≥n como administrador.');
                return;
            }

            const file = event.target.files[0];
            if (!file) return;

            // Validate file type
            if (!file.name.toLowerCase().endsWith('.json')) {
                alert('Por favor selecciona un archivo JSON v√°lido.');
                event.target.value = '';
                return;
            }

            // Check file size (max 10MB)
            if (file.size > 10 * 1024 * 1024) {
                alert('El archivo es demasiado grande. M√°ximo permitido: 10MB');
                event.target.value = '';
                return;
            }

            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const importedData = JSON.parse(e.target.result);
                    
                    // Validate imported data structure
                    const validationErrors = validateImportedData(importedData);
                    if (validationErrors.length > 0) {
                        alert(`Errores en el archivo importado:\n\n${validationErrors.join('\n')}\n\nPor favor corrige estos errores antes de importar.`);
                        event.target.value = '';
                        return;
                    }
                    
                    // Show import preview
                    const importSummary = generateImportSummary(importedData);
                    const confirmMessage = `¬øCONFIRMAR IMPORTACI√ìN?\n\n${importSummary}\n\n‚ö†Ô∏è ADVERTENCIA: Esto reemplazar√° TODOS los datos actuales.\n\n¬øContinuar con la importaci√≥n?`;
                    
                    if (confirm(confirmMessage)) {
                        // Create backup before import
                        const backupData = {
                            products: [...products],
                            categories: [...categories],
                            brands: [...brands],
                            theme: {...currentTheme},
                            texts: {...siteTexts},
                            backupDate: new Date().toISOString()
                        };
                        
                        // Store backup in localStorage
                        try {
                            localStorage.setItem('jacketsmaster_pre_import_backup', JSON.stringify(backupData));
                            console.log('üíæ Backup pre-importaci√≥n creado');
                        } catch (error) {
                            console.warn('‚ö†Ô∏è No se pudo crear backup autom√°tico:', error);
                        }
                        
                        // Import data with proper handling
                        if (importedData.products) {
                            products = importedData.products.map(product => ({
                                ...product,
                                importedAt: new Date().toISOString()
                            }));
                        }
                        
                        if (importedData.categories) {
                            categories = importedData.categories.map(category => ({
                                ...category,
                                importedAt: new Date().toISOString()
                            }));
                        }
                        
                        if (importedData.brands) {
                            brands = importedData.brands.map(brand => ({
                                ...brand,
                                importedAt: new Date().toISOString()
                            }));
                        }
                        
                        if (importedData.theme) {
                            currentTheme = {
                                ...importedData.theme,
                                importedAt: new Date().toISOString()
                            };
                        }
                        
                        if (importedData.texts) {
                            siteTexts = {
                                ...importedData.texts,
                                importedAt: new Date().toISOString()
                            };
                        }
                        
                        // Refresh all displays and apply changes
                        try {
                            displayProducts();
                            loadBrandFilters();
                            loadCategoryFilters();
                            displayBrands();
                            loadAdminProducts();
                            loadAdminCategories();
                            loadAdminBrands();
                            loadThemeControls();
                            applyTheme();
                            applyLogo();
                            applyTexts();
                            
                            // Auto-save imported data
                            enhancedAutoSave();
                            
                            // Validate data integrity after import
                            const integrityIssues = validateDataIntegrity();
                            
                            const successMessage = `¬°Importaci√≥n completada exitosamente!\n\n${importSummary}\n\nIntegridad de datos: ${integrityIssues.length === 0 ? '‚úÖ VERIFICADA' : `‚ö†Ô∏è ${integrityIssues.length} problemas encontrados`}`;
                            
                            showSuccessMessage('¬°Datos importados y aplicados exitosamente!');
                            
                            setTimeout(() => {
                                alert(successMessage);
                                
                                if (integrityIssues.length > 0) {
                                    if (confirm(`Se encontraron ${integrityIssues.length} problemas de integridad despu√©s de la importaci√≥n.\n\n¬øVer detalles?`)) {
                                        alert(`PROBLEMAS DE INTEGRIDAD:\n\n${integrityIssues.map(issue => `‚Ä¢ ${issue}`).join('\n')}`);
                                    }
                                }
                            }, 1000);
                            
                            console.log('‚úÖ Importaci√≥n completada:', {
                                productos: products.length,
                                categorias: categories.length,
                                marcas: brands.length,
                                fecha: new Date().toISOString()
                            });
                            
                        } catch (error) {
                            console.error('‚ùå Error aplicando datos importados:', error);
                            alert('Error al aplicar los datos importados: ' + error.message);
                        }
                    }
                } catch (error) {
                    console.error('‚ùå Error parseando archivo JSON:', error);
                    alert('Error al leer el archivo JSON: ' + error.message + '\n\nVerifica que el archivo sea un JSON v√°lido.');
                }
            };
            
            reader.onerror = function() {
                alert('Error al leer el archivo. Intenta nuevamente.');
            };
            
            reader.readAsText(file);
            
            // Reset file input
            event.target.value = '';
        }

        // Validate imported data structure
        function validateImportedData(data) {
            const errors = [];
            
            // Check basic structure
            if (!data || typeof data !== 'object') {
                errors.push('El archivo no contiene un objeto JSON v√°lido');
                return errors;
            }
            
            // Validate products
            if (data.products) {
                if (!Array.isArray(data.products)) {
                    errors.push('Los productos deben ser un array');
                } else {
                    data.products.forEach((product, index) => {
                        if (!product.id) errors.push(`Producto ${index + 1}: Falta ID`);
                        if (!product.name) errors.push(`Producto ${index + 1}: Falta nombre`);
                        if (!product.price || product.price <= 0) errors.push(`Producto ${index + 1}: Precio inv√°lido`);
                        if (!product.category) errors.push(`Producto ${index + 1}: Falta categor√≠a`);
                        if (!product.brand) errors.push(`Producto ${index + 1}: Falta marca`);
                        if (!product.sizes || !Array.isArray(product.sizes) || product.sizes.length === 0) {
                            errors.push(`Producto ${index + 1}: Falta tallas v√°lidas`);
                        }
                    });
                }
            }
            
            // Validate categories
            if (data.categories) {
                if (!Array.isArray(data.categories)) {
                    errors.push('Las categor√≠as deben ser un array');
                } else {
                    data.categories.forEach((category, index) => {
                        if (!category.id) errors.push(`Categor√≠a ${index + 1}: Falta ID`);
                        if (!category.name) errors.push(`Categor√≠a ${index + 1}: Falta nombre`);
                    });
                }
            }
            
            // Validate brands
            if (data.brands) {
                if (!Array.isArray(data.brands)) {
                    errors.push('Las marcas deben ser un array');
                } else {
                    data.brands.forEach((brand, index) => {
                        if (!brand.id) errors.push(`Marca ${index + 1}: Falta ID`);
                        if (!brand.name) errors.push(`Marca ${index + 1}: Falta nombre`);
                    });
                }
            }
            
            return errors;
        }

        // Generate import summary
        function generateImportSummary(data) {
            const summary = [];
            
            if (data.products) {
                summary.push(`üì¶ ${data.products.length} productos`);
            }
            if (data.categories) {
                summary.push(`üìÇ ${data.categories.length} categor√≠as`);
            }
            if (data.brands) {
                summary.push(`üè∑Ô∏è ${data.brands.length} marcas`);
            }
            if (data.theme) {
                summary.push(`üé® Configuraci√≥n de tema`);
            }
            if (data.texts) {
                summary.push(`üìù Textos personalizados`);
            }
            if (data.metadata) {
                summary.push(`‚ÑπÔ∏è Versi√≥n: ${data.metadata.version || 'No especificada'}`);
                summary.push(`üìÖ Exportado: ${data.metadata.exportDate ? new Date(data.metadata.exportDate).toLocaleDateString('es-CR') : 'Fecha desconocida'}`);
            }
            
            return summary.join('\n');
        }

        // Reset category form
        function resetCategoryForm() {
            const form = document.querySelector('#adminCategories form');
            const submitBtn = form.querySelector('button[type="submit"]');
            const cancelBtn = document.getElementById('cancelCategoryEditBtn');
            
            // Reset form
            form.reset();
            
            // Reset to add mode
            submitBtn.innerHTML = '<i class="fas fa-plus mr-2"></i>AGREGAR CATEGOR√çA';
            submitBtn.className = 'flex-1 bg-green-600 text-white py-4 rounded-lg hover:bg-green-700 transition-colors font-bold text-lg';
            
            // Hide cancel button
            if (cancelBtn) {
                cancelBtn.style.display = 'none';
            }
            
            // Remove edit mode data
            delete form.dataset.editMode;
            delete form.dataset.editId;
        }

        // Reset brand form
        function resetBrandForm() {
            const form = document.querySelector('#adminBrands form');
            const submitBtn = form.querySelector('button[type="submit"]');
            const cancelBtn = document.getElementById('cancelBrandEditBtn');
            
            // Reset form
            form.reset();
            
            // Reset to add mode
            submitBtn.innerHTML = '<i class="fas fa-plus mr-2"></i>AGREGAR MARCA';
            submitBtn.className = 'flex-1 bg-green-600 text-white py-4 rounded-lg hover:bg-green-700 transition-colors font-bold text-lg';
            
            // Hide cancel button
            if (cancelBtn) {
                cancelBtn.style.display = 'none';
            }
            
            // Remove edit mode data
            delete form.dataset.editMode;
            delete form.dataset.editId;
            
            // Hide logo preview
            const previewDiv = document.getElementById('brandLogoPreview');
            if (previewDiv) {
                previewDiv.classList.add('hidden');
            }
        }

        // Manual save function
        function manualSave() {
            if (enhancedAutoSave()) {
                showSuccessMessage('¬°Datos guardados manualmente!');
            } else {
                alert('Error al guardar los datos');
            }
        }

        // Auto-save on all admin actions
        function addAutoSaveToFunction(originalFunction, functionName) {
            return function(...args) {
                const result = originalFunction.apply(this, args);
                if (isAdminLoggedIn) {
                    setTimeout(() => {
                        enhancedAutoSave();
                        console.log(`üîÑ Auto-guardado despu√©s de: ${functionName}`);
                    }, 500);
                }
                return result;
            };
        }

        // Wrap functions with auto-save
        const originalToggleProductStatus = toggleProductStatus;
        toggleProductStatus = addAutoSaveToFunction(originalToggleProductStatus, 'toggleProductStatus');

        const originalDuplicateProduct = duplicateProduct;
        duplicateProduct = addAutoSaveToFunction(originalDuplicateProduct, 'duplicateProduct');

        const originalRestoreProduct = restoreProduct;
        restoreProduct = addAutoSaveToFunction(originalRestoreProduct, 'restoreProduct');

        const originalPermanentDeleteProduct = permanentDeleteProduct;
        permanentDeleteProduct = addAutoSaveToFunction(originalPermanentDeleteProduct, 'permanentDeleteProduct');

        // Update last save time display
        function updateLastSaveTime() {
            const now = new Date();
            const timeString = now.toLocaleTimeString('es-CR');
            const element = document.getElementById('lastSaveTime');
            if (element) {
                element.textContent = `√öltimo guardado: ${timeString}`;
            }
        }

        // Bulk price update function
        function bulkPriceUpdate() {
            if (!isAdminLoggedIn) {
                alert('Debes iniciar sesi√≥n como administrador.');
                return;
            }

            const percentage = prompt('Ingresa el porcentaje de cambio (ej: 10 para aumentar 10%, -5 para reducir 5%):');
            if (percentage === null) return;

            const change = parseFloat(percentage);
            if (isNaN(change)) {
                alert('Porcentaje inv√°lido');
                return;
            }

            if (confirm(`¬øAplicar ${change > 0 ? 'aumento' : 'reducci√≥n'} del ${Math.abs(change)}% a todos los productos?`)) {
                let updatedCount = 0;
                products.forEach(product => {
                    if (!product.deleted) {
                        const newPrice = product.price * (1 + change / 100);
                        product.price = Math.round(newPrice);
                        updatedCount++;
                    }
                });

                displayProducts();
                loadAdminProducts();
                autoSave();
                showSuccessMessage(`Precios actualizados en ${updatedCount} productos`);
            }
        }

        // Generate ADVANCED report function
        function generateReport() {
            if (!isAdminLoggedIn) {
                alert('Debes iniciar sesi√≥n como administrador.');
                return;
            }

            const totalProducts = products.length;
            const activeProducts = products.filter(p => p.active !== false && p.deleted !== true).length;
            const inactiveProducts = products.filter(p => p.active === false && p.deleted !== true).length;
            const deletedProducts = products.filter(p => p.deleted === true).length;
            
            // Calculate category distribution
            const categoryStats = {};
            products.filter(p => !p.deleted).forEach(product => {
                categoryStats[product.category] = (categoryStats[product.category] || 0) + 1;
            });

            // Calculate brand distribution
            const brandStats = {};
            products.filter(p => !p.deleted).forEach(product => {
                brandStats[product.brand] = (brandStats[product.brand] || 0) + 1;
            });

            // Calculate price ranges
            const prices = products.filter(p => !p.deleted).map(p => p.price);
            const avgPrice = prices.length > 0 ? Math.round(prices.reduce((a, b) => a + b, 0) / prices.length) : 0;
            const minPrice = prices.length > 0 ? Math.min(...prices) : 0;
            const maxPrice = prices.length > 0 ? Math.max(...prices) : 0;

            // Analytics data
            const totalViews = products.reduce((sum, p) => sum + (p.views || 0), 0);
            const totalInquiries = products.reduce((sum, p) => sum + (p.inquiries || 0), 0);
            const mostViewedProduct = products.reduce((max, p) => (p.views || 0) > (max.views || 0) ? p : max, products[0] || {});
            const mostInquiredProduct = products.reduce((max, p) => (p.inquiries || 0) > (max.inquiries || 0) ? p : max, products[0] || {});

            // Recent activity
            const recentlyAdded = products.filter(p => p.createdAt && new Date(p.createdAt) > new Date(Date.now() - 7 * 24 * 60 * 60 * 1000)).length;
            const recentlyModified = products.filter(p => p.lastModified && new Date(p.lastModified) > new Date(Date.now() - 7 * 24 * 60 * 60 * 1000)).length;

            // Size analysis
            const sizeStats = {};
            products.filter(p => !p.deleted).forEach(product => {
                product.sizes?.forEach(size => {
                    sizeStats[size] = (sizeStats[size] || 0) + 1;
                });
            });

            // Price range analysis
            const priceRanges = {
                'Menos de ‚Ç°50,000': prices.filter(p => p < 50000).length,
                '‚Ç°50,000 - ‚Ç°100,000': prices.filter(p => p >= 50000 && p < 100000).length,
                '‚Ç°100,000 - ‚Ç°200,000': prices.filter(p => p >= 100000 && p < 200000).length,
                'M√°s de ‚Ç°200,000': prices.filter(p => p >= 200000).length
            };

            const report = `
üìä REPORTE AVANZADO DE INVENTARIO - ${new Date().toLocaleDateString('es-CR')} ${new Date().toLocaleTimeString('es-CR')}

üìà ESTAD√çSTICAS GENERALES:
‚Ä¢ Total de productos: ${totalProducts}
‚Ä¢ Productos activos: ${activeProducts}
‚Ä¢ Productos inactivos: ${inactiveProducts}
‚Ä¢ Productos eliminados: ${deletedProducts}
‚Ä¢ Precio promedio: ‚Ç°${avgPrice.toLocaleString('es-CR')}
‚Ä¢ Precio m√≠nimo: ‚Ç°${minPrice.toLocaleString('es-CR')}
‚Ä¢ Precio m√°ximo: ‚Ç°${maxPrice.toLocaleString('es-CR')}

üìä AN√ÅLISIS DE RENDIMIENTO:
‚Ä¢ Total de visualizaciones: ${totalViews.toLocaleString()}
‚Ä¢ Total de consultas: ${totalInquiries.toLocaleString()}
‚Ä¢ Tasa de conversi√≥n: ${totalViews > 0 ? ((totalInquiries / totalViews) * 100).toFixed(2) : 0}%
‚Ä¢ Producto m√°s visto: ${mostViewedProduct.name || 'N/A'} (${mostViewedProduct.views || 0} vistas)
‚Ä¢ Producto m√°s consultado: ${mostInquiredProduct.name || 'N/A'} (${mostInquiredProduct.inquiries || 0} consultas)

üìÇ DISTRIBUCI√ìN POR CATEGOR√çAS:
${Object.entries(categoryStats).map(([cat, count]) => `‚Ä¢ ${categories.find(c => c.id === cat)?.name || cat}: ${count} productos (${((count/activeProducts)*100).toFixed(1)}%)`).join('\n')}

üè∑Ô∏è DISTRIBUCI√ìN POR MARCAS:
${Object.entries(brandStats).map(([brand, count]) => `‚Ä¢ ${brands.find(b => b.id === brand)?.name || brand}: ${count} productos (${((count/activeProducts)*100).toFixed(1)}%)`).join('\n')}

üìè AN√ÅLISIS DE TALLAS:
${Object.entries(sizeStats).sort((a, b) => b[1] - a[1]).map(([size, count]) => `‚Ä¢ Talla ${size}: ${count} productos`).join('\n')}

üí∞ RANGOS DE PRECIOS:
${Object.entries(priceRanges).map(([range, count]) => `‚Ä¢ ${range}: ${count} productos (${((count/prices.length)*100).toFixed(1)}%)`).join('\n')}

üìÖ ACTIVIDAD RECIENTE (√öltimos 7 d√≠as):
‚Ä¢ Productos agregados: ${recentlyAdded}
‚Ä¢ Productos modificados: ${recentlyModified}

üîß INFORMACI√ìN DEL SISTEMA:
‚Ä¢ √öltima actualizaci√≥n: ${new Date().toLocaleString('es-CR')}
‚Ä¢ Auto-guardado: Activado ‚úÖ
‚Ä¢ Versi√≥n del sistema: 2.0
‚Ä¢ Total de categor√≠as: ${categories.filter(c => c.active).length}
‚Ä¢ Total de marcas: ${brands.filter(b => b.active).length}
‚Ä¢ Espacio de almacenamiento: ${(JSON.stringify({products, categories, brands, theme: currentTheme}).length / 1024).toFixed(2)} KB

üìã RECOMENDACIONES:
${generateRecommendations(categoryStats, brandStats, priceRanges, totalViews, totalInquiries)}
            `;

            // Create enhanced modal with report
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black bg-opacity-80 z-50 flex items-center justify-center p-4';
            modal.innerHTML = `
                <div class="bg-white rounded-xl p-8 max-w-4xl w-full max-h-[90vh] overflow-y-auto">
                    <div class="flex justify-between items-center mb-6">
                        <h3 class="text-3xl font-bold text-gray-800">üìä Reporte Avanzado de Inventario</h3>
                        <button onclick="this.parentElement.parentElement.parentElement.remove()" class="text-gray-500 hover:text-gray-700 text-3xl">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <div class="bg-gray-50 rounded-lg p-6 mb-6">
                        <pre class="text-sm text-gray-700 whitespace-pre-wrap font-mono">${report}</pre>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                        <button onclick="copyReportToClipboard(\`${report.replace(/`/g, '\\`')}\`)" class="bg-blue-600 text-white py-3 px-4 rounded-lg hover:bg-blue-700 transition-colors font-bold">
                            <i class="fas fa-copy mr-2"></i>COPIAR
                        </button>
                        <button onclick="downloadReport(\`${report.replace(/`/g, '\\`')}\`)" class="bg-green-600 text-white py-3 px-4 rounded-lg hover:bg-green-700 transition-colors font-bold">
                            <i class="fas fa-download mr-2"></i>DESCARGAR
                        </button>
                        <button onclick="generateCSVReport()" class="bg-purple-600 text-white py-3 px-4 rounded-lg hover:bg-purple-700 transition-colors font-bold">
                            <i class="fas fa-table mr-2"></i>CSV
                        </button>
                        <button onclick="generateJSONReport()" class="bg-orange-600 text-white py-3 px-4 rounded-lg hover:bg-orange-700 transition-colors font-bold">
                            <i class="fas fa-code mr-2"></i>JSON
                        </button>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
        }

        // Generate recommendations based on data
        function generateRecommendations(categoryStats, brandStats, priceRanges, totalViews, totalInquiries) {
            const recommendations = [];
            
            // Category recommendations
            const topCategory = Object.entries(categoryStats).sort((a, b) => b[1] - a[1])[0];
            if (topCategory) {
                recommendations.push(`‚Ä¢ Categor√≠a "${topCategory[0]}" es la m√°s popular (${topCategory[1]} productos)`);
            }
            
            // Price recommendations
            const lowPriceCount = priceRanges['Menos de ‚Ç°50,000'];
            const highPriceCount = priceRanges['M√°s de ‚Ç°200,000'];
            if (lowPriceCount > highPriceCount * 2) {
                recommendations.push('‚Ä¢ Considerar agregar m√°s productos premium (>‚Ç°200,000)');
            }
            
            // Performance recommendations
            if (totalViews > 0 && totalInquiries / totalViews < 0.05) {
                recommendations.push('‚Ä¢ Tasa de conversi√≥n baja - mejorar descripciones y precios');
            }
            
            // Inventory recommendations
            if (products.filter(p => !p.deleted).length < 10) {
                recommendations.push('‚Ä¢ Inventario limitado - considerar agregar m√°s productos');
            }
            
            return recommendations.length > 0 ? recommendations.join('\n') : '‚Ä¢ Sistema funcionando √≥ptimamente ‚úÖ';
        }

        // Generate CSV report
        function generateCSVReport() {
            const csvData = [
                ['ID', 'Nombre', 'Precio', 'Categor√≠a', 'Marca', 'Tallas', 'Estado', 'Vistas', 'Consultas', 'Creado', 'Modificado']
            ];
            
            products.forEach(product => {
                csvData.push([
                    product.id,
                    product.name,
                    product.price,
                    product.category,
                    product.brand,
                    product.sizes?.join(';') || '',
                    product.deleted ? 'Eliminado' : (product.active !== false ? 'Activo' : 'Inactivo'),
                    product.views || 0,
                    product.inquiries || 0,
                    product.createdAt || '',
                    product.lastModified || ''
                ]);
            });
            
            const csvContent = csvData.map(row => row.map(cell => `"${cell}"`).join(',')).join('\n');
            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.href = url;
            link.download = `inventario_${new Date().toISOString().split('T')[0]}.csv`;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            URL.revokeObjectURL(url);
            showSuccessMessage('Reporte CSV descargado');
        }

        // Generate JSON report
        function generateJSONReport() {
            const jsonData = {
                metadata: {
                    generatedAt: new Date().toISOString(),
                    version: '2.0',
                    totalProducts: products.length
                },
                products: products.map(p => ({
                    id: p.id,
                    name: p.name,
                    price: p.price,
                    category: p.category,
                    brand: p.brand,
                    sizes: p.sizes,
                    active: p.active !== false,
                    deleted: p.deleted || false,
                    views: p.views || 0,
                    inquiries: p.inquiries || 0,
                    createdAt: p.createdAt,
                    lastModified: p.lastModified
                })),
                categories: categories,
                brands: brands
            };
            
            const blob = new Blob([JSON.stringify(jsonData, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.href = url;
            link.download = `inventario_${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            URL.revokeObjectURL(url);
            showSuccessMessage('Reporte JSON descargado');
        }

        // Copy report to clipboard
        function copyReportToClipboard(report) {
            navigator.clipboard.writeText(report).then(() => {
                showSuccessMessage('Reporte copiado al portapapeles');
            }).catch(() => {
                alert('Error al copiar el reporte');
            });
        }

        // Download report as text file
        function downloadReport(report) {
            const blob = new Blob([report], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.href = url;
            link.download = `reporte_inventario_${new Date().toISOString().split('T')[0]}.txt`;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            URL.revokeObjectURL(url);
            showSuccessMessage('Reporte descargado');
        }

        // GitHub Integration Functions
        function exportToGitHub() {
            if (!isAdminLoggedIn) {
                alert('Debes iniciar sesi√≥n como administrador.');
                return;
            }

            // Generate complete HTML file for GitHub
            const completeHTML = generateCompleteHTML();
            
            // Create ZIP file with all necessary files
            const files = {
                'index.html': completeHTML,
                'README.md': generateGitHubReadmeContent(),
                'data.json': JSON.stringify({
                    products: products,
                    categories: categories,
                    brands: brands,
                    theme: currentTheme,
                    texts: siteTexts,
                    links: siteLinks,
                    exportDate: new Date().toISOString()
                }, null, 2),
                '.gitignore': generateGitIgnore(),
                'package.json': generatePackageJson()
            };

            // Create and download ZIP
            createAndDownloadZip(files, `jackets-master-github-${new Date().toISOString().split('T')[0]}.zip`);
            
            showSuccessMessage('¬°Exportaci√≥n para GitHub completada! Descomprime el archivo y s√∫belo a tu repositorio.');
            
            // Show instructions
            setTimeout(() => {
                showGitHubInstructions();
            }, 1000);
        }

        function generateCompleteHTML() {
            // Get current HTML and inject current data
            const currentHTML = document.documentElement.outerHTML;
            
            // Replace the sample data with current data
            let updatedHTML = currentHTML.replace(
                /let products = \[[\s\S]*?\];/,
                `let products = ${JSON.stringify(products, null, 12)};`
            );
            
            updatedHTML = updatedHTML.replace(
                /let categories = \[[\s\S]*?\];/,
                `let categories = ${JSON.stringify(categories, null, 12)};`
            );
            
            updatedHTML = updatedHTML.replace(
                /let brands = \[[\s\S]*?\];/,
                `let brands = ${JSON.stringify(brands, null, 12)};`
            );
            
            updatedHTML = updatedHTML.replace(
                /let siteTexts = \{[\s\S]*?\};/,
                `let siteTexts = ${JSON.stringify(siteTexts, null, 12)};`
            );
            
            updatedHTML = updatedHTML.replace(
                /let siteLinks = \{[\s\S]*?\};/,
                `let siteLinks = ${JSON.stringify(siteLinks, null, 12)};`
            );
            
            updatedHTML = updatedHTML.replace(
                /let currentTheme = \{[\s\S]*?\};/,
                `let currentTheme = ${JSON.stringify(currentTheme, null, 12)};`
            );
            
            return updatedHTML;
        }

        function generateGitHubReadmeContent() {
            return `# Jackets Master - Tienda de Equipamiento Motociclista

## üèçÔ∏è Descripci√≥n
Sitio web completo para tienda de equipamiento motociclista con sistema de administraci√≥n integrado.

## ‚ú® Caracter√≠sticas
- **Cat√°logo de productos** con filtros avanzados
- **Panel de administraci√≥n** completo
- **Gesti√≥n de im√°genes m√∫ltiples** por producto
- **Sistema de categor√≠as y marcas**
- **Personalizaci√≥n de tema** y colores
- **Editor de textos y enlaces**
- **Reportes y analytics**
- **Auto-guardado** de datos
- **Exportaci√≥n/Importaci√≥n** de datos
- **Responsive design**

## üöÄ Instalaci√≥n

### Opci√≥n 1: GitHub Pages (Recomendado)
1. Haz fork de este repositorio
2. Ve a Settings > Pages
3. Selecciona "Deploy from a branch"
4. Elige "main" branch y "/ (root)"
5. Tu sitio estar√° disponible en: \`https://tu-usuario.github.io/jackets-master\`

### Opci√≥n 2: Descarga Local
1. Descarga el archivo \`index.html\`
2. Abre el archivo en tu navegador
3. ¬°Listo para usar!

## üîß Configuraci√≥n

### Acceso de Administrador
- **Usuario:** \`jm\`
- **Contrase√±a:** \`jm2024\`

### Personalizaci√≥n
1. Accede al panel de administraci√≥n
2. Ve a la pesta√±a "DISE√ëO"
3. Personaliza:
   - Textos del sitio
   - Enlaces de WhatsApp y Waze
   - Colores y tema
   - Logo personalizado
   - Fondo del sitio

## üìä Gesti√≥n de Productos

### Agregar Productos
1. Panel Admin > Pesta√±a "PRODUCTOS"
2. Completa el formulario
3. **M√∫ltiples im√°genes:** Sube varios archivos o agrega URLs
4. Selecciona categor√≠a, marca y tallas
5. Guarda el producto

### Caracter√≠sticas de Productos
- **Im√°genes m√∫ltiples** con vista previa
- **Categorizaci√≥n** avanzada
- **Gesti√≥n de tallas** flexible
- **Precios** en colones costarricenses
- **Estados:** Activo/Inactivo/Eliminado
- **Analytics:** Vistas y consultas

## üé® Personalizaci√≥n Avanzada

### Temas
- Fondos: Patr√≥n, color s√≥lido, degradado, imagen
- Colores personalizables
- Logo personalizado
- Imagen detr√°s del texto del hero

### Enlaces Editables
- WhatsApp Cat√°logo
- Canal de WhatsApp
- Enlace de Waze
- Textos personalizables

## üìà Analytics y Reportes
- Seguimiento de vistas por producto
- Conteo de consultas
- Reportes en m√∫ltiples formatos (TXT, CSV, JSON)
- Estad√≠sticas de inventario
- Recomendaciones autom√°ticas

## üíæ Respaldo de Datos
- **Auto-guardado** cada 5 minutos
- **Exportaci√≥n completa** en JSON
- **Importaci√≥n** con validaci√≥n
- **Backup autom√°tico** antes de importar

## üîÑ Actualizaciones

### Desde el Panel Admin
1. Exporta tus datos actuales
2. Descarga la nueva versi√≥n
3. Importa tus datos
4. ¬°Actualizaci√≥n completa!

### V√≠a GitHub
1. Haz pull del repositorio principal
2. Tus datos se mantienen en localStorage
3. Usa exportar/importar si necesitas migrar

## üì± Compatibilidad
- ‚úÖ Todos los navegadores modernos
- ‚úÖ Dispositivos m√≥viles y tablets
- ‚úÖ Funciona offline (despu√©s de la primera carga)
- ‚úÖ No requiere servidor

## üõ†Ô∏è Tecnolog√≠as
- **HTML5** + **CSS3** + **JavaScript**
- **Tailwind CSS** para estilos
- **Font Awesome** para iconos
- **LocalStorage** para persistencia
- **File API** para im√°genes

## üìû Soporte
Para soporte t√©cnico o personalizaciones, contacta al desarrollador.

## üìÑ Licencia
Este proyecto est√° bajo licencia MIT. Puedes usarlo libremente para proyectos comerciales.

---

**Generado autom√°ticamente el ${new Date().toLocaleDateString('es-CR')}**
**Versi√≥n del sistema: 2.0**
**Total de productos: ${products.length}**
**Categor√≠as activas: ${categories.filter(c => c.active).length}**
**Marcas activas: ${brands.filter(b => b.active).length}**
`;
        }

        function generateGitIgnore() {
            return `# Dependencies
node_modules/
npm-debug.log*

# Build outputs
dist/
build/

# Environment variables
.env
.env.local

# IDE files
.vscode/
.idea/
*.swp
*.swo

# OS files
.DS_Store
Thumbs.db

# Logs
*.log

# Temporary files
*.tmp
*.temp
`;
        }

        function generatePackageJson() {
            return JSON.stringify({
                "name": "jackets-master",
                "version": "2.0.0",
                "description": "Tienda de equipamiento motociclista con panel de administraci√≥n",
                "main": "index.html",
                "scripts": {
                    "start": "python -m http.server 8000",
                    "serve": "npx serve .",
                    "deploy": "gh-pages -d ."
                },
                "keywords": [
                    "motorcycle",
                    "jackets",
                    "ecommerce",
                    "catalog",
                    "admin-panel"
                ],
                "author": "Jackets Master",
                "license": "MIT",
                "devDependencies": {
                    "gh-pages": "^4.0.0",
                    "serve": "^14.0.0"
                },
                "repository": {
                    "type": "git",
                    "url": "https://github.com/usuario/jackets-master.git"
                },
                "homepage": "https://usuario.github.io/jackets-master"
            }, null, 2);
        }

        function createAndDownloadZip(files, filename) {
            // Create individual files with proper names and types
            Object.entries(files).forEach(([fileName, content]) => {
                let mimeType = 'text/plain;charset=utf-8';
                
                // Set proper MIME types based on file extension
                if (fileName.endsWith('.html')) {
                    mimeType = 'text/html;charset=utf-8';
                } else if (fileName.endsWith('.json')) {
                    mimeType = 'application/json;charset=utf-8';
                } else if (fileName.endsWith('.md')) {
                    mimeType = 'text/markdown;charset=utf-8';
                }
                
                const blob = new Blob([content], { type: mimeType });
                const url = URL.createObjectURL(blob);
                const link = document.createElement('a');
                link.href = url;
                link.download = fileName; // This will use the exact filename provided
                link.style.display = 'none';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                URL.revokeObjectURL(url);
                
                // Small delay between downloads to avoid browser blocking
                setTimeout(() => {}, 100);
            });
            
            showSuccessMessage(`‚úÖ Archivos GitHub generados: ${Object.keys(files).length} archivos descargados con nombres correctos`);
            
            // Show file list
            setTimeout(() => {
                const fileList = Object.keys(files).map(name => `‚Ä¢ ${name}`).join('\n');
                alert(`ARCHIVOS GENERADOS PARA GITHUB:\n\n${fileList}\n\nüìÅ Todos los archivos tienen los nombres correctos para usar directamente en tu repositorio.`);
            }, 1000);
        }

        function showGitHubInstructions() {
            const instructions = `
üöÄ INSTRUCCIONES PARA SUBIR A GITHUB:

1Ô∏è‚É£ **Crear Repositorio:**
   ‚Ä¢ Ve a github.com y crea un nuevo repositorio
   ‚Ä¢ Nombre sugerido: "jackets-master"
   ‚Ä¢ Marca como p√∫blico
   ‚Ä¢ No agregues README (ya est√° incluido)

2Ô∏è‚É£ **Subir Archivos:**
   ‚Ä¢ Sube todos los archivos descargados
   ‚Ä¢ Especialmente: index.html, README.md, data.json

3Ô∏è‚É£ **Activar GitHub Pages:**
   ‚Ä¢ Ve a Settings > Pages
   ‚Ä¢ Source: "Deploy from a branch"
   ‚Ä¢ Branch: "main" o "master"
   ‚Ä¢ Folder: "/ (root)"

4Ô∏è‚É£ **Acceder al Sitio:**
   ‚Ä¢ URL: https://tu-usuario.github.io/jackets-master
   ‚Ä¢ Puede tardar unos minutos en activarse

5Ô∏è‚É£ **Actualizaciones Futuras:**
   ‚Ä¢ Usa el bot√≥n "EXPORTAR" del panel admin
   ‚Ä¢ Sube el nuevo index.html a GitHub
   ‚Ä¢ Los cambios se reflejan autom√°ticamente

üí° **Consejos:**
   ‚Ä¢ Guarda el enlace de tu repositorio
   ‚Ä¢ Haz backups regulares de tus datos
   ‚Ä¢ Personaliza el README.md con tu informaci√≥n

¬øTodo listo? ¬°Tu tienda estar√° online en GitHub Pages!
            `;
            
            alert(instructions);
        }

        function generateGitHubReadme() {
            const readmeContent = generateGitHubReadmeContent();
            const blob = new Blob([readmeContent], { type: 'text/markdown;charset=utf-8' });
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.href = url;
            link.download = 'README.md';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            URL.revokeObjectURL(url);
            showSuccessMessage('README.md generado y descargado');
        }

        // AUTO-SAVE SYSTEM WITH BACKEND COMPATIBILITY
        function autoSave() {
            try {
                const siteData = {
                    products: products,
                    categories: categories,
                    brands: brands,
                    theme: currentTheme,
                    texts: siteTexts,
                    links: siteLinks,
                    fonts: siteFonts,
                    lastUpdated: new Date().toISOString(),
                    version: '2.0'
                };
                
                // Try to save to backend first
                if (typeof fetch !== 'undefined') {
                    fetch('/api/save-data', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            action: 'save_data',
                            data: siteData,
                            timestamp: Date.now()
                        })
                    }).then(response => {
                        if (response.ok) {
                            console.log('‚úÖ Datos guardados en backend');
                        } else {
                            throw new Error('Backend no disponible');
                        }
                    }).catch(() => {
                        // Fallback to localStorage
                        localStorage.setItem('jacketsmaster_data', JSON.stringify(siteData));
                        console.log('üíæ Datos guardados en localStorage (fallback)');
                    });
                } else {
                    // Direct localStorage save
                    localStorage.setItem('jacketsmaster_data', JSON.stringify(siteData));
                    console.log('üíæ Datos guardados en localStorage');
                }
                
                return true;
            } catch (error) {
                console.error('‚ùå Error en auto-guardado:', error);
                return false;
            }
        }

        // Enhanced auto-save with time tracking
        function enhancedAutoSave() {
            const result = autoSave();
            if (result) {
                updateLastSaveTime();
            }
            return result;
        }

        // ADVANCED FEATURES AND UTILITIES

        // Keyboard shortcuts for admin
        document.addEventListener('keydown', function(e) {
            // Escape = Close modals (works for everyone)
            if (e.key === 'Escape') {
                // Close product detail modal
                const productModal = document.getElementById('productDetailModal');
                if (productModal && !productModal.classList.contains('hidden')) {
                    closeProductDetail();
                    return;
                }
                
                // Close other modals
                const modals = document.querySelectorAll('.fixed.inset-0');
                modals.forEach(modal => {
                    if (modal.style.display !== 'none' && !modal.classList.contains('hidden')) {
                        modal.remove();
                    }
                });
            }
            
            // Admin-only shortcuts
            if (!isAdminLoggedIn) return;
            
            // Ctrl/Cmd + S = Manual Save
            if ((e.ctrlKey || e.metaKey) && e.key === 's') {
                e.preventDefault();
                manualSave();
            }
            
            // Ctrl/Cmd + R = Generate Report
            if ((e.ctrlKey || e.metaKey) && e.key === 'r') {
                e.preventDefault();
                generateReport();
            }
            
            // Ctrl/Cmd + E = Export Data
            if ((e.ctrlKey || e.metaKey) && e.key === 'e') {
                e.preventDefault();
                exportData();
            }
        });

        // Auto-save every 5 minutes
        setInterval(() => {
            if (isAdminLoggedIn) {
                enhancedAutoSave();
                console.log('üïê Auto-guardado peri√≥dico ejecutado');
            }
        }, 5 * 60 * 1000);

        // Performance monitoring
        function monitorPerformance() {
            const performanceData = {
                timestamp: new Date().toISOString(),
                productsCount: products.length,
                categoriesCount: categories.length,
                brandsCount: brands.length,
                memoryUsage: performance.memory ? {
                    used: Math.round(performance.memory.usedJSHeapSize / 1024 / 1024),
                    total: Math.round(performance.memory.totalJSHeapSize / 1024 / 1024),
                    limit: Math.round(performance.memory.jsHeapSizeLimit / 1024 / 1024)
                } : null,
                loadTime: performance.now()
            };
            
            console.log('üìä Performance Monitor:', performanceData);
            return performanceData;
        }

        // Search suggestions and autocomplete
        function initializeSearchSuggestions() {
            const searchInput = document.getElementById('searchInput');
            if (!searchInput) return;
            
            let suggestionBox = document.getElementById('searchSuggestions');
            if (!suggestionBox) {
                suggestionBox = document.createElement('div');
                suggestionBox.id = 'searchSuggestions';
                suggestionBox.className = 'absolute top-full left-0 right-0 bg-white border border-gray-300 rounded-b-lg shadow-lg z-10 hidden max-h-60 overflow-y-auto';
                searchInput.parentElement.style.position = 'relative';
                searchInput.parentElement.appendChild(suggestionBox);
            }
            
            searchInput.addEventListener('input', function() {
                const query = this.value.toLowerCase().trim();
                if (query.length < 2) {
                    suggestionBox.classList.add('hidden');
                    return;
                }
                
                const suggestions = products
                    .filter(p => !p.deleted && (
                        p.name.toLowerCase().includes(query) ||
                        p.description.toLowerCase().includes(query) ||
                        p.brand.toLowerCase().includes(query) ||
                        p.category.toLowerCase().includes(query)
                    ))
                    .slice(0, 8)
                    .map(p => ({
                        text: p.name,
                        type: 'product',
                        data: p
                    }));
                
                // Add category suggestions
                categories.filter(c => c.active && c.name.toLowerCase().includes(query))
                    .forEach(c => suggestions.push({
                        text: c.name,
                        type: 'category',
                        data: c
                    }));
                
                // Add brand suggestions
                brands.filter(b => b.active && b.name.toLowerCase().includes(query))
                    .forEach(b => suggestions.push({
                        text: b.name,
                        type: 'brand',
                        data: b
                    }));
                
                if (suggestions.length > 0) {
                    suggestionBox.innerHTML = suggestions.map(s => `
                        <div class="p-3 hover:bg-gray-100 cursor-pointer border-b border-gray-100 last:border-b-0" 
                             onclick="applySuggestion('${s.type}', '${s.data.id || s.data.name}', '${s.text}')">
                            <div class="flex items-center space-x-2">
                                <i class="fas ${s.type === 'product' ? 'fa-box' : s.type === 'category' ? 'fa-tag' : 'fa-star'} text-gray-400"></i>
                                <span class="font-medium">${s.text}</span>
                                <span class="text-xs text-gray-500 uppercase">${s.type}</span>
                            </div>
                        </div>
                    `).join('');
                    suggestionBox.classList.remove('hidden');
                } else {
                    suggestionBox.classList.add('hidden');
                }
            });
            
            // Hide suggestions when clicking outside
            document.addEventListener('click', function(e) {
                if (!searchInput.contains(e.target) && !suggestionBox.contains(e.target)) {
                    suggestionBox.classList.add('hidden');
                }
            });
        }

        function applySuggestion(type, id, text) {
            const searchInput = document.getElementById('searchInput');
            const suggestionBox = document.getElementById('searchSuggestions');
            
            if (type === 'product') {
                searchInput.value = text;
            } else if (type === 'category') {
                document.getElementById('categoryFilter').value = id;
                searchInput.value = '';
            } else if (type === 'brand') {
                document.getElementById('brandFilter').value = id;
                searchInput.value = '';
            }
            
            suggestionBox.classList.add('hidden');
            filterProducts();
        }

        // Advanced bulk operations
        function initializeBulkOperations() {
            if (!isAdminLoggedIn) return;
            
            // Add bulk selection checkboxes to admin products
            const style = document.createElement('style');
            style.textContent = `
                .bulk-checkbox {
                    position: absolute;
                    top: 10px;
                    left: 10px;
                    z-index: 10;
                }
                .bulk-actions {
                    position: sticky;
                    top: 0;
                    background: rgba(220, 38, 38, 0.95);
                    color: white;
                    padding: 1rem;
                    border-radius: 0.5rem;
                    margin-bottom: 1rem;
                    z-index: 20;
                }
            `;
            document.head.appendChild(style);
        }

        // Data validation and integrity checks
        function validateDataIntegrity() {
            const issues = [];
            
            // Check for products with invalid categories
            products.forEach(product => {
                if (!categories.find(c => c.id === product.category)) {
                    issues.push(`Producto "${product.name}" tiene categor√≠a inv√°lida: ${product.category}`);
                }
                
                if (!brands.find(b => b.id === product.brand)) {
                    issues.push(`Producto "${product.name}" tiene marca inv√°lida: ${product.brand}`);
                }
                
                if (!product.sizes || product.sizes.length === 0) {
                    issues.push(`Producto "${product.name}" no tiene tallas definidas`);
                }
                
                if (!product.price || product.price <= 0) {
                    issues.push(`Producto "${product.name}" tiene precio inv√°lido: ${product.price}`);
                }
            });
            
            // Check for duplicate product names
            const productNames = {};
            products.filter(p => !p.deleted).forEach(product => {
                const name = product.name.toLowerCase();
                if (productNames[name]) {
                    issues.push(`Nombre duplicado encontrado: "${product.name}"`);
                } else {
                    productNames[name] = true;
                }
            });
            
            if (issues.length > 0) {
                console.warn('‚ö†Ô∏è Problemas de integridad encontrados:', issues);
                if (isAdminLoggedIn) {
                    const issuesList = issues.map(issue => `‚Ä¢ ${issue}`).join('\n');
                    if (confirm(`Se encontraron ${issues.length} problemas de integridad:\n\n${issuesList}\n\n¬øVer reporte completo?`)) {
                        alert(`REPORTE DE INTEGRIDAD:\n\n${issuesList}`);
                    }
                }
            } else {
                console.log('‚úÖ Integridad de datos verificada correctamente');
            }
            
            return issues;
        }

        // Initialize advanced features
        document.addEventListener('DOMContentLoaded', function() {
            setTimeout(() => {
                initializeSearchSuggestions();
                initializeBulkOperations();
                monitorPerformance();
                validateDataIntegrity();
                
                // Initialize last save time
                updateLastSaveTime();
                
                console.log('üöÄ Todas las funciones avanzadas inicializadas');
            }, 1000);
        });

        // Smooth scrolling for navigation links
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }
                // Close mobile menu if open
                document.getElementById('mobileMenu').classList.add('hidden');
            });
        });

        // Service Worker for offline functionality (if supported)
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('/sw.js').then(() => {
                console.log('üîß Service Worker registrado para funcionalidad offline');
            }).catch(() => {
                console.log('‚ÑπÔ∏è Service Worker no disponible');
            });
        }

        // FONT MANAGEMENT SYSTEM - COMPLETE IMPLEMENTATION

        // Load Google Fonts dynamically
        function loadGoogleFonts() {
            const googleFonts = ['Oswald:400,700', 'Roboto:400,700', 'Open+Sans:400,700', 'Montserrat:400,700', 'Poppins:400,700'];
            const link = document.createElement('link');
            link.href = `https://fonts.googleapis.com/css2?${googleFonts.map(font => `family=${font}`).join('&')}&display=swap`;
            link.rel = 'stylesheet';
            document.head.appendChild(link);
        }

        // Load current fonts into form
        function loadCurrentFonts() {
            // Hero Title
            document.getElementById('heroTitleFont').value = siteFonts.heroTitle.family;
            document.getElementById('heroTitleSize').value = siteFonts.heroTitle.size;
            document.getElementById('heroTitleSizeValue').textContent = siteFonts.heroTitle.size + 'px';
            document.getElementById('heroTitleBold').checked = siteFonts.heroTitle.bold;
            document.getElementById('heroTitleItalic').checked = siteFonts.heroTitle.italic;
            document.getElementById('heroTitleColor').value = siteFonts.heroTitle.color;

            // Section Title
            document.getElementById('sectionTitleFont').value = siteFonts.sectionTitle.family;
            document.getElementById('sectionTitleSize').value = siteFonts.sectionTitle.size;
            document.getElementById('sectionTitleSizeValue').textContent = siteFonts.sectionTitle.size + 'px';
            document.getElementById('sectionTitleBold').checked = siteFonts.sectionTitle.bold;
            document.getElementById('sectionTitleItalic').checked = siteFonts.sectionTitle.italic;
            document.getElementById('sectionTitleColor').value = siteFonts.sectionTitle.color;

            // Product Name
            document.getElementById('productNameFont').value = siteFonts.productName.family;
            document.getElementById('productNameSize').value = siteFonts.productName.size;
            document.getElementById('productNameSizeValue').textContent = siteFonts.productName.size + 'px';
            document.getElementById('productNameBold').checked = siteFonts.productName.bold;
            document.getElementById('productNameItalic').checked = siteFonts.productName.italic;
            document.getElementById('productNameColor').value = siteFonts.productName.color;

            // Product Description
            document.getElementById('productDescFont').value = siteFonts.productDesc.family;
            document.getElementById('productDescSize').value = siteFonts.productDesc.size;
            document.getElementById('productDescSizeValue').textContent = siteFonts.productDesc.size + 'px';
            document.getElementById('productDescBold').checked = siteFonts.productDesc.bold;
            document.getElementById('productDescItalic').checked = siteFonts.productDesc.italic;
            document.getElementById('productDescColor').value = siteFonts.productDesc.color;

            // Product Price
            document.getElementById('productPriceFont').value = siteFonts.productPrice.family;
            document.getElementById('productPriceSize').value = siteFonts.productPrice.size;
            document.getElementById('productPriceSizeValue').textContent = siteFonts.productPrice.size + 'px';
            document.getElementById('productPriceBold').checked = siteFonts.productPrice.bold;
            document.getElementById('productPriceItalic').checked = siteFonts.productPrice.italic;
            document.getElementById('productPriceColor').value = siteFonts.productPrice.color;

            // Navigation
            document.getElementById('navigationFont').value = siteFonts.navigation.family;
            document.getElementById('navigationSize').value = siteFonts.navigation.size;
            document.getElementById('navigationSizeValue').textContent = siteFonts.navigation.size + 'px';
            document.getElementById('navigationBold').checked = siteFonts.navigation.bold;
            document.getElementById('navigationItalic').checked = siteFonts.navigation.italic;
            document.getElementById('navigationColor').value = siteFonts.navigation.color;

            showSuccessMessage('Fuentes actuales cargadas en el editor');
        }

        // Update fonts in real-time
        function updateFonts() {
            // Update size displays
            document.getElementById('heroTitleSizeValue').textContent = document.getElementById('heroTitleSize').value + 'px';
            document.getElementById('sectionTitleSizeValue').textContent = document.getElementById('sectionTitleSize').value + 'px';
            document.getElementById('productNameSizeValue').textContent = document.getElementById('productNameSize').value + 'px';
            document.getElementById('productDescSizeValue').textContent = document.getElementById('productDescSize').value + 'px';
            document.getElementById('productPriceSizeValue').textContent = document.getElementById('productPriceSize').value + 'px';
            document.getElementById('navigationSizeValue').textContent = document.getElementById('navigationSize').value + 'px';

            // Apply preview (optional - can be resource intensive)
            if (document.getElementById('livePreview')?.checked) {
                applyFontChanges();
            }
        }

        // Apply font changes
        function applyFontChanges() {
            if (!isAdminLoggedIn) {
                alert('Debes iniciar sesi√≥n como administrador.');
                return;
            }

            // Update siteFonts object
            siteFonts.heroTitle = {
                family: document.getElementById('heroTitleFont').value,
                size: parseInt(document.getElementById('heroTitleSize').value),
                bold: document.getElementById('heroTitleBold').checked,
                italic: document.getElementById('heroTitleItalic').checked,
                color: document.getElementById('heroTitleColor').value
            };

            siteFonts.sectionTitle = {
                family: document.getElementById('sectionTitleFont').value,
                size: parseInt(document.getElementById('sectionTitleSize').value),
                bold: document.getElementById('sectionTitleBold').checked,
                italic: document.getElementById('sectionTitleItalic').checked,
                color: document.getElementById('sectionTitleColor').value
            };

            siteFonts.productName = {
                family: document.getElementById('productNameFont').value,
                size: parseInt(document.getElementById('productNameSize').value),
                bold: document.getElementById('productNameBold').checked,
                italic: document.getElementById('productNameItalic').checked,
                color: document.getElementById('productNameColor').value
            };

            siteFonts.productDesc = {
                family: document.getElementById('productDescFont').value,
                size: parseInt(document.getElementById('productDescSize').value),
                bold: document.getElementById('productDescBold').checked,
                italic: document.getElementById('productDescItalic').checked,
                color: document.getElementById('productDescColor').value
            };

            siteFonts.productPrice = {
                family: document.getElementById('productPriceFont').value,
                size: parseInt(document.getElementById('productPriceSize').value),
                bold: document.getElementById('productPriceBold').checked,
                italic: document.getElementById('productPriceItalic').checked,
                color: document.getElementById('productPriceColor').value
            };

            siteFonts.navigation = {
                family: document.getElementById('navigationFont').value,
                size: parseInt(document.getElementById('navigationSize').value),
                bold: document.getElementById('navigationBold').checked,
                italic: document.getElementById('navigationItalic').checked,
                color: document.getElementById('navigationColor').value
            };

            // Apply fonts to the page
            applyFonts();
            
            // Auto-save
            enhancedAutoSave();
            
            showSuccessMessage('¬°Fuentes aplicadas exitosamente!');
        }

        // Apply fonts to page elements
        function applyFonts() {
            // Create or update font styles
            let fontStyleElement = document.getElementById('customFontStyles');
            if (!fontStyleElement) {
                fontStyleElement = document.createElement('style');
                fontStyleElement.id = 'customFontStyles';
                document.head.appendChild(fontStyleElement);
            }

            const fontStyles = `
                /* Hero Title Fonts */
                .hero-title {
                    font-family: '${siteFonts.heroTitle.family}', sans-serif !important;
                    font-size: ${siteFonts.heroTitle.size}px !important;
                    font-weight: ${siteFonts.heroTitle.bold ? 'bold' : 'normal'} !important;
                    font-style: ${siteFonts.heroTitle.italic ? 'italic' : 'normal'} !important;
                    color: ${siteFonts.heroTitle.color} !important;
                }

                /* Section Title Fonts */
                .section-title {
                    font-family: '${siteFonts.sectionTitle.family}', sans-serif !important;
                    font-size: ${siteFonts.sectionTitle.size}px !important;
                    font-weight: ${siteFonts.sectionTitle.bold ? 'bold' : 'normal'} !important;
                    font-style: ${siteFonts.sectionTitle.italic ? 'italic' : 'normal'} !important;
                    color: ${siteFonts.sectionTitle.color} !important;
                }

                /* Product Name Fonts */
                .product-card h3 {
                    font-family: '${siteFonts.productName.family}', sans-serif !important;
                    font-size: ${siteFonts.productName.size}px !important;
                    font-weight: ${siteFonts.productName.bold ? 'bold' : 'normal'} !important;
                    font-style: ${siteFonts.productName.italic ? 'italic' : 'normal'} !important;
                    color: ${siteFonts.productName.color} !important;
                }

                /* Product Description Fonts */
                .product-card p {
                    font-family: '${siteFonts.productDesc.family}', sans-serif !important;
                    font-size: ${siteFonts.productDesc.size}px !important;
                    font-weight: ${siteFonts.productDesc.bold ? 'bold' : 'normal'} !important;
                    font-style: ${siteFonts.productDesc.italic ? 'italic' : 'normal'} !important;
                    color: ${siteFonts.productDesc.color} !important;
                }

                /* Product Price Fonts */
                .product-card .text-3xl {
                    font-family: '${siteFonts.productPrice.family}', sans-serif !important;
                    font-size: ${siteFonts.productPrice.size}px !important;
                    font-weight: ${siteFonts.productPrice.bold ? 'bold' : 'normal'} !important;
                    font-style: ${siteFonts.productPrice.italic ? 'italic' : 'normal'} !important;
                    color: ${siteFonts.productPrice.color} !important;
                }

                /* Navigation Fonts */
                nav a, .mobile-nav a {
                    font-family: '${siteFonts.navigation.family}', sans-serif !important;
                    font-size: ${siteFonts.navigation.size}px !important;
                    font-weight: ${siteFonts.navigation.bold ? 'bold' : 'normal'} !important;
                    font-style: ${siteFonts.navigation.italic ? 'italic' : 'normal'} !important;
                    color: ${siteFonts.navigation.color} !important;
                }

                /* Responsive adjustments */
                @media (max-width: 768px) {
                    .hero-title {
                        font-size: ${Math.max(24, siteFonts.heroTitle.size * 0.6)}px !important;
                    }
                    .section-title {
                        font-size: ${Math.max(20, siteFonts.sectionTitle.size * 0.7)}px !important;
                    }
                    .product-card h3 {
                        font-size: ${Math.max(16, siteFonts.productName.size * 0.8)}px !important;
                    }
                    .product-card p {
                        font-size: ${Math.max(14, siteFonts.productDesc.size * 0.9)}px !important;
                    }
                    .product-card .text-3xl {
                        font-size: ${Math.max(18, siteFonts.productPrice.size * 0.7)}px !important;
                    }
                }
            `;

            fontStyleElement.textContent = fontStyles;

            // Load Google Fonts if needed
            const googleFonts = ['Oswald', 'Roboto', 'Open Sans', 'Montserrat', 'Poppins'];
            const fontsToLoad = [];
            
            Object.values(siteFonts).forEach(font => {
                if (googleFonts.includes(font.family) && !fontsToLoad.includes(font.family)) {
                    fontsToLoad.push(font.family);
                }
            });

            if (fontsToLoad.length > 0) {
                loadSpecificGoogleFonts(fontsToLoad);
            }
        }

        // Load specific Google Fonts
        function loadSpecificGoogleFonts(fonts) {
            const existingLink = document.getElementById('customGoogleFonts');
            if (existingLink) {
                existingLink.remove();
            }

            const link = document.createElement('link');
            link.id = 'customGoogleFonts';
            link.href = `https://fonts.googleapis.com/css2?${fonts.map(font => `family=${font.replace(' ', '+')}:400,700`).join('&')}&display=swap`;
            link.rel = 'stylesheet';
            document.head.appendChild(link);
        }

        // Reset fonts to defaults
        function resetFonts() {
            if (!isAdminLoggedIn) {
                alert('Debes iniciar sesi√≥n como administrador.');
                return;
            }

            if (confirm('¬øRestaurar todas las fuentes a los valores originales?')) {
                siteFonts = {
                    heroTitle: {
                        family: 'Anton',
                        size: 64,
                        bold: true,
                        italic: true,
                        color: '#dc2626'
                    },
                    sectionTitle: {
                        family: 'Anton',
                        size: 48,
                        bold: true,
                        italic: true,
                        color: '#dc2626'
                    },
                    productName: {
                        family: 'Arial',
                        size: 24,
                        bold: true,
                        italic: false,
                        color: '#374151'
                    },
                    productDesc: {
                        family: 'Arial',
                        size: 18,
                        bold: false,
                        italic: false,
                        color: '#4b5563'
                    },
                    productPrice: {
                        family: 'Arial',
                        size: 30,
                        bold: true,
                        italic: false,
                        color: '#dc2626'
                    },
                    navigation: {
                        family: 'Arial',
                        size: 18,
                        bold: true,
                        italic: false,
                        color: '#ffffff'
                    }
                };
                
                applyFonts();
                loadCurrentFonts();
                enhancedAutoSave();
                showSuccessMessage('Fuentes restauradas a los valores originales');
            }
        }

        // Preview fonts in modal
        function previewFonts() {
            const previewModal = document.createElement('div');
            previewModal.className = 'fixed inset-0 bg-black bg-opacity-80 z-50 flex items-center justify-center p-4';
            previewModal.innerHTML = `
                <div class="bg-white rounded-xl p-8 max-w-4xl w-full max-h-[90vh] overflow-y-auto">
                    <div class="flex justify-between items-center mb-6">
                        <h3 class="text-3xl font-bold text-gray-800">üëÅÔ∏è Vista Previa de Fuentes</h3>
                        <button onclick="this.parentElement.parentElement.parentElement.remove()" class="text-gray-500 hover:text-gray-700 text-3xl">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    
                    <div class="space-y-8">
                        <!-- Hero Title Preview -->
                        <div class="border-b pb-4">
                            <h4 class="text-lg font-bold text-gray-600 mb-2">T√çTULO PRINCIPAL:</h4>
                            <div style="font-family: '${document.getElementById('heroTitleFont').value}'; font-size: ${document.getElementById('heroTitleSize').value}px; font-weight: ${document.getElementById('heroTitleBold').checked ? 'bold' : 'normal'}; font-style: ${document.getElementById('heroTitleItalic').checked ? 'italic' : 'normal'}; color: ${document.getElementById('heroTitleColor').value};">
                                MOTORCYCLE GEAR PREMIUM
                            </div>
                        </div>

                        <!-- Section Title Preview -->
                        <div class="border-b pb-4">
                            <h4 class="text-lg font-bold text-gray-600 mb-2">T√çTULOS DE SECCI√ìN:</h4>
                            <div style="font-family: '${document.getElementById('sectionTitleFont').value}'; font-size: ${document.getElementById('sectionTitleSize').value}px; font-weight: ${document.getElementById('sectionTitleBold').checked ? 'bold' : 'normal'}; font-style: ${document.getElementById('sectionTitleItalic').checked ? 'italic' : 'normal'}; color: ${document.getElementById('sectionTitleColor').value};">
                                NUESTROS PRODUCTOS
                            </div>
                        </div>

                        <!-- Product Card Preview -->
                        <div class="border-b pb-4">
                            <h4 class="text-lg font-bold text-gray-600 mb-2">TARJETA DE PRODUCTO:</h4>
                            <div class="bg-gray-100 p-6 rounded-lg">
                                <div style="font-family: '${document.getElementById('productNameFont').value}'; font-size: ${document.getElementById('productNameSize').value}px; font-weight: ${document.getElementById('productNameBold').checked ? 'bold' : 'normal'}; font-style: ${document.getElementById('productNameItalic').checked ? 'italic' : 'normal'}; color: ${document.getElementById('productNameColor').value}; margin-bottom: 8px;">
                                    Jacket Racing Pro
                                </div>
                                <div style="font-family: '${document.getElementById('productDescFont').value}'; font-size: ${document.getElementById('productDescSize').value}px; font-weight: ${document.getElementById('productDescBold').checked ? 'bold' : 'normal'}; font-style: ${document.getElementById('productDescItalic').checked ? 'italic' : 'normal'}; color: ${document.getElementById('productDescColor').value}; margin-bottom: 12px;">
                                    Jacket de cuero premium para racing con protecciones CE y dise√±o aerodin√°mico.
                                </div>
                                <div style="font-family: '${document.getElementById('productPriceFont').value}'; font-size: ${document.getElementById('productPriceSize').value}px; font-weight: ${document.getElementById('productPriceBold').checked ? 'bold' : 'normal'}; font-style: ${document.getElementById('productPriceItalic').checked ? 'italic' : 'normal'}; color: ${document.getElementById('productPriceColor').value};">
                                    ‚Ç°179,990
                                </div>
                            </div>
                        </div>

                        <!-- Navigation Preview -->
                        <div>
                            <h4 class="text-lg font-bold text-gray-600 mb-2">NAVEGACI√ìN:</h4>
                            <div class="bg-black p-4 rounded-lg">
                                <div style="font-family: '${document.getElementById('navigationFont').value}'; font-size: ${document.getElementById('navigationSize').value}px; font-weight: ${document.getElementById('navigationBold').checked ? 'bold' : 'normal'}; font-style: ${document.getElementById('navigationItalic').checked ? 'italic' : 'normal'}; color: ${document.getElementById('navigationColor').value}; display: inline-block; margin-right: 24px;">
                                    INICIO
                                </div>
                                <div style="font-family: '${document.getElementById('navigationFont').value}'; font-size: ${document.getElementById('navigationSize').value}px; font-weight: ${document.getElementById('navigationBold').checked ? 'bold' : 'normal'}; font-style: ${document.getElementById('navigationItalic').checked ? 'italic' : 'normal'}; color: ${document.getElementById('navigationColor').value}; display: inline-block; margin-right: 24px;">
                                    PRODUCTOS
                                </div>
                                <div style="font-family: '${document.getElementById('navigationFont').value}'; font-size: ${document.getElementById('navigationSize').value}px; font-weight: ${document.getElementById('navigationBold').checked ? 'bold' : 'normal'}; font-style: ${document.getElementById('navigationItalic').checked ? 'italic' : 'normal'}; color: ${document.getElementById('navigationColor').value}; display: inline-block;">
                                    CONTACTO
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="mt-8 text-center">
                        <button onclick="applyFontChanges(); this.parentElement.parentElement.parentElement.remove();" class="bg-green-600 text-white px-6 py-3 rounded-lg hover:bg-green-700 transition-colors font-bold text-lg mr-4">
                            <i class="fas fa-check mr-2"></i>APLICAR ESTAS FUENTES
                        </button>
                        <button onclick="this.parentElement.parentElement.parentElement.remove()" class="bg-gray-600 text-white px-6 py-3 rounded-lg hover:bg-gray-700 transition-colors font-bold text-lg">
                            <i class="fas fa-times mr-2"></i>CERRAR VISTA PREVIA
                        </button>
                    </div>
                </div>
            `;
            document.body.appendChild(previewModal);
        }

        // Final system status
        console.log(`
üéØ JACKETS MASTER v2.0 - SISTEMA COMPLETAMENTE INICIALIZADO

üìä ESTAD√çSTICAS DEL SISTEMA:
‚Ä¢ Productos cargados: ${products.length}
‚Ä¢ Categor√≠as activas: ${categories.filter(c => c.active).length}
‚Ä¢ Marcas activas: ${brands.filter(b => b.active).length}
‚Ä¢ Auto-guardado: ‚úÖ Activado
‚Ä¢ Compatibilidad backend: ‚úÖ Implementada
‚Ä¢ An√°lisis avanzado: ‚úÖ Disponible
‚Ä¢ Reportes m√∫ltiples: ‚úÖ CSV, JSON, TXT
‚Ä¢ Integridad de datos: ‚úÖ Verificada
‚Ä¢ Funciones de administraci√≥n: ‚úÖ Completas
‚Ä¢ Sistema de fuentes: ‚úÖ Personalizaci√≥n completa

üîß FUNCIONES DISPONIBLES:
‚Ä¢ Gesti√≥n completa de productos, categor√≠as y marcas
‚Ä¢ Sistema de auto-guardado inteligente
‚Ä¢ Reportes avanzados con an√°lisis y recomendaciones
‚Ä¢ Seguimiento de vistas y consultas
‚Ä¢ Historial de modificaciones
‚Ä¢ Validaci√≥n de integridad de datos
‚Ä¢ B√∫squeda con sugerencias autom√°ticas
‚Ä¢ Atajos de teclado para administradores
‚Ä¢ Exportaci√≥n en m√∫ltiples formatos
‚Ä¢ Respaldo y restauraci√≥n de datos
‚Ä¢ Personalizaci√≥n completa de fuentes (familia, tama√±o, negrita, cursiva, color)
‚Ä¢ Vista previa de fuentes en tiempo real
‚Ä¢ Soporte para Google Fonts y fuentes del sistema

¬°Sistema listo para uso profesional! üöÄ
        `);

        // Add body box-sizing as required
        const bodyStyle = document.createElement('style');
        bodyStyle.textContent = `
            body {
                box-sizing: border-box;
            }
        `;
        document.head.appendChild(bodyStyle);
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'988656d423d21d49',t:'MTc1OTQzMDU0MS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
